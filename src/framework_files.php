<?php
namespace tomk79\renconBuilder;

class framework_files {
   public function get( $className ) {
       $files = array(
           "rencon" => 'PD9waHAKLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIDwhLS0gYXBwX25hbWUgLS0+IHY8IS0tIHZlcnNpb24gLS0+CgotLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCm5hbWVzcGFjZSByZW5jb25GcmFtZXdvcms7CgovLyA9LT0tPS09LT0tPS09LT0tPS09LT0tPSBDb25maWd1cmF0aW9uIFNUQVJUID0tPS09LT0tPS09LT0tPS09LT0tPS09CgovKi0tIGNvbmZpZyAtLSovCgovLyA9LT0tPS09LT0tPS09LT0tPS09LT0tPSAvIENvbmZpZ3VyYXRpb24gRU5EID0tPS09LT0tPS09LT0tPS09LT0tPS09CgoKJHJlbmNvbiA9IG5ldyByZW5jb24oICRjb25mICk7CiRyZW5jb24tPnJ1bigpOwoKY2xhc3MgcmVuY29uIHsKCglwcml2YXRlICRjb25mOwoJcHJpdmF0ZSAkZnM7Cglwcml2YXRlICRyZXE7Cglwcml2YXRlICR1c2VyOwoJcHJpdmF0ZSAkdGhlbWU7Cglwcml2YXRlICRyZXNvdXJjZXM7CgoJcHJpdmF0ZSAkYXBwX2lkID0gJzwhLS0gYXBwX2lkIC0tPic7Cglwcml2YXRlICRhcHBfbmFtZSA9ICc8IS0tIGFwcF9uYW1lIC0tPic7CgoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCAkY29uZiApewoJCSR0aGlzLT5jb25mID0gbmV3IGNvbmYoICRjb25mICk7CgkJJHRoaXMtPmZzID0gbmV3IGZpbGVzeXN0ZW0oKTsKCQkkdGhpcy0+cmVxID0gbmV3IHJlcXVlc3QoKTsKCQkkdGhpcy0+dXNlciA9IG5ldyB1c2VyKCR0aGlzKTsKCQkkdGhpcy0+cmVzb3VyY2VzID0gbmV3IHJlc291cmNlcygkdGhpcyk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGNvbmYoKXsgcmV0dXJuICR0aGlzLT5jb25mOyB9CglwdWJsaWMgZnVuY3Rpb24gZnMoKXsgcmV0dXJuICR0aGlzLT5mczsgfQoJcHVibGljIGZ1bmN0aW9uIHJlcSgpeyByZXR1cm4gJHRoaXMtPnJlcTsgfQoJcHVibGljIGZ1bmN0aW9uIHVzZXIoKXsgcmV0dXJuICR0aGlzLT51c2VyOyB9CglwdWJsaWMgZnVuY3Rpb24gdGhlbWUoKXsgcmV0dXJuICR0aGlzLT50aGVtZTsgfQoJcHVibGljIGZ1bmN0aW9uIHJlc291cmNlcygpeyByZXR1cm4gJHRoaXMtPnJlc291cmNlczsgfQoKCXB1YmxpYyBmdW5jdGlvbiBhcHBfaWQoKXsgcmV0dXJuICR0aGlzLT5hcHBfaWQ7IH0KCXB1YmxpYyBmdW5jdGlvbiBhcHBfbmFtZSgpeyByZXR1cm4gJHRoaXMtPmFwcF9uYW1lOyB9CgoJcHVibGljIGZ1bmN0aW9uIHJ1bigpewoJCWhlYWRlcignQ29udGVudC10eXBlOiB0ZXh0L2h0bWwnKTsgLy8gZGVmYXVsdAoKCQkkcm91dGUgPSBhcnJheSgKCi8qIHJvdXRlciAqLwoKCQkpOwoKCQkkYWN0aW9uID0gJHRoaXMtPnJlcS0+Z2V0X3BhcmFtKCdhJyk7CgkJJHJlc291cmNlID0gJHRoaXMtPnJlcS0+Z2V0X3BhcmFtKCdyZXMnKTsKCQkkY29udHJvbGxlciA9IG51bGw7CgkJJGFwcF9pbmZvID0gYXJyYXkoCgkJCSdpZCcgPT4gJHRoaXMtPmFwcF9pZCwKCQkJJ25hbWUnID0+ICR0aGlzLT5hcHBfbmFtZSwKCQkJJ3BhZ2VzJyA9PiAkcm91dGUsCgkJKTsKCQkkcGFnZV9pbmZvID0gYXJyYXkoCgkJCSdpZCcgPT4gJGFjdGlvbiwKCQkJJ3RpdGxlJyA9PiAnSG9tZScsCgkJKTsKCQkkdGhpcy0+dGhlbWUgPSBuZXcgdGhlbWUoICR0aGlzLCAkYXBwX2luZm8sICRwYWdlX2luZm8gKTsKCgkJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkvLyDjg6rjgr3jg7zjgrnjgbjjga7jg6rjgq/jgqjjgrnjg4jjgpLlh6bnkIYKCQlpZiggc3RybGVuKCRyZXNvdXJjZSA/PyAnJykgKXsKCQkJJHRoaXMtPnJlc291cmNlcy0+ZWNob19yZXNvdXJjZSggJHJlc291cmNlICk7CgkJCWV4aXQoKTsKCgkJfQoKCQkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCS8vIOODreOCsOOCpOODs+WHpueQhgoJCSRsb2dpbiA9IG5ldyBsb2dpbigkdGhpcywgJGFwcF9pbmZvKTsKCgkJaWYoICRhY3Rpb24gPT0gJ2xvZ291dCcgKXsKCQkJJGxvZ2luLT5sb2dvdXQoKTsKCQkJZXhpdDsKCQl9CgoJCWlmKCAhJGxvZ2luLT5jaGVjaygpICl7CgkJCWlmKCAkYWN0aW9uID09ICdsb2dvdXQnIHx8ICRhY3Rpb24gPT0gJ2xvZ2luJyApewoJCQkJJHRoaXMtPnJlcSgpLT5zZXRfcGFyYW0oJ2EnLCBudWxsKTsKCQkJfQoJCQkkbG9naW4tPnBsZWFzZV9sb2dpbigpOwoJCQlleGl0OwoJCX0KCgkJaWYoICRhY3Rpb24gPT0gJ2xvZ291dCcgfHwgJGFjdGlvbiA9PSAnbG9naW4nICl7CgkJCSR0aGlzLT5yZXEoKS0+c2V0X3BhcmFtKCdhJywgbnVsbCk7CgkJfQoKCQkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCS8vIG1pZGRsZXdhcmUKCgkJJG1pZGRsZXdhcmUgPSBhcnJheSgvKiBtaWRkbGV3YXJlICovKTsKCgkJZm9yZWFjaCggJG1pZGRsZXdhcmUgYXMgJG1ldGhvZCApewoJCQlsaXN0KCAkY2xhc3NOYW1lLCAkZnVuY05hbWUgKSA9IGV4cGxvZGUoJzo6JywgJG1ldGhvZCk7CgkJCSR0bXBfb2JqID0gbmV3ICRjbGFzc05hbWUoKTsKCQkJY2FsbF91c2VyX2Z1bmMoIGFycmF5KCR0bXBfb2JqLCAkZnVuY05hbWUpLCAkdGhpcyApOwoJCX0KCgoKCQkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCS8vIOOCs+ODs+ODhuODs+ODhOOCkuWHpueQhgoJCWlmKCBhcnJheV9rZXlfZXhpc3RzKCAkYWN0aW9uLCAkcm91dGUgKSApewoJCQkkY29udHJvbGxlciA9ICRyb3V0ZVskYWN0aW9uXTsKCQkJJHBhZ2VfaW5mb1sndGl0bGUnXSA9ICRjb250cm9sbGVyLT50aXRsZTsKCQkJJHRoaXMtPnRoZW1lKCktPnNldF9jdXJyZW50X3BhZ2VfaW5mbyggJHBhZ2VfaW5mbyApOwoKCQkJb2Jfc3RhcnQoKTsKCQkJY2FsbF91c2VyX2Z1bmMoICRjb250cm9sbGVyLT5wYWdlLCAkdGhpcyApOwoJCQkkY29udGVudCA9IG9iX2dldF9jbGVhbigpOwoKCgkJCSRodG1sID0gJHRoaXMtPnRoZW1lKCktPmJpbmQoICRjb250ZW50ICk7CgkJCWVjaG8gJGh0bWw7CgoJCX1lbHNlewoJCQkkdGhpcy0+bm90Zm91bmQoKTsKCQl9CgkJZXhpdCgpOwoJfQoKCgkvKioKCSAqIE5vdCBGb3VuZCDjg5rjg7zjgrjjgpLooajnpLrjgZfjgabntYLkuobjgZnjgosKCSAqLwoJcHVibGljIGZ1bmN0aW9uIG5vdGZvdW5kKCl7CgkJJHBhZ2VfaW5mb1sndGl0bGUnXSA9ICdOb3QgRm91bmQnOwoJCSR0aGlzLT50aGVtZSgpLT5zZXRfY3VycmVudF9wYWdlX2luZm8oICRwYWdlX2luZm8gKTsKCgkJJGNvbnRlbnQgPSAnPHA+NDA0OiBOb3QgRm91bmQ8L3A+JzsKCQkkaHRtbCA9ICR0aGlzLT50aGVtZSgpLT5iaW5kKCAkY29udGVudCApOwoJCWVjaG8gJGh0bWw7CgkJZXhpdDsKCX0KCgkvKioKCSAqIEZvcmJpZGRlbiDjg5rjg7zjgrjjgpLooajnpLrjgZfjgabntYLkuobjgZnjgosKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGZvcmJpZGRlbigpewoJCSRwYWdlX2luZm9bJ3RpdGxlJ10gPSAnRm9yYmlkZGVuJzsKCQkkdGhpcy0+dGhlbWUoKS0+c2V0X2N1cnJlbnRfcGFnZV9pbmZvKCAkcGFnZV9pbmZvICk7CgoJCSRjb250ZW50ID0gJzxwPjQwMzogRm9yYmlkZGVuPC9wPic7CgkJJGh0bWwgPSAkdGhpcy0+dGhlbWUoKS0+YmluZCggJGNvbnRlbnQgKTsKCQllY2hvICRodG1sOwoJCWV4aXQ7Cgl9Cgp9Cj8+',
           "conf" => 'PD9waHAKbmFtZXNwYWNlIHJlbmNvbkZyYW1ld29yazsKCi8qKgogKiByZW5jb24gY29uZiBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIGNvbmZ7Cglwcml2YXRlICRjb25mOwoJcHJpdmF0ZSAkY3VzdG9tX2R5bmFtaWNfcHJvcGVydHkgPSBhcnJheSgpOwoJcHVibGljICR1c2VyczsKCXB1YmxpYyAkZGF0YWJhc2VzOwoKCS8qKgoJICogQ29uc3RydWN0b3IKCSAqLwoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCAkY29uZiApewoJCSR0aGlzLT5jb25mID0gKG9iamVjdCkgJGNvbmY7CgkJZm9yZWFjaCggJHRoaXMtPmNvbmYgYXMgJGtleT0+JHZhbCApewoJCQkkdGhpcy0+eyRrZXl9ID0gJHZhbDsKCQl9CgoJCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJLy8gJGNvbmYtPnVzZXJzCgkJJHRoaXMtPnVzZXJzID0gbnVsbDsKCQlpZiggcHJvcGVydHlfZXhpc3RzKCAkY29uZiwgJ3VzZXJzJyApICYmICFpc19udWxsKCAkY29uZi0+dXNlcnMgKSApewoJCQkkdGhpcy0+dXNlcnMgPSAoYXJyYXkpICRjb25mLT51c2VyczsKCQl9CgoJCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJLy8gJGNvbmYtPmRhdGFiYXNlcwoJCSR0aGlzLT5kYXRhYmFzZXMgPSBudWxsOwoJCWlmKCBwcm9wZXJ0eV9leGlzdHMoICRjb25mLCAnZGF0YWJhc2VzJyApICYmICFpc19udWxsKCAkY29uZi0+ZGF0YWJhc2VzICkgKXsKCQkJJHRoaXMtPmRhdGFiYXNlcyA9IChhcnJheSkgJGNvbmYtPmRhdGFiYXNlczsKCQl9CgoJfQoKCS8qKgoJICog5YuV55qE44Gq44OX44Ot44OR44OG44Kj44KS55m76Yyy44GZ44KLCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX3NldCggJG5hbWUsICRwcm9wZXJ0eSApewoJCWlmKCBpc3NldCgkdGhpcy0+Y3VzdG9tX2R5bmFtaWNfcHJvcGVydHlbJG5hbWVdKSApewoJCQkkdGhpcy0+ZXJyb3IoJyRjb25mLT4nLiRuYW1lLicgaXMgYWxyZWFkeSByZWdpc3RlcmVkLicpOwoJCQlyZXR1cm47CgkJfQoJCSR0aGlzLT5jdXN0b21fZHluYW1pY19wcm9wZXJ0eVskbmFtZV0gPSAkcHJvcGVydHk7CgkJcmV0dXJuOwoJfQoKCS8qKgoJICog5YuV55qE44Gr6L+95Yqg44GV44KM44Gf44OX44Ot44OR44OG44Kj44KS5Y+W44KK5Ye644GZCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX2dldCggJG5hbWUgKXsKCQlyZXR1cm4gJHRoaXMtPmN1c3RvbV9keW5hbWljX3Byb3BlcnR5WyRuYW1lXSA/PyBudWxsOwoJfQoKCS8qKgoJICog44Kz44Oz44OV44Kj44Kw5YCk44KS5Y+W5b6X44GZ44KLCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXQoICRrZXkgPSBudWxsICl7CgkJaWYoIGlzX251bGwoICRrZXkgKSApewoJCQlyZXR1cm4gJHRoaXMtPmNvbmY7CgkJfQoJCWlmKCBwcm9wZXJ0eV9leGlzdHMoICR0aGlzLT5jb25mLCAka2V5ICkgKXsKCQkJcmV0dXJuICR0aGlzLT5jb25mLT57JGtleX07CgkJfQoJCXJldHVybiBmYWxzZTsKCX0KCgkvKioKCSAqIOODreOCsOOCpOODs+OBjOW/heimgeOBi++8nwoJICovCglwdWJsaWMgZnVuY3Rpb24gaXNfbG9naW5fcmVxdWlyZWQoKXsKCQlpZiggIWlzX2FycmF5KCR0aGlzLT51c2VycykgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4gdHJ1ZTsKCX0KCn0KPz4=',
           "filesystem" => 'PD9waHAKLyoqCiAqIHRvbWs3OS9maWxlc3lzdGVtCiAqCiAqIEBhdXRob3IgVG9tb3lhIEtveWFuYWdpIDx0b21rNzlAZ21haWwuY29tPgogKi8KCm5hbWVzcGFjZSByZW5jb25GcmFtZXdvcms7CgovKioKICogdG9tazc5L2ZpbGVzeXN0ZW0gY29yZSBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIGZpbGVzeXN0ZW17CgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjgYrjgojjgbPjg4fjgqPjg6zjgq/jg4jjg6rmk43kvZzmmYLjga7jg4fjg5Xjgqnjg6vjg4jjg5Hjg7zjg5/jg4Pjgrfjg6fjg7MKCSAqLwoJcHJpdmF0ZSAkZGVmYXVsdF9wZXJtaXNzaW9uID0gYXJyYXkoJ2Rpcic9PjA3NzUsJ2ZpbGUnPT4wNzc1KTsKCS8qKgoJICog44OV44Kh44Kk44Or44K344K544OG44Og44Gu5paH5a2X44K744OD44OICgkgKi8KCXByaXZhdGUgJGZpbGVzeXN0ZW1fZW5jb2RpbmcgPSBudWxsOwoKCS8qKgoJICog44Kz44Oz44K544OI44Op44Kv44K/CgkgKgoJICogQHBhcmFtIG9iamVjdCAkY29uZiDoqK3lrprjgqrjg5bjgrjjgqfjgq/jg4gKCSAqLwoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25mPW51bGwpewoJCSRjb25mID0ganNvbl9kZWNvZGUoIGpzb25fZW5jb2RlKCRjb25mKSwgdHJ1ZSApOwoJCWlmKCFpc19hcnJheSgkY29uZikpewoJCQkkY29uZiA9IGFycmF5KCk7CgkJfQoJCWlmKCBhcnJheV9rZXlfZXhpc3RzKCdmaWxlX2RlZmF1bHRfcGVybWlzc2lvbicsICRjb25mKSAmJiBzdHJsZW4oICRjb25mWydmaWxlX2RlZmF1bHRfcGVybWlzc2lvbiddID8/ICcnICkgKXsKCQkJJHRoaXMtPmRlZmF1bHRfcGVybWlzc2lvblsnZmlsZSddID0gb2N0ZGVjKCAkY29uZlsnZmlsZV9kZWZhdWx0X3Blcm1pc3Npb24nXSApOwoJCX0KCQlpZiggYXJyYXlfa2V5X2V4aXN0cygnZGlyX2RlZmF1bHRfcGVybWlzc2lvbicsICRjb25mKSAmJiBzdHJsZW4oICRjb25mWydkaXJfZGVmYXVsdF9wZXJtaXNzaW9uJ10gPz8gJycgKSApewoJCQkkdGhpcy0+ZGVmYXVsdF9wZXJtaXNzaW9uWydkaXInXSA9IG9jdGRlYyggJGNvbmZbJ2Rpcl9kZWZhdWx0X3Blcm1pc3Npb24nXSApOwoJCX0KCQlpZiggYXJyYXlfa2V5X2V4aXN0cygnZmlsZXN5c3RlbV9lbmNvZGluZycsICRjb25mKSAmJiBzdHJsZW4oICRjb25mWydmaWxlc3lzdGVtX2VuY29kaW5nJ10gPz8gJycgKSApewoJCQkkdGhpcy0+ZmlsZXN5c3RlbV9lbmNvZGluZyA9IHRyaW0oICRjb25mWydmaWxlc3lzdGVtX2VuY29kaW5nJ10gKTsKCQl9Cgl9CgoJLyoqCgkgKiDmm7jjgY3ovrzjgb8v5LiK5pu444GN44GX44Gm44KI44GE44Ki44Kk44OG44Og44GL5qSc6Ki844GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDmpJzoqLzlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDmm7jjgY3ovrzjgb/lj6/og73jgarloLTlkIggYHRydWVg44CB5LiN5Y+v6IO944Gq5aC05ZCI44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBpc193cml0YWJsZSggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCQlpZiggISR0aGlzLT5pc19maWxlKCRwYXRoKSApewoJCQlyZXR1cm4gaXNfd3JpdGFibGUoIGRpcm5hbWUoJHBhdGgpICk7CgkJfQoJCXJldHVybiBpc193cml0YWJsZSggJHBhdGggKTsKCX0gLy8gaXNfd3JpdGFibGUoKQoKCS8qKgoJICog6Kqt44G/6L6844KT44Gn44KI44GE44Ki44Kk44OG44Og44GL5qSc6Ki844GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDmpJzoqLzlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDoqq3jgb/ovrzjgb/lj6/og73jgarloLTlkIggYHRydWVg44CB5LiN5Y+v6IO944Gq5aC05ZCI44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBpc19yZWFkYWJsZSggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCQlyZXR1cm4gaXNfcmVhZGFibGUoICRwYXRoICk7Cgl9Ly9pc19yZWFkYWJsZSgpCgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjgYzlrZjlnKjjgZnjgovjgYvjganjgYbjgYvoqr/jgbnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoIOaknOiovOWvvuixoeOBruODkeOCuQoJICogQHJldHVybiBib29sIOODleOCoeOCpOODq+OBjOWtmOWcqOOBmeOCi+WgtOWQiCBgdHJ1ZWDjgIHlrZjlnKjjgZfjgarjgYTloLTlkIjjgIHjgb7jgZ/jga/jg4fjgqPjg6zjgq/jg4jjg6rjgYzlrZjlnKjjgZnjgovloLTlkIjjgasgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGlzX2ZpbGUoICRwYXRoICl7CgkJJHBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkcGF0aCk7CgkJcmV0dXJuIGlzX2ZpbGUoICRwYXRoICk7Cgl9Ly9pc19maWxlKCkKCgkvKioKCSAqIOOCt+ODs+ODnOODquODg+OCr+ODquODs+OCr+OBi+OBqeOBhuOBi+iqv+OBueOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg5qSc6Ki85a++6LGh44Gu44OR44K5CgkgKiBAcmV0dXJuIGJvb2wg44OV44Kh44Kk44Or44GM44K344Oz44Oc44Oq44OD44Kv44Oq44Oz44Kv44Gu5aC05ZCIIGB0cnVlYOOAgeWtmOWcqOOBl+OBquOBhOWgtOWQiOOAgeOBneOCjOS7peWkluOBruWgtOWQiOOBqyBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gaXNfbGluayggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCQlyZXR1cm4gaXNfbGluayggJHBhdGggKTsKCX0vL2lzX2xpbmsoKQoKCS8qKgoJICog44OH44Kj44Os44Kv44OI44Oq44GM5a2Y5Zyo44GZ44KL44GL44Gp44GG44GL6Kq/44G544KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDmpJzoqLzlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDjg4fjgqPjg6zjgq/jg4jjg6rjgYzlrZjlnKjjgZnjgovloLTlkIggYHRydWVg44CB5a2Y5Zyo44GX44Gq44GE5aC05ZCI44CB44G+44Gf44Gv44OV44Kh44Kk44Or44GM5a2Y5Zyo44GZ44KL5aC05ZCI44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBpc19kaXIoICRwYXRoICl7CgkJJHBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkcGF0aCk7CgkJcmV0dXJuIGlzX2RpciggJHBhdGggKTsKCX0vL2lzX2RpcigpCgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjgb7jgZ/jga/jg4fjgqPjg6zjgq/jg4jjg6rjgYzlrZjlnKjjgZnjgovjgYvjganjgYbjgYvoqr/jgbnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoIOaknOiovOWvvuixoeOBruODkeOCuQoJICogQHJldHVybiBib29sIOODleOCoeOCpOODq+OBvuOBn+OBr+ODh+OCo+ODrOOCr+ODiOODquOBjOWtmOWcqOOBmeOCi+WgtOWQiCBgdHJ1ZWDjgIHlrZjlnKjjgZfjgarjgYTloLTlkIjjgasgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGZpbGVfZXhpc3RzKCAkcGF0aCApewoJCSRwYXRoID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJHBhdGgpOwoJCXJldHVybiBmaWxlX2V4aXN0cyggJHBhdGggKTsKCX0gLy8gZmlsZV9leGlzdHMoKQoKCS8qKgoJICog44OH44Kj44Os44Kv44OI44Oq44KS5L2c5oiQ44GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZGlycGF0aCDkvZzmiJDjgZnjgovjg4fjgqPjg6zjgq/jg4jjg6rjga7jg5HjgrkKCSAqIEBwYXJhbSBpbnQgJHBlcm0g5L2c5oiQ44GZ44KL44OH44Kj44Os44Kv44OI44Oq44Gr5LiO44GI44KL44OR44O844Of44OD44K344On44OzCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmC44GrIGB0cnVlYOOAgeWkseaVl+aZguOBqyBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gbWtkaXIoICRkaXJwYXRoICwgJHBlcm0gPSBudWxsICl7CgkJJGRpcnBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkZGlycGF0aCk7CgoJCWlmKCAkdGhpcy0+aXNfZGlyKCAkZGlycGF0aCApICl7CgkJCS8vIOaXouOBq+ODh+OCo+ODrOOCr+ODiOODquOBjOOBguOBo+OBn+OCieOAgeS9nOaIkOOCkuippuOBv+OBquOBhOOAggoJCQkkdGhpcy0+Y2htb2QoICRkaXJwYXRoICwgJHBlcm0gKTsKCQkJcmV0dXJuIHRydWU7CgkJfQoJCSRyZXN1bHQgPSBAbWtkaXIoICRkaXJwYXRoICk7CgkJJHRoaXMtPmNobW9kKCAkZGlycGF0aCAsICRwZXJtICk7CgkJY2xlYXJzdGF0Y2FjaGUoKTsKCQlyZXR1cm4JJHJlc3VsdDsKCX0vL21rZGlyKCkKCgkvKioKCSAqIOODh+OCo+ODrOOCr+ODiOODquOCkuS9nOaIkOOBmeOCiyjkuIrlsaTjg4fjgqPjg6zjgq/jg4jjg6rjgoLlhajjgabkvZzmiJApCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZGlycGF0aCDkvZzmiJDjgZnjgovjg4fjgqPjg6zjgq/jg4jjg6rjga7jg5HjgrkKCSAqIEBwYXJhbSBpbnQgJHBlcm0g5L2c5oiQ44GZ44KL44OH44Kj44Os44Kv44OI44Oq44Gr5LiO44GI44KL44OR44O844Of44OD44K344On44OzCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmC44GrIGB0cnVlYOOAgeWkseaVl+aZguOBqyBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gbWtkaXJfciggJGRpcnBhdGggLCAkcGVybSA9IG51bGwgKXsKCQkkZGlycGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRkaXJwYXRoKTsKCQlpZiggJHRoaXMtPmlzX2RpciggJGRpcnBhdGggKSApewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJaWYoICR0aGlzLT5pc19maWxlKCAkZGlycGF0aCApICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJHBhdGhhcnJheSA9IGV4cGxvZGUoIERJUkVDVE9SWV9TRVBBUkFUT1IgLCAkdGhpcy0+bG9jYWxpemVfcGF0aCggJHRoaXMtPmdldF9yZWFscGF0aCgkZGlycGF0aCkgKSApOwoJCSR0YXJnZXRwYXRoID0gJyc7CgkJZm9yZWFjaCggJHBhdGhhcnJheSBhcyAkaWR4PT4kTGluZSApewoJCQlpZiggIXN0cmxlbiggJExpbmUgPz8gJycgKSB8fCAkTGluZSA9PSAnLicgfHwgJExpbmUgPT0gJy4uJyApeyBjb250aW51ZTsgfQoJCQlpZighKCRpZHg9PT0wICYmIERJUkVDVE9SWV9TRVBBUkFUT1IgPT0gJ1xcJyAmJiBwcmVnX21hdGNoKCcvXlthLXpBLVpdXDokL3MnLCAkTGluZSkpKXsKCQkJCSR0YXJnZXRwYXRoIC49IERJUkVDVE9SWV9TRVBBUkFUT1I7CgkJCX0KCQkJJHRhcmdldHBhdGggLj0gJExpbmU7CgoJCQkvLyBjbGVhcnN0YXRjYWNoZSgpOwoJCQlpZiggISR0aGlzLT5pc19kaXIoICR0YXJnZXRwYXRoICkgKXsKCQkJCSR0YXJnZXRwYXRoID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoICR0YXJnZXRwYXRoICk7CgkJCQlpZiggISR0aGlzLT5ta2RpciggJHRhcmdldHBhdGggLCAkcGVybSApICl7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiB0cnVlOwoJfS8vbWtkaXJfcigpCgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjgoTjg4fjgqPjg6zjgq/jg4jjg6rjgpLkuK3ouqvjgZTjgajlrozlhajjgavliYrpmaTjgZnjgovjgIIKCSAqCgkgKiDjgZPjga7jg6Hjgr3jg4Pjg4njga/jgIHjg5XjgqHjgqTjg6vjgoTjgrfjg7Pjg5zjg6rjg4Pjgq/jg6rjg7Pjgq/jgoLliYrpmaTjgZfjgb7jgZnjgIIKCSAqIOODh+OCo+ODrOOCr+ODiOODquOCkuWJiumZpOOBmeOCi+WgtOWQiOOBr+OAgeS4rei6q+OBlOOBqOWujOWFqOOBq+WJiumZpOOBl+OBvuOBmeOAggoJICog44K344Oz44Oc44Oq44OD44Kv44Oq44Oz44Kv44Gv44CB44Gd44Gu5YWI44KS6L+944KP44Ga44CB44K344Oz44Oc44Oq44OD44Kv44Oq44Oz44Kv5pys5L2T44Gu44G/44KS5YmK6Zmk44GX44G+44GZ44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBybSggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCQljbGVhcnN0YXRjYWNoZSgpOwoKCQlpZiggISR0aGlzLT5pc193cml0YWJsZSggJHBhdGggKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCWlmKCAkdGhpcy0+aXNfZmlsZSggJHBhdGggKSB8fCAkdGhpcy0+aXNfbGluayggJHBhdGggKSApewoJCQkvLyDjg5XjgqHjgqTjg6vjgb7jgZ/jga/jgrfjg7Pjg5zjg6rjg4Pjgq/jg6rjg7Pjgq/jga7loLTlkIjjga7lh6bnkIYKCQkJJHJlc3VsdCA9IHVubGluayggJHBhdGggKTsKCQkJcmV0dXJuCSRyZXN1bHQ7CgoJCX1lbHNlaWYoICR0aGlzLT5pc19kaXIoICRwYXRoICkgKXsKCQkJLy8g44OH44Kj44Os44Kv44OI44Oq44Gu5Yem55CGCgkJCSRmbGlzdCA9ICR0aGlzLT5scyggJHBhdGggKTsKCQkJaWYoIGlzX2FycmF5KCRmbGlzdCkgKXsKCQkJCWZvcmVhY2ggKCAkZmxpc3QgYXMgJExpbmUgKXsKCQkJCQlpZiggJExpbmUgPT0gJy4nIHx8ICRMaW5lID09ICcuLicgKXsgY29udGludWU7IH0KCQkJCQkkdGhpcy0+cm0oICRwYXRoLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgKTsKCQkJCX0KCQkJfQoJCQkkcmVzdWx0ID0gcm1kaXIoICRwYXRoICk7CgkJCXJldHVybgkkcmVzdWx0OwoKCQl9CgoJCXJldHVybiBmYWxzZTsKCX0vL3JtKCkKCgkvKioKCSAqIOODh+OCo+ODrOOCr+ODiOODquOCkuWJiumZpOOBmeOCi+OAggoJICoKCSAqIOOBk+OBruODoeOCveODg+ODieOBr+ODh+OCo+ODrOOCr+ODiOODquOCkuWJiumZpOOBl+OBvuOBmeOAggoJICog5Lit6Lqr44Gu44Gq44GE44CB56m644Gu44OH44Kj44Os44Kv44OI44Oq5Lul5aSW44Gv5YmK6Zmk44Gn44GN44G+44Gb44KT44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjg4fjgqPjg6zjgq/jg4jjg6rjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBybWRpciggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCgkJaWYoICEkdGhpcy0+aXNfd3JpdGFibGUoICRwYXRoICkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQkkcGF0aCA9IEByZWFscGF0aCggJHBhdGggKTsKCQlpZiggJHBhdGggPT09IGZhbHNlICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJaWYoICR0aGlzLT5pc19maWxlKCAkcGF0aCApIHx8ICR0aGlzLT5pc19saW5rKCAkcGF0aCApICl7CgkJCS8vIOODleOCoeOCpOODq+OBvuOBn+OBr+OCt+ODs+ODnOODquODg+OCr+ODquODs+OCr+OBruWgtOWQiOOBruWHpueQhgoJCQkvLyDjg4fjgqPjg6zjgq/jg4jjg6rku6XlpJbjga/liYrpmaTjgafjgY3jgb7jgZvjgpPjgIIKCQkJcmV0dXJuIGZhbHNlOwoKCQl9ZWxzZWlmKCAkdGhpcy0+aXNfZGlyKCAkcGF0aCApICl7CgkJCS8vIOODh+OCo+ODrOOCr+ODiOODquOBruWHpueQhgoJCQkvLyBybWRpcigpIOOBr+WGjeW4sOeahOWJiumZpOOCkuihjOOBhOOBvuOBm+OCk+OAggoJCQkvLyDlho3luLDnmoTjgavliYrpmaTjgZfjgZ/jgYTloLTlkIjjga/jgIHku6Pjgo/jgorjgasgYHJtKClgIOOBvuOBn+OBryBgcm1kaXJfcigpYCDjgpLkvb/nlKjjgZfjgb7jgZnjgIIKCQkJcmV0dXJuIEBybWRpciggJHBhdGggKTsKCQl9CgoJCXJldHVybiBmYWxzZTsKCX0vL3JtZGlyKCkKCgkvKioKCSAqIOODh+OCo+ODrOOCr+ODiOODquOCkuWGjeW4sOeahOOBq+WJiumZpOOBmeOCi+OAggoJICoKCSAqIOOBk+OBruODoeOCveODg+ODieOBr+ODh+OCo+ODrOOCr+ODiOODquOCkuWGjeW4sOeahOOBq+WJiumZpOOBl+OBvuOBmeOAggoJICog5Lit6Lqr44Gu44Gq44GE44CB56m644Gu44OH44Kj44Os44Kv44OI44Oq5Lul5aSW44Gv5YmK6Zmk44Gn44GN44G+44Gb44KT44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjg4fjgqPjg6zjgq/jg4jjg6rjga7jg5HjgrkKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBybWRpcl9yKCAkcGF0aCApewoJCSRwYXRoID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJHBhdGgpOwoKCQlpZiggISR0aGlzLT5pc193cml0YWJsZSggJHBhdGggKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCSRwYXRoID0gQHJlYWxwYXRoKCAkcGF0aCApOwoJCWlmKCAkcGF0aCA9PT0gZmFsc2UgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlpZiggJHRoaXMtPmlzX2ZpbGUoICRwYXRoICkgfHwgJHRoaXMtPmlzX2xpbmsoICRwYXRoICkgKXsKCQkJLy8g44OV44Kh44Kk44Or44G+44Gf44Gv44K344Oz44Oc44Oq44OD44Kv44Oq44Oz44Kv44Gu5aC05ZCI44Gu5Yem55CGCgkJCS8vIOODh+OCo+ODrOOCr+ODiOODquS7peWkluOBr+WJiumZpOOBp+OBjeOBvuOBm+OCk+OAggoJCQlyZXR1cm4gZmFsc2U7CgoJCX1lbHNlaWYoICR0aGlzLT5pc19kaXIoICRwYXRoICkgKXsKCQkJLy8g44OH44Kj44Os44Kv44OI44Oq44Gu5Yem55CGCgkJCSRmaWxlbGlzdCA9ICR0aGlzLT5scygkcGF0aCk7CgkJCWlmKCBpc19hcnJheSgkZmlsZWxpc3QpICl7CgkJCQlmb3JlYWNoKCAkZmlsZWxpc3QgYXMgJGJhc2VuYW1lICl7CgkJCQkJaWYoICR0aGlzLT5pc19maWxlKCAkcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRiYXNlbmFtZSApICl7CgkJCQkJCSR0aGlzLT5ybSggJHBhdGguRElSRUNUT1JZX1NFUEFSQVRPUi4kYmFzZW5hbWUgKTsKCQkJCQl9ZWxzZSBpZiggISR0aGlzLT5ybWRpcl9yKCAkcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRiYXNlbmFtZSApICl7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuICR0aGlzLT5ybWRpciggJHBhdGggKTsKCQl9CgoJCXJldHVybiBmYWxzZTsKCX0vL3JtZGlyX3IoKQoKCgkvKioKCSAqIOODleOCoeOCpOODq+OCkuS4iuabuOOBjeS/neWtmOOBmeOCi+OAggoJICoKCSAqIOOBk+OBruODoeOCveODg+ODieOBr+OAgWAkZmlsZXBhdGhgIOOBq+ODh+ODvOOCv+OCkuS/neWtmOOBl+OBvuOBmeOAggoJICog44KC44Go44KC44Go5L+d5a2Y44GV44KM44Gm44GE44Gf5YaF5a6544Gv56C05qOE44GV44KM44CB5paw44GX44GE44OH44O844K/44Gn5LiK5pu444GN44GX44G+44GZ44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZmlsZXBhdGgg5L+d5a2Y5YWI44OV44Kh44Kk44Or44Gu44OR44K5CgkgKiBAcGFyYW0gc3RyaW5nICRjb250ZW50IOS/neWtmOOBmeOCi+WGheWuuQoJICogQHBhcmFtIGludCAkcGVybSDkv53lrZjjgZnjgovjg5XjgqHjgqTjg6vjgavkuI7jgYjjgovjg5Hjg7zjg5/jg4Pjgrfjg6fjg7MKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBzYXZlX2ZpbGUoICRmaWxlcGF0aCAsICRjb250ZW50ICwgJHBlcm0gPSBudWxsICl7CgkJJGZpbGVwYXRoID0gJHRoaXMtPmdldF9yZWFscGF0aCgkZmlsZXBhdGgpOwoJCSRmaWxlcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRmaWxlcGF0aCk7CgoJCWlmKCAkdGhpcy0+aXNfZGlyKCAkZmlsZXBhdGggKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCWlmKCAhJHRoaXMtPmlzX3dyaXRhYmxlKCAkZmlsZXBhdGggKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlpZiggIXN0cmxlbiggJGNvbnRlbnQgPz8gJycgKSApewoJCQkvLyDnqbrnmb3jga7jg5XjgqHjgqTjg6vjgafkuIrmm7jjgY3jgZfjgZ/jgYTloLTlkIgKCQkJaWYoICR0aGlzLT5pc19maWxlKCAkZmlsZXBhdGggKSApewoJCQkJQHVubGluayggJGZpbGVwYXRoICk7CgkJCX0KCQkJQHRvdWNoKCAkZmlsZXBhdGggKTsKCQkJJHRoaXMtPmNobW9kKCAkZmlsZXBhdGggLCAkcGVybSApOwoJCQljbGVhcnN0YXRjYWNoZSgpOwoJCQlyZXR1cm4gJHRoaXMtPmlzX2ZpbGUoICRmaWxlcGF0aCApOwoJCX0KCgkJY2xlYXJzdGF0Y2FjaGUoKTsKCQkkZnAgPSBmb3BlbiggJGZpbGVwYXRoLCAndycgKTsKCQlpZiggIWlzX3Jlc291cmNlKCAkZnAgKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlmb3IgKCR3cml0dGVuID0gMDsgJHdyaXR0ZW4gPCBzdHJsZW4oJGNvbnRlbnQgPz8gJycpOyAkd3JpdHRlbiArPSAkZndyaXRlKSB7CgkJCSRmd3JpdGUgPSBmd3JpdGUoJGZwLCBzdWJzdHIoJGNvbnRlbnQsICR3cml0dGVuKSk7CgkJCWlmICgkZndyaXRlID09PSBmYWxzZSkgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCWZjbG9zZSgkZnApOwoKCQkkdGhpcy0+Y2htb2QoICRmaWxlcGF0aCAsICRwZXJtICk7CgkJY2xlYXJzdGF0Y2FjaGUoKTsKCQlyZXR1cm4gIWVtcHR5KCAkd3JpdHRlbiApOwoJfS8vc2F2ZV9maWxlKCkKCgkvKioKCSAqIOODleOCoeOCpOODq+OBruS4rei6q+OCkuaWh+Wtl+WIl+OBqOOBl+OBpuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg44OV44Kh44Kk44Or44Gu44OR44K5CgkgKiBAcmV0dXJuIHN0cmluZyDjg5XjgqHjgqTjg6sgYCRwYXRoYCDjga7lhoXlrrkKCSAqLwoJcHVibGljIGZ1bmN0aW9uIHJlYWRfZmlsZSggJHBhdGggKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCQlyZXR1cm4gZmlsZV9nZXRfY29udGVudHMoICRwYXRoICk7Cgl9Ly9maWxlX2dldF9jb250ZW50cygpCgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjga7mm7TmlrDml6XmmYLjgpLmr5TovIPjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoX2Eg5q+U6LyD5a++6LGhQQoJICogQHBhcmFtIHN0cmluZyAkcGF0aF9iIOavlOi8g+WvvuixoUIKCSAqIEByZXR1cm4gYm9vbHxudWxsCgkgKiBgJHBhdGhfYWAg44Gu5pa544GM5paw44GX44GL44Gj44Gf5aC05ZCI44GrIGB0cnVlYOOAgQoJICogYCRwYXRoX2JgIOOBruaWueOBjOaWsOOBl+OBi+OBo+OBn+WgtOWQiOOBqyBgZmFsc2Vg44CBCgkgKiDlkIzmmYLjgaDjgaPjgZ/loLTlkIjjgasgYG51bGxgIOOCkui/lOOBl+OBvuOBmeOAggoJICoKCSAqIOOBhOOBmuOCjOOBi+S4gOaWueOAgeOBvuOBn+OBr+S4oeaWueOBruODleOCoeOCpOODq+OBjOWtmOWcqOOBl+OBquOBhOWgtOWQiOOAgeasoeOBruOCiOOBhuOBq+aMr+OCi+iInuOBhOOBvuOBmeOAggoJICogLSDkuKHmlrnjga7jg5XjgqHjgqTjg6vjgYzlrZjlnKjjgZfjgarjgYTloLTlkIggPSBgbnVsbGAKCSAqIC0gJHBhdGhfYSDjgYzlrZjlnKjjgZvjgZrjgIEkcGF0aF9iIOOBr+WtmOWcqOOBmeOCi+WgtOWQiCA9IGBmYWxzZWAKCSAqIC0gJHBhdGhfYSDjgYzlrZjlnKjjgZfjgIEkcGF0aF9iIOOBr+WtmOWcqOOBl+OBquOBhOWgtOWQiCA9IGB0cnVlYAoJICovCglwdWJsaWMgZnVuY3Rpb24gaXNfbmV3ZXJfYV90aGFuX2IoICRwYXRoX2EgLCAkcGF0aF9iICl7CgkJJHBhdGhfYSA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoX2EpOwoJCSRwYXRoX2IgPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkcGF0aF9iKTsKCgkJLy8g5q+U6LyD44Gn44GN44Gq44GE5aC05ZCI44GrCgkJaWYoIWZpbGVfZXhpc3RzKCRwYXRoX2EpICYmICFmaWxlX2V4aXN0cygkcGF0aF9iKSl7cmV0dXJuIG51bGw7fQoJCWlmKCFmaWxlX2V4aXN0cygkcGF0aF9hKSl7cmV0dXJuIGZhbHNlO30KCQlpZighZmlsZV9leGlzdHMoJHBhdGhfYikpe3JldHVybiB0cnVlO30KCgkJJG10aW1lX2EgPSBmaWxlbXRpbWUoICRwYXRoX2EgKTsKCQkkbXRpbWVfYiA9IGZpbGVtdGltZSggJHBhdGhfYiApOwoJCWlmKCAkbXRpbWVfYSA+ICRtdGltZV9iICl7CgkJCXJldHVybiB0cnVlOwoJCX1lbHNlaWYoICRtdGltZV9hIDwgJG10aW1lX2IgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4gbnVsbDsKCX0vL2lzX25ld2VyX2FfdGhhbl9iKCkKCgkvKioKCSAqIOODleOCoeOCpOODq+WQjS/jg4fjgqPjg6zjgq/jg4jjg6rlkI3jgpLlpInmm7TjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRvcmlnaW5hbCDnj77lnKjjga7jg5XjgqHjgqTjg6vjgb7jgZ/jga/jg4fjgqPjg6zjgq/jg4jjg6rlkI0KCSAqIEBwYXJhbSBzdHJpbmcgJG5ld25hbWUg5aSJ5pu05b6M44Gu44OV44Kh44Kk44Or44G+44Gf44Gv44OH44Kj44Os44Kv44OI44Oq5ZCNCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmCIGB0cnVlYOOAgeWkseaVl+aZgiBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gcmVuYW1lKCAkb3JpZ2luYWwgLCAkbmV3bmFtZSApewoJCSRvcmlnaW5hbCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRvcmlnaW5hbCk7CgkJJG5ld25hbWUgID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJG5ld25hbWUgKTsKCgkJaWYoICFmaWxlX2V4aXN0cyggJG9yaWdpbmFsICkgKXsgcmV0dXJuIGZhbHNlOyB9CgkJaWYoICEkdGhpcy0+aXNfd3JpdGFibGUoICRvcmlnaW5hbCApICl7IHJldHVybiBmYWxzZTsgfQoJCXJldHVybiByZW5hbWUoICRvcmlnaW5hbCAsICRuZXduYW1lICk7Cgl9Ly9yZW5hbWUoKQoKCS8qKgoJICog44OV44Kh44Kk44Or5ZCNL+ODh+OCo+ODrOOCr+ODiOODquWQjeOCkuW8t+WItueahOOBq+WkieabtOOBmeOCi+OAggoJICoKCSAqIOenu+WLleWFiOOBruimquODh+OCo+ODrOOCr+ODiOODquOBjOWtmOWcqOOBl+OBquOBhOWgtOWQiOOBq+OCguOAgeimquODh+OCo+ODrOOCr+ODiOODquOCkuS9nOaIkOOBl+OBpuenu+WLleOBmeOCi+OCiOOBhuippuOBv+OBvuOBmeOAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJG9yaWdpbmFsIOePvuWcqOOBruODleOCoeOCpOODq+OBvuOBn+OBr+ODh+OCo+ODrOOCr+ODiOODquWQjQoJICogQHBhcmFtIHN0cmluZyAkbmV3bmFtZSDlpInmm7Tlvozjga7jg5XjgqHjgqTjg6vjgb7jgZ/jga/jg4fjgqPjg6zjgq/jg4jjg6rlkI0KCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYIgYHRydWVg44CB5aSx5pWX5pmCIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiByZW5hbWVfZiggJG9yaWdpbmFsICwgJG5ld25hbWUgKXsKCQkkb3JpZ2luYWwgPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkb3JpZ2luYWwpOwoJCSRuZXduYW1lICA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRuZXduYW1lICk7CgoJCWlmKCAhZmlsZV9leGlzdHMoICRvcmlnaW5hbCApICl7IHJldHVybiBmYWxzZTsgfQoJCWlmKCAhJHRoaXMtPmlzX3dyaXRhYmxlKCAkb3JpZ2luYWwgKSApeyByZXR1cm4gZmFsc2U7IH0KCQkkZGlybmFtZSA9IGRpcm5hbWUoICRuZXduYW1lICk7CgkJaWYoICEkdGhpcy0+aXNfZGlyKCAkZGlybmFtZSApICl7CgkJCWlmKCAhJHRoaXMtPm1rZGlyX3IoICRkaXJuYW1lICkgKXsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX0KCQlyZXR1cm4gcmVuYW1lKCAkb3JpZ2luYWwgLCAkbmV3bmFtZSApOwoJfSAvLyByZW5hbWVfZigpCgoJLyoqCgkgKiDntbblr77jg5HjgrnjgpLlvpfjgovjgIIKCSAqCgkgKiDjg5Hjgrnmg4XloLHjgpLlj5fjgZHlj5bjgorjgIHjgrnjg6njg4Pjgrfjg6XjgYvjgonlp4vjgb7jgovjgrXjg7zjg5Djg7zlhoXpg6jntbblr77jg5HjgrnjgavlpInmj5vjgZfjgabov5TjgZfjgb7jgZnjgIIKCSAqCgkgKiDjgZPjga7jg6Hjgr3jg4Pjg4njga/jgIFQSFDjga4gYHJlYWxwYXRoKClgIOOBqOeVsOOBquOCiuOAgeWtmOWcqOOBl+OBquOBhOODkeOCueOCgue1tuWvvuODkeOCueOBq+WkieaPm+OBl+OBvuOBmeOAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg5a++6LGh44Gu44OR44K5CgkgKiBAcGFyYW0gc3RyaW5nICRjZCDjgqvjg6zjg7Pjg4jjg4fjgqPjg6zjgq/jg4jjg6rjg5HjgrnjgIIKCSAqIOWun+WcqOOBmeOCi+acieWKueOBquODh+OCo+ODrOOCr+ODiOODquOBruODkeOCueOAgeOBvuOBn+OBr+e1tuWvvuODkeOCueOBruihqOePvuOBp+aMh+WumuOBleOCjOOCi+W/heimgeOBjOOBguOCiuOBvuOBmeOAggoJICog55yB55Wl5pmC44CB44Kr44Os44Oz44OI44OH44Kj44Os44Kv44OI44Oq44KS6Ieq5YuV5o6h55So44GX44G+44GZ44CCCgkgKiBAcmV0dXJuIHN0cmluZyDntbblr77jg5HjgrkKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9yZWFscGF0aCggJHBhdGgsICRjZCA9ICcuJyApewoJCSRpc19kaXIgPSBmYWxzZTsKCQlpZiggcHJlZ19tYXRjaCggJy8oXC98XFxcXCkrJC9zJywgJHBhdGggKSApewoJCQkkaXNfZGlyID0gdHJ1ZTsKCQl9CgkJJHBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkcGF0aCk7CgkJaWYoIGlzX251bGwoJGNkKSApeyAkY2QgPSAnLic7IH0KCQkkY2QgPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkY2QpOwoJCSRwcmVnX2RpcnNlcCA9IHByZWdfcXVvdGUoRElSRUNUT1JZX1NFUEFSQVRPUiwgJy8nKTsKCgkJaWYoICR0aGlzLT5pc19kaXIoJGNkKSApewoJCQkkY2QgPSByZWFscGF0aCgkY2QpOwoJCX1lbHNlaWYoICFwcmVnX21hdGNoKCcvXigoPzpbQS1aYS16XVxcOicuJHByZWdfZGlyc2VwLicpfCcuJHByZWdfZGlyc2VwLid7MSwyfSkoLio/KSQvJywgJGNkKSApewoJCQkkY2QgPSBmYWxzZTsKCQl9CgkJaWYoICRjZCA9PT0gZmFsc2UgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJJHByZWZpeCA9ICcnOwoJCSRsb2NhbHBhdGggPSAkcGF0aDsKCQlpZiggcHJlZ19tYXRjaCgnL14oKD86W0EtWmEtel1cXDonLiRwcmVnX2RpcnNlcC4nKXwnLiRwcmVnX2RpcnNlcC4nezEsMn0pKC4qPykkLycsICRwYXRoLCAkbWF0Y2hlZCkgKXsKCQkJLy8g44KC44Go44KC44Go57W25a++44OR44K544Gu5oyH5a6a44GL6Kq/44G544KLCgkJCSRwcmVmaXggPSBwcmVnX3JlcGxhY2UoJy8nLiRwcmVnX2RpcnNlcC4nJC8nLCAnJywgJG1hdGNoZWRbMV0pOwoJCQkkbG9jYWxwYXRoID0gJG1hdGNoZWRbMl07CgkJCSRjZCA9IG51bGw7IC8vIOWFg+OBruaMh+WumuOBjOe1tuWvvuODkeOCueOBoOOBo+OBn+OCieOAgeOCq+ODrOODs+ODiOODh+OCo+ODrOOCr+ODiOODquOBr+mWouS/guOBquOBhOOBruOBp+aNqOOBpuOCi+OAggoJCX0KCgkJJHBhdGggPSAkY2QuRElSRUNUT1JZX1NFUEFSQVRPUi4nLicuRElSRUNUT1JZX1NFUEFSQVRPUi4kbG9jYWxwYXRoOwoKCQlpZiggZmlsZV9leGlzdHMoICRwcmVmaXguJHBhdGggKSApewoJCQkkcnRuID0gcmVhbHBhdGgoICRwcmVmaXguJHBhdGggKTsKCQkJaWYoICRpc19kaXIgJiYgJHJ0biAhPSByZWFscGF0aCgnLycpICl7CgkJCQkkcnRuIC49IERJUkVDVE9SWV9TRVBBUkFUT1I7CgkJCX0KCQkJcmV0dXJuICRydG47CgkJfQoKCQkkcGF0aHMgPSBleHBsb2RlKCBESVJFQ1RPUllfU0VQQVJBVE9SLCAkcGF0aCApOwoJCSRwYXRoID0gJyc7CgkJZm9yZWFjaCggJHBhdGhzIGFzICRpZHg9PiRyb3cgKXsKCQkJaWYoICRyb3cgPT0gJycgfHwgJHJvdyA9PSAnLicgKXsKCQkJCWNvbnRpbnVlOwoJCQl9CgkJCWlmKCAkcm93ID09ICcuLicgKXsKCQkJCSRwYXRoID0gZGlybmFtZSgkcGF0aCk7CgkJCQlpZigkcGF0aCA9PSBESVJFQ1RPUllfU0VQQVJBVE9SKXsKCQkJCQkkcGF0aCA9ICcnOwoJCQkJfQoJCQkJY29udGludWU7CgkJCX0KCQkJaWYoISgkaWR4PT09MCAmJiBESVJFQ1RPUllfU0VQQVJBVE9SID09ICdcXCcgJiYgcHJlZ19tYXRjaCgnL15bYS16QS1aXVw6JC9zJywgJHJvdykpKXsKCQkJCSRwYXRoIC49IERJUkVDVE9SWV9TRVBBUkFUT1I7CgkJCX0KCQkJJHBhdGggLj0gJHJvdzsKCQl9CgoJCSRydG4gPSAkcHJlZml4LiRwYXRoOwoJCWlmKCAkaXNfZGlyICl7CgkJCSRydG4gLj0gRElSRUNUT1JZX1NFUEFSQVRPUjsKCQl9CgkJcmV0dXJuICRydG47Cgl9CgoJLyoqCgkgKiDnm7jlr77jg5HjgrnjgpLlvpfjgovjgIIKCSAqCgkgKiDjg5Hjgrnmg4XloLHjgpLlj5fjgZHlj5bjgorjgIHjg4njg4Pjg4jjgrnjg6njg4Pjgrfjg6XjgYvjgonlp4vjgb7jgovnm7jlr77ntbblr77jg5HjgrnjgavlpInmj5vjgZfjgabov5TjgZfjgb7jgZnjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoIOWvvuixoeOBruODkeOCuQoJICogQHBhcmFtIHN0cmluZyAkY2Qg44Kr44Os44Oz44OI44OH44Kj44Os44Kv44OI44Oq44OR44K544CCCgkgKiDlrp/lnKjjgZnjgovmnInlirnjgarjg4fjgqPjg6zjgq/jg4jjg6rjga7jg5HjgrnjgIHjgb7jgZ/jga/ntbblr77jg5Hjgrnjga7ooajnj77jgafmjIflrprjgZXjgozjgovlv4XopoHjgYzjgYLjgorjgb7jgZnjgIIKCSAqIOecgeeVpeaZguOAgeOCq+ODrOODs+ODiOODh+OCo+ODrOOCr+ODiOODquOCkuiHquWLleaOoeeUqOOBl+OBvuOBmeOAggoJICogQHJldHVybiBzdHJpbmcg55u45a++44OR44K5CgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfcmVsYXRlZHBhdGgoICRwYXRoLCAkY2QgPSAnLicgKXsKCQkkaXNfZGlyID0gZmFsc2U7CgkJaWYoIHByZWdfbWF0Y2goICcvKFwvfFxcXFwpKyQvcycsICRwYXRoICkgKXsKCQkJJGlzX2RpciA9IHRydWU7CgkJfQoJCWlmKCAhc3RybGVuKCAkY2QgPz8gJycgKSApewoJCQkkY2QgPSByZWFscGF0aCgnLicpOwoJCX1lbHNlaWYoICR0aGlzLT5pc19kaXIoJGNkKSApewoJCQkkY2QgPSByZWFscGF0aCgkY2QpOwoJCX1lbHNlaWYoICR0aGlzLT5pc19maWxlKCRjZCkgKXsKCQkJJGNkID0gcmVhbHBhdGgoZGlybmFtZSgkY2QpKTsKCQl9CgkJJHBhdGggPSAkdGhpcy0+Z2V0X3JlYWxwYXRoKCRwYXRoLCAkY2QpOwoKCQkkbm9ybWFsaXplID0gZnVuY3Rpb24oICR0bXBfcGF0aCwgJGZzICl7CgkJCSR0bXBfcGF0aCA9ICRmcy0+bG9jYWxpemVfcGF0aCggJHRtcF9wYXRoICk7CgkJCSRwcmVnX2RpcnNlcCA9IHByZWdfcXVvdGUoRElSRUNUT1JZX1NFUEFSQVRPUiwgJy8nKTsKCQkJaWYoIERJUkVDVE9SWV9TRVBBUkFUT1IgPT0gJ1xcJyApewoJCQkJJHRtcF9wYXRoID0gcHJlZ19yZXBsYWNlKCAnL15bYS16QS1aXVw6L3MnLCAnJywgJHRtcF9wYXRoICk7CgkJCX0KCQkJJHRtcF9wYXRoID0gcHJlZ19yZXBsYWNlKCAnL14oJy4kcHJlZ19kaXJzZXAuJykrL3MnLCAnJywgJHRtcF9wYXRoICk7CgkJCSR0bXBfcGF0aCA9IHByZWdfcmVwbGFjZSggJy8oJy4kcHJlZ19kaXJzZXAuJykrJC9zJywgJycsICR0bXBfcGF0aCApOwoJCQlpZiggc3RybGVuKCR0bXBfcGF0aCA/PyAnJykgKXsKCQkJCSR0bXBfcGF0aCA9IGV4cGxvZGUoIERJUkVDVE9SWV9TRVBBUkFUT1IsICR0bXBfcGF0aCApOwoJCQl9ZWxzZXsKCQkJCSR0bXBfcGF0aCA9IGFycmF5KCk7CgkJCX0KCgkJCXJldHVybiAkdG1wX3BhdGg7CgkJfTsKCgkJJGNkID0gJG5vcm1hbGl6ZSgkY2QsICR0aGlzKTsKCQkkcGF0aCA9ICRub3JtYWxpemUoJHBhdGgsICR0aGlzKTsKCgkJJHJ0biA9IGFycmF5KCk7CgkJd2hpbGUoIDEgKXsKCQkJaWYoICFjb3VudCgkY2QpIHx8ICFjb3VudCgkcGF0aCkgKXsKCQkJCWJyZWFrOwoJCQl9CgkJCWlmKCAkY2RbMF0gPT09ICRwYXRoWzBdICl7CgkJCQlhcnJheV9zaGlmdCggJGNkICk7CgkJCQlhcnJheV9zaGlmdCggJHBhdGggKTsKCQkJCWNvbnRpbnVlOwoJCQl9CgkJCWJyZWFrOwoJCX0KCQlpZiggY291bnQoJGNkKSApewoJCQlmb3JlYWNoKCRjZCBhcyAkZGlybmFtZSl7CgkJCQlhcnJheV9wdXNoKCAkcnRuLCAnLi4nICk7CgkJCX0KCQl9ZWxzZXsKCQkJYXJyYXlfcHVzaCggJHJ0biwgJy4nICk7CgkJfQoJCSRydG4gPSBhcnJheV9tZXJnZSggJHJ0biwgJHBhdGggKTsKCQkkcnRuID0gaW1wbG9kZSggRElSRUNUT1JZX1NFUEFSQVRPUiwgJHJ0biApOwoKCQlpZiggJGlzX2RpciApewoJCQkkcnRuIC49IERJUkVDVE9SWV9TRVBBUkFUT1I7CgkJfQoJCXJldHVybiAkcnRuOwoJfQoKCS8qKgoJICog44OR44K55oOF5aCx44KS5b6X44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gYXJyYXkg44OR44K55oOF5aCxCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBwYXRoaW5mbyggJHBhdGggKXsKCQlpZihzdHJwb3MoJHBhdGgsJyMnKSE9PWZhbHNlKXsgbGlzdCgkcGF0aCwgJGhhc2gpID0gZXhwbG9kZSggJyMnLCAkcGF0aCwgMiApOyB9CgkJaWYoc3RycG9zKCRwYXRoLCc/JykhPT1mYWxzZSl7IGxpc3QoJHBhdGgsICRxdWVyeSkgPSBleHBsb2RlKCAnPycsICRwYXRoLCAyICk7IH0KCgkJJHBhdGhpbmZvID0gcGF0aGluZm8oICRwYXRoICk7CgkJJHBhdGhpbmZvWydmaWxlbmFtZSddID0gJHRoaXMtPnRyaW1fZXh0ZW5zaW9uKCAkcGF0aGluZm9bJ2Jhc2VuYW1lJ10gKTsKCQkkcGF0aGluZm9bJ2V4dGVuc2lvbiddID0gJHRoaXMtPmdldF9leHRlbnNpb24oICRwYXRoaW5mb1snYmFzZW5hbWUnXSApOwoJCSRwYXRoaW5mb1sncXVlcnknXSA9IChpc3NldCgkcXVlcnkpJiZzdHJsZW4oJHF1ZXJ5ID8/ICcnKSA/ICc/Jy4kcXVlcnkgOiBudWxsKTsKCQkkcGF0aGluZm9bJ2hhc2gnXSA9IChpc3NldCgkaGFzaCkmJnN0cmxlbigkaGFzaCA/PyAnJykgPyAnIycuJGhhc2ggOiBudWxsKTsKCQlyZXR1cm4gJHBhdGhpbmZvOwoJfQoKCS8qKgoJICog44OR44K55oOF5aCx44GL44KJ44CB44OV44Kh44Kk44Or5ZCN44KS5Y+W5b6X44GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gc3RyaW5nIOaKnOOBjeWHuuOBleOCjOOBn+ODleOCoeOCpOODq+WQjQoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0X2Jhc2VuYW1lKCAkcGF0aCApewoJCSRwYXRoID0gcGF0aGluZm8oICRwYXRoICwgUEFUSElORk9fQkFTRU5BTUUgKTsKCQlpZiggIXN0cmxlbigkcGF0aCA/PyAnJykgKXskcGF0aCA9IG51bGw7fQoJCXJldHVybiAkcGF0aDsKCX0KCgkvKioKCSAqIOODkeOCueaDheWgseOBi+OCieOAgeaLoeW8teWtkOOCkumZpOOBhOOBn+ODleOCoeOCpOODq+WQjeOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg5a++6LGh44Gu44OR44K5CgkgKiBAcmV0dXJuIHN0cmluZyDmi6HlvLXlrZDjgYzpmaTjgYvjgozjgZ/jg5HjgrkKCSAqLwoJcHVibGljIGZ1bmN0aW9uIHRyaW1fZXh0ZW5zaW9uKCAkcGF0aCApewoJCSRwYXRoaW5mbyA9IHBhdGhpbmZvKCAkcGF0aCApOwoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cygnZXh0ZW5zaW9uJywgJHBhdGhpbmZvKSApewoJCQkkcGF0aGluZm9bJ2V4dGVuc2lvbiddID0gJyc7CgkJfQoJCSRSVE4gPSBwcmVnX3JlcGxhY2UoICcvXC4nLnByZWdfcXVvdGUoICRwYXRoaW5mb1snZXh0ZW5zaW9uJ10sICcvJyApLickLycgLCAnJyAsICRwYXRoICk7CgkJcmV0dXJuICRSVE47Cgl9CgoJLyoqCgkgKiDjg5XjgqHjgqTjg6vlkI3jgpLlkKvjgoDjg5Hjgrnmg4XloLHjgYvjgonjgIHjg5XjgqHjgqTjg6vjgYzmoLzntI3jgZXjgozjgabjgYTjgovjg4fjgqPjg6zjgq/jg4jjg6rlkI3jgpLlj5blvpfjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoIOWvvuixoeOBruODkeOCuQoJICogQHJldHVybiBzdHJpbmcg6Kaq44OH44Kj44Os44Kv44OI44Oq44Gu44OR44K5CgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfZGlycGF0aCggJHBhdGggKXsKCQkkcGF0aCA9IHBhdGhpbmZvKCAkcGF0aCAsIFBBVEhJTkZPX0RJUk5BTUUgKTsKCQlpZiggIXN0cmxlbigkcGF0aCA/PyAnJykgKXskcGF0aCA9IG51bGw7fQoJCXJldHVybiAkcGF0aDsKCX0KCgkvKioKCSAqIOODkeOCueaDheWgseOBi+OCieOAgeaLoeW8teWtkOOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg5a++6LGh44Gu44OR44K5CgkgKiBAcmV0dXJuIHN0cmluZyDmi6HlvLXlrZAKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9leHRlbnNpb24oICRwYXRoICl7CgkJJHBhdGggPSBwcmVnX3JlcGxhY2UoJy9cIy4qJC9zaScsICcnLCAkcGF0aCk7CgkJJHBhdGggPSBwcmVnX3JlcGxhY2UoJy9cPy4qJC9zaScsICcnLCAkcGF0aCk7CgkJJHBhdGggPSBwYXRoaW5mbyggJHBhdGggLCBQQVRISU5GT19FWFRFTlNJT04gKTsKCQlpZighc3RybGVuKCRwYXRoID8/ICcnKSl7JHBhdGggPSBudWxsO30KCQlyZXR1cm4gJHBhdGg7Cgl9CgoKCS8qKgoJICogQ1NW44OV44Kh44Kk44Or44KS6Kqt44G/6L6844KA44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjga5DU1bjg5XjgqHjgqTjg6vjga7jg5HjgrkKCSAqIEBwYXJhbSBhcnJheSAkb3B0aW9ucyDjgqrjg5fjgrfjg6fjg7MKCSAqIC0gZGVsaW1pdGVyID0g5Yy65YiH44KK5paH5a2XKOecgeeVpeaZguOAgeOCq+ODs+ODnikKCSAqIC0gZW5jbG9zdXJlID0g44Kv44Ot44O844K444Oj44O85paH5a2XKOecgeeVpeaZguOAgeODgOODluODq+OCr+OCquODvOODiCkKCSAqIC0gc2l6ZSA9IOS4gOW6puOBq+iqreOBv+i+vOOCgOOCteOCpOOCuijnnIHnlaXmmYLjgIExMDAwMCkKCSAqIC0gY2hhcnNldCA9IOaWh+Wtl+OCu+ODg+ODiCjnnIHnlaXmmYLjgIFVVEYtOCkKCSAqIEByZXR1cm4gYXJyYXl8Ym9vbCDoqq3jgb/ovrzjgb/jgavmiJDlip/jgZfjgZ/loLTlkIjjgIHooYzliJfjgpLmoLzntI3jgZfjgZ/phY3liJfjgIHlpLHmlZfjgZfjgZ/loLTlkIjjgavjga8gYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIHJlYWRfY3N2KCAkcGF0aCAsICRvcHRpb25zID0gYXJyYXkoKSApewoJCS8vICRvcHRpb25zWydjaGFyc2V0J10g44Gv44CB5L+d5a2Y44GV44KM44Gm44GE44KLQ1NW44OV44Kh44Kk44Or44Gu5paH5a2X44Ko44Oz44Kz44O844OJ44Gn44GZ44CCCgkJLy8g55yB55Wl5pmC44GvIFVURi04IOOBi+OCieOAgeWGhemDqOOCqOODs+OCs+ODvOODh+OCo+ODs+OCsOOBq+WkieaPm+OBl+OBvuOBmeOAggoKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCgkJaWYoICEkdGhpcy0+aXNfZmlsZSggJHBhdGggKSApewoJCQkvLyDjg5XjgqHjgqTjg6vjgYzjgarjgZHjgozjgbBmYWxzZeOCkui/lOOBmQoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQkvLyBOb3JtYWxpemUgJG9wdGlvbnMKCQlpZiggIWlzX2FycmF5KCRvcHRpb25zKSApewoJCQkkb3B0aW9ucyA9IGFycmF5KCk7CgkJfQoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cyggJ2NoYXJzZXQnLCAkb3B0aW9ucyApICl7ICRvcHRpb25zWydjaGFyc2V0J10gPSBudWxsOyB9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnZGVsaW1pdGVyJywgJG9wdGlvbnMgKSApeyAkb3B0aW9uc1snZGVsaW1pdGVyJ10gPSBudWxsOyB9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnZW5jbG9zdXJlJywgJG9wdGlvbnMgKSApeyAkb3B0aW9uc1snZW5jbG9zdXJlJ10gPSBudWxsOyB9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnc2l6ZScsICRvcHRpb25zICkgKXsgJG9wdGlvbnNbJ3NpemUnXSA9IG51bGw7IH0KCQlpZiggIWFycmF5X2tleV9leGlzdHMoICdjaGFyc2V0JywgJG9wdGlvbnMgKSApeyAkb3B0aW9uc1snY2hhcnNldCddID0gbnVsbDsgfQoKCQlpZiggIXN0cmxlbiggJG9wdGlvbnNbJ2RlbGltaXRlciddID8/ICcnICkgKSAgICB7ICRvcHRpb25zWydkZWxpbWl0ZXInXSA9ICcsJzsgfQoJCWlmKCAhc3RybGVuKCAkb3B0aW9uc1snZW5jbG9zdXJlJ10gPz8gJycgKSApICAgIHsgJG9wdGlvbnNbJ2VuY2xvc3VyZSddID0gJyInOyB9CgkJaWYoICFzdHJsZW4oICRvcHRpb25zWydzaXplJ10gPz8gJycgKSApICAgICAgICAgeyAkb3B0aW9uc1snc2l6ZSddID0gMTAwMDA7IH0KCQlpZiggIXN0cmxlbiggJG9wdGlvbnNbJ2NoYXJzZXQnXSA/PyAnJyApICkgICAgICB7ICRvcHRpb25zWydjaGFyc2V0J10gPSAnVVRGLTgnOyB9Ly/ihpBDU1bjga7mloflrZfjgrvjg4Pjg4gKCgkJJFJUTiA9IGFycmF5KCk7CgkJJGZwID0gZm9wZW4oICRwYXRoLCAncicgKTsKCQlpZiggIWlzX3Jlc291cmNlKCAkZnAgKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQl3aGlsZSggJFNNTUVNTyA9IGZnZXRjc3YoICRmcCAsIGludHZhbCggJG9wdGlvbnNbJ3NpemUnXSApICwgJG9wdGlvbnNbJ2RlbGltaXRlciddICwgJG9wdGlvbnNbJ2VuY2xvc3VyZSddICkgKXsKCQkJZm9yZWFjaCggJFNNTUVNTyBhcyAka2V5PT4kcm93ICl7CgkJCQkkU01NRU1PWyRrZXldID0gbWJfY29udmVydF9lbmNvZGluZyggJHJvdyAsIG1iX2ludGVybmFsX2VuY29kaW5nKCkgLCAkb3B0aW9uc1snY2hhcnNldCddLicsVVRGLTgsU0pJUy13aW4sZXVjSlAtd2luLFNKSVMsRVVDLUpQJyApOwoJCQl9CgkJCWFycmF5X3B1c2goICRSVE4gLCAkU01NRU1PICk7CgkJfQoJCWZjbG9zZSgkZnApOwoJCXJldHVybiAkUlROOwoJfSAvLyByZWFkX2NzdigpCgoJLyoqCgkgKiDphY3liJfjgpJDU1blvaLlvI/jgavlpInmj5vjgZnjgovjgIIKCSAqCgkgKiDmlLnooYzjgrPjg7zjg4njga9MRuOBp+WHuuWKm+OBleOCjOOBvuOBmeOAggoJICoKCSAqIEBwYXJhbSBhcnJheSAkYXJyYXkgMuasoeWFg+mFjeWIlwoJICogQHBhcmFtIGFycmF5ICRvcHRpb25zIOOCquODl+OCt+ODp+ODswoJICogLSBjaGFyc2V0ID0g5paH5a2X44K744OD44OIKOecgeeVpeaZguOAgVVURi04KQoJICogQHJldHVybiBzdHJpbmcg55Sf5oiQ44GV44KM44GfQ1NW5b2i5byP44Gu44OG44Kt44K544OICgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBta19jc3YoICRhcnJheSAsICRvcHRpb25zID0gYXJyYXkoKSApewoJCS8vICRvcHRpb25zWydjaGFyc2V0J10g44Gv44CB5Ye65Yqb44GV44KM44KLQ1NW5b2i5byP44Gu5paH5a2X44Ko44Oz44Kz44O844OJ44KS5oyH5a6a44GX44G+44GZ44CCCgkJLy8g55yB55Wl5pmC44GvIFVURi04IOOBq+WkieaPm+OBl+OBpui/lOOBl+OBvuOBmeOAggoJCWlmKCAhaXNfYXJyYXkoICRhcnJheSApICl7ICRhcnJheSA9IGFycmF5KCk7IH0KCgkJLy8gTm9ybWFsaXplICRvcHRpb25zCgkJaWYoICFpc19hcnJheSgkb3B0aW9ucykgKXsKCQkJJG9wdGlvbnMgPSBhcnJheSgpOwoJCX0KCQlpZiggIWFycmF5X2tleV9leGlzdHMoICdjaGFyc2V0JywgJG9wdGlvbnMgKSApewoJCQkkb3B0aW9uc1snY2hhcnNldCddID0gbnVsbDsKCQl9CgkJaWYoICFzdHJsZW4oICRvcHRpb25zWydjaGFyc2V0J10gPz8gJycgKSApewoJCQkkb3B0aW9uc1snY2hhcnNldCddID0gJ1VURi04JzsKCQl9CgoJCSRSVE4gPSAnJzsKCQlmb3JlYWNoKCAkYXJyYXkgYXMgJExpbmUgKXsKCQkJaWYoIGlzX251bGwoICRMaW5lICkgKXsgY29udGludWU7IH0KCQkJaWYoICFpc19hcnJheSggJExpbmUgKSApeyAkTGluZSA9IGFycmF5KCk7IH0KCQkJZm9yZWFjaCggJExpbmUgYXMgJGNlbGwgKXsKCQkJCSRjZWxsID0gbWJfY29udmVydF9lbmNvZGluZyggJGNlbGwgLCAkb3B0aW9uc1snY2hhcnNldCddICwgbWJfaW50ZXJuYWxfZW5jb2RpbmcoKS4nLFVURi04LFNKSVMtd2luLGV1Y0pQLXdpbixTSklTLEVVQy1KUCcgKTsKCQkJCWlmKCBwcmVnX21hdGNoKCAnLyIvJyAsICRjZWxsICkgKXsKCQkJCQkkY2VsbCA9IHByZWdfcmVwbGFjZSggJy8iLycgLCAnIiInICwgJGNlbGwpOwoJCQkJfQoJCQkJaWYoIHN0cmxlbiggJGNlbGwgPz8gJycgKSApewoJCQkJCSRjZWxsID0gJyInLiRjZWxsLiciJzsKCQkJCX0KCQkJCSRSVE4gLj0gJGNlbGwuJywnOwoJCQl9CgkJCSRSVE4gPSBwcmVnX3JlcGxhY2UoICcvLCQvJyAsICcnICwgJFJUTiApOwoJCQkkUlROIC49ICJcbiI7CgkJfQoJCXJldHVybiAkUlROOwoJfSAvLyBta19jc3YoKQoKCS8qKgoJICog44OV44Kh44Kk44Or44KS6KSH6KO944GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZnJvbSDjgrPjg5Tjg7zlhYPjg5XjgqHjgqTjg6vjga7jg5HjgrkKCSAqIEBwYXJhbSBzdHJpbmcgJHRvIOOCs+ODlOODvOWFiOOBruODkeOCuQoJICogQHBhcmFtIGludCAkcGVybSDkv53lrZjjgZnjgovjg5XjgqHjgqTjg6vjgavkuI7jgYjjgovjg5Hjg7zjg5/jg4Pjgrfjg6fjg7MKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBjb3B5KCAkZnJvbSAsICR0byAsICRwZXJtID0gbnVsbCApewoJCSRmcm9tID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJGZyb20pOwoJCSR0byAgID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJHRvICApOwoKCQlpZiggISR0aGlzLT5pc19maWxlKCAkZnJvbSApICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJaWYoICEkdGhpcy0+aXNfcmVhZGFibGUoICRmcm9tICkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJaWYoICR0aGlzLT5pc19maWxlKCAkdG8gKSApewoJCQkvLwnjgb7jgaPjgZ/jgY/lkIzjgZjjg5XjgqHjgqTjg6vjgaDjgaPjgZ/loLTlkIjjga/jgIHopIfoo73jgZfjgarjgYTjgad0cnVl44KS6L+U44GZ44CCCgkJCWlmKCBtZDVfZmlsZSggJGZyb20gKSA9PSBtZDVfZmlsZSggJHRvICkgJiYgZmlsZXNpemUoICRmcm9tICkgPT0gZmlsZXNpemUoICR0byApICl7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCX0KCQlpZiggIUBjb3B5KCAkZnJvbSAsICR0byApICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJHRoaXMtPmNobW9kKCAkdG8gLCAkcGVybSApOwoJCXJldHVybiB0cnVlOwoJfS8vY29weSgpCgoJLyoqCgkgKiDjg4fjgqPjg6zjgq/jg4jjg6rjgpLlho3luLDnmoTjgavopIfoo73jgZnjgoso5LiL5bGk44OH44Kj44Os44Kv44OI44Oq44KC5YWo44Gm44Kz44OU44O8KQoJICoKCSAqIOODh+OCo+ODrOOCr+ODiOODquOCkuOAgeWQq+OBvuOCjOOCi+WGheWuueOBlOOBqOikh+ijveOBl+OBvuOBmeOAggoJICog5Y+X44GR5Y+W44Gj44Gf44OR44K544GM44OV44Kh44Kk44Or44Gu5aC05ZCI44Gv44CB5Y2Y5L2T44Gu44OV44Kh44Kk44Or44GM6KSH6KO944GV44KM44G+44GZ44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZnJvbSDjgrPjg5Tjg7zlhYPjg5XjgqHjgqTjg6vjga7jg5HjgrkKCSAqIEBwYXJhbSBzdHJpbmcgJHRvIOOCs+ODlOODvOWFiOOBruODkeOCuQoJICogQHBhcmFtIGludCAkcGVybSDkv53lrZjjgZnjgovjg5XjgqHjgqTjg6vjgavkuI7jgYjjgovjg5Hjg7zjg5/jg4Pjgrfjg6fjg7MKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBjb3B5X3IoICRmcm9tICwgJHRvICwgJHBlcm0gPSBudWxsICl7CgkJJGZyb20gPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkZnJvbSk7CgkJJHRvICAgPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkdG8gICk7CgoJCSRyZXN1bHQgPSB0cnVlOwoKCQlpZiggJHRoaXMtPmlzX2ZpbGUoICRmcm9tICkgKXsKCQkJaWYoICR0aGlzLT5ta2Rpcl9yKCBkaXJuYW1lKCAkdG8gKSApICl7CgkJCQlpZiggISR0aGlzLT5jb3B5KCAkZnJvbSAsICR0byAsICRwZXJtICkgKXsKCQkJCQkkcmVzdWx0ID0gZmFsc2U7CgkJCQl9CgkJCX1lbHNlewoJCQkJJHJlc3VsdCA9IGZhbHNlOwoJCQl9CgkJfWVsc2VpZiggJHRoaXMtPmlzX2RpciggJGZyb20gKSApewoJCQlpZiggISR0aGlzLT5pc19kaXIoICR0byApICl7CgkJCQlpZiggISR0aGlzLT5ta2Rpcl9yKCAkdG8gKSApewoJCQkJCSRyZXN1bHQgPSBmYWxzZTsKCQkJCX0KCQkJfQoJCQkkaXRlbWxpc3QgPSAkdGhpcy0+bHMoICRmcm9tICk7CgkJCWlmKCBpc19hcnJheSgkaXRlbWxpc3QpICl7CgkJCQlmb3JlYWNoKCAkaXRlbWxpc3QgYXMgJExpbmUgKXsKCQkJCQlpZiggJExpbmUgPT0gJy4nIHx8ICRMaW5lID09ICcuLicgKXsgY29udGludWU7IH0KCQkJCQlpZiggJHRoaXMtPmlzX2RpciggJGZyb20uRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSApICl7CgkJCQkJCWlmKCAkdGhpcy0+aXNfZmlsZSggJHRvLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgKSApewoJCQkJCQkJY29udGludWU7CgkJCQkJCX1lbHNlaWYoICEkdGhpcy0+aXNfZGlyKCAkdG8uRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSApICl7CgkJCQkJCQlpZiggISR0aGlzLT5ta2Rpcl9yKCAkdG8uRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSApICl7CgkJCQkJCQkJJHJlc3VsdCA9IGZhbHNlOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWlmKCAhJHRoaXMtPmNvcHlfciggJGZyb20uRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSAsICR0by5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICwgJHBlcm0gKSApewoJCQkJCQkJJHJlc3VsdCA9IGZhbHNlOwoJCQkJCQl9CgkJCQkJCWNvbnRpbnVlOwoJCQkJCX1lbHNlaWYoICR0aGlzLT5pc19maWxlKCAkZnJvbS5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICkgKXsKCQkJCQkJaWYoICEkdGhpcy0+Y29weV9yKCAkZnJvbS5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICwgJHRvLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgLCAkcGVybSApICl7CgkJCQkJCQkkcmVzdWx0ID0gZmFsc2U7CgkJCQkJCX0KCQkJCQkJY29udGludWU7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gJHJlc3VsdDsKCX0gLy8gY29weV9yKCkKCgkvKioKCSAqIOODkeODvOODn+ODg+OCt+ODp+ODs+OCkuWkieabtOOBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGZpbGVwYXRoIOWvvuixoeOBruODkeOCuQoJICogQHBhcmFtIGludCAkcGVybSDkuI7jgYjjgovjg5Hjg7zjg5/jg4Pjgrfjg6fjg7MKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYLjgasgYHRydWVg44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBjaG1vZCggJGZpbGVwYXRoLCAkcGVybSA9IG51bGwgKXsKCQkkZmlsZXBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkZmlsZXBhdGgpOwoJCWlmKCAhZmlsZV9leGlzdHMoJGZpbGVwYXRoKSApewoJCQlyZXR1cm47CgkJfQoKCQlpZiggaXNfbnVsbCggJHBlcm0gKSApewoJCQlpZiggJHRoaXMtPmlzX2RpciggJGZpbGVwYXRoICkgKXsKCQkJCSRwZXJtID0gJHRoaXMtPmRlZmF1bHRfcGVybWlzc2lvblsnZGlyJ107CgkJCX1lbHNlewoJCQkJJHBlcm0gPSAkdGhpcy0+ZGVmYXVsdF9wZXJtaXNzaW9uWydmaWxlJ107CgkJCX0KCQl9CgkJaWYoIGlzX251bGwoICRwZXJtICkgKXsKCQkJJHBlcm0gPSAwNzc1OyAvLyDjgrPjg7Pjg5XjgqPjgrDjgavoqK3lrprjg6Ljg6zjgYzjgYLjgaPjgZ/loLTlkIgKCQl9CgkJcmV0dXJuIGNobW9kKCAkZmlsZXBhdGggLCAkcGVybSApOwoJfSAvLyBjaG1vZCgpCgoJLyoqCgkgKiDjg5Hjg7zjg5/jg4Pjgrfjg6fjg7PjgpLlho3luLDnmoTjgavlpInmm7TjgZnjgovjgIIo5LiL5bGk44Gu44OV44Kh44Kk44Or44KE44OH44Kj44Os44Kv44OI44Oq44KC5YWo44GmKQoJICoKCSAqIGAkcGVybV9maWxlYCDjgaggYCRwZXJtX2RpcmAg44GM55yB55Wl44GV44KM44Gf5aC05ZCI44Gv44CB5Luj44KP44KK44Gr5Yid5pyf5YyW5pmC44Gr55m76Yyy44GV44KM44Gf44OH44OV44Kp44Or44OI44Gu44OR44O844Of44OD44K344On44Oz44GM5LiO44GI44KJ44KM44G+44GZ44CCCgkgKgoJICog56ysMuW8leaVsCBgJHBlcm1fZGlyYCDjgYznnIHnlaXjgZXjgozjgIHmnIDliJ3jga7lvJXmlbAgYCRwZXJtX2ZpbGVgIOOBoOOBkeOBjOS4juOBiOOCieOCjOOBn+WgtOWQiOOBr+OAgSDjg5XjgqHjgqTjg6vjgajjg4fjgqPjg6zjgq/jg4jjg6rjga7kuKHmlrnjgasgYCRwZXJtX2ZpbGVgIOOBjOmBqeeUqOOBleOCjOOBvuOBmeOAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGZpbGVwYXRoIOWvvuixoeOBruODkeOCuQoJICogQHBhcmFtIGludCAkcGVybV9maWxlIOODleOCoeOCpOODq+OBq+S4juOBiOOCi+ODkeODvOODn+ODg+OCt+ODp+ODsyAo55yB55Wl5Y+vKQoJICogQHBhcmFtIGludCAkcGVybV9kaXIg44OH44Kj44Os44Kv44OI44Oq44Gr5LiO44GI44KL44OR44O844Of44OD44K344On44OzICjnnIHnlaXlj68pCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmC44GrIGB0cnVlYOOAgeWkseaVl+aZguOBqyBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gY2htb2RfciggJGZpbGVwYXRoLCAkcGVybV9maWxlID0gbnVsbCwgJHBlcm1fZGlyID0gbnVsbCApewoJCSRmaWxlcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRmaWxlcGF0aCk7CgkJaWYoICFpc19udWxsKCAkcGVybV9maWxlICkgJiYgaXNfbnVsbCgkcGVybV9kaXIpICl7CgkJCS8vIOODkeODvOODn+ODg+OCt+ODp+ODs+ioreWumuWApOOBjDHjgaTjgaDjgZHkuI7jgYjjgonjgozjgZ/loLTlkIjjgavjga/jgIEKCQkJLy8g44OV44Kh44Kk44Or44Gr44KC44OH44Kj44Os44Kv44OI44Oq44Gr44KC6YGp55So44GZ44KL44CCCgkJCSRwZXJtX2RpciA9ICRwZXJtX2ZpbGU7CgkJfQoKCQkkcmVzdWx0ID0gdHJ1ZTsKCgkJaWYoICR0aGlzLT5pc19maWxlKCAkZmlsZXBhdGggKSApewoJCQlpZiggISR0aGlzLT5jaG1vZCggJGZpbGVwYXRoLCAkcGVybV9maWxlICkgKXsKCQkJCSRyZXN1bHQgPSBmYWxzZTsKCQkJfQoJCX1lbHNlaWYoICR0aGlzLT5pc19kaXIoICRmaWxlcGF0aCApICl7CgkJCSRpdGVtbGlzdCA9ICR0aGlzLT5scyggJGZpbGVwYXRoICk7CgkJCWlmKCBpc19hcnJheSgkaXRlbWxpc3QpICl7CgkJCQlmb3JlYWNoKCAkaXRlbWxpc3QgYXMgJExpbmUgKXsKCQkJCQlpZiggJExpbmUgPT0gJy4nIHx8ICRMaW5lID09ICcuLicgKXsgY29udGludWU7IH0KCQkJCQlpZiggJHRoaXMtPmlzX2RpciggJGZpbGVwYXRoLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgKSApewoJCQkJCQlpZiggISR0aGlzLT5jaG1vZCggJGZpbGVwYXRoLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUsICRwZXJtX2RpciApICl7CgkJCQkJCQkkcmVzdWx0ID0gZmFsc2U7CgkJCQkJCX0KCQkJCQkJaWYoICEkdGhpcy0+Y2htb2RfciggJGZpbGVwYXRoLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUsICRwZXJtX2ZpbGUsICRwZXJtX2RpciApICl7CgkJCQkJCQkkcmVzdWx0ID0gZmFsc2U7CgkJCQkJCX0KCQkJCQkJY29udGludWU7CgkJCQkJfWVsc2VpZiggJHRoaXMtPmlzX2ZpbGUoICRmaWxlcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICkgKXsKCQkJCQkJaWYoICEkdGhpcy0+Y2htb2QoICRmaWxlcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lLCAkcGVybV9maWxlICkgKXsKCQkJCQkJCSRyZXN1bHQgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCQljb250aW51ZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiAkcmVzdWx0OwoJfSAvLyBjaG1vZF9yKCkKCgoJLyoqCgkgKiDjg5Hjg7zjg5/jg4Pjgrfjg6fjg7Pmg4XloLHjgpLoqr/jgbnjgIEz5qGB44Gu5pWw5a2X44Gn6L+U44GZ44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkcGF0aCDlr77osaHjga7jg5HjgrkKCSAqIEByZXR1cm4gaW50fGJvb2wg5oiQ5Yqf5pmC44GrIDPmoYHjga7mlbDlrZfjgIHlpLHmlZfmmYLjgasgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9wZXJtaXNzaW9uKCAkcGF0aCApewoJCSRwYXRoID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJHBhdGgpOwoKCQlpZiggIWZpbGVfZXhpc3RzKCAkcGF0aCApICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJHBlcm0gPSBydHJpbSggc3ByaW50ZiggIiVvXG4iICwgZmlsZXBlcm1zKCAkcGF0aCApICkgKTsKCQkkc3RhcnQgPSBzdHJsZW4oICRwZXJtID8/ICcnICkgLSAzOwoJCXJldHVybiBzdWJzdHIoICRwZXJtICwgJHN0YXJ0ICwgMyApOwoJfS8vZ2V0X3Blcm1pc3Npb24oKQoKCgkvKioKCSAqIOODh+OCo+ODrOOCr+ODiOODquOBq+OBguOCi+ODleOCoeOCpOODq+WQjeOBruODquOCueODiOOCkumFjeWIl+OBp+i/lOOBmeOAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg5a++6LGh44OH44Kj44Os44Kv44OI44Oq44Gu44OR44K5CgkgKiBAcmV0dXJuIGFycmF5fGJvb2wg5oiQ5Yqf5pmC44Gr44OV44Kh44Kk44Or44G+44Gf44Gv44OH44Kj44Os44Kv44OI44Oq5ZCN44Gu5LiA6Kan44KS5qC857SN44GX44Gf6YWN5YiX44CB5aSx5pWX5pmC44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBscygkcGF0aCl7CgkJJHBhdGggPSAkdGhpcy0+bG9jYWxpemVfcGF0aCgkcGF0aCk7CgoJCWlmKCAkcGF0aCA9PT0gZmFsc2UgKXsgcmV0dXJuIGZhbHNlOyB9CgkJaWYoICFmaWxlX2V4aXN0cyggJHBhdGggKSApeyByZXR1cm4gZmFsc2U7IH0KCQlpZiggISR0aGlzLT5pc19kaXIoICRwYXRoICkgKXsgcmV0dXJuIGZhbHNlOyB9CgoJCSRSVE4gPSBhcnJheSgpOwoJCSRkciA9IEBvcGVuZGlyKCRwYXRoKTsKCQl3aGlsZSggKCAkZW50ID0gcmVhZGRpciggJGRyICkgKSAhPT0gZmFsc2UgKXsKCQkJLy8gQ3VycmVudERpcuOBqFBhcmVudERpcuOBr+WQq+OCgeOBquOBhAoJCQlpZiggJGVudCA9PSAnLicgfHwgJGVudCA9PSAnLi4nICl7IGNvbnRpbnVlOyB9CgkJCWFycmF5X3B1c2goICRSVE4gLCAkZW50ICk7CgkJfQoJCWNsb3NlZGlyKCRkcik7CgkJaWYoIHN0cmxlbiggJHRoaXMtPmZpbGVzeXN0ZW1fZW5jb2RpbmcgPz8gJycgKSApewoJCQkvL1B4RlcgMC42LjQg6L+95YqgCgkJCSRSVE4gPSBAJHRoaXMtPmNvbnZlcnRfZmlsZXN5c3RlbV9lbmNvZGluZyggJFJUTiApOwoJCX0KCQl1c29ydCgkUlROLCAic3RybmF0Y21wIik7CgkJcmV0dXJuCSRSVE47Cgl9Ly9scygpCgoJLyoqCgkgKiDjg4fjgqPjg6zjgq/jg4jjg6rjga7lhoXpg6jjgpLmr5TovIPjgZfjgIEkY29tcGFyaXNvbuOBq+WQq+OBvuOCjOOBquOBhOimgee0oOOCkiR0YXJnZXTjgYvjgonliYrpmaTjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICR0YXJnZXQg44Kv44Oq44O844OL44Oz44Kw5a++6LGh44Gu44OH44Kj44Os44Kv44OI44Oq44OR44K5CgkgKiBAcGFyYW0gc3RyaW5nICRjb21wYXJpc29uIOavlOi8g+OBmeOCi+ODh+OCo+ODrOOCr+ODiOODquOBruODkeOCuQoJICogQHJldHVybiBib29sIOaIkOWKn+aZgiBgdHJ1ZWDjgIHlpLHmlZfmmYIgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGNvbXBhcmVfYW5kX2NsZWFudXAoICR0YXJnZXQgLCAkY29tcGFyaXNvbiApewoJCWlmKCBpc19udWxsKCAkY29tcGFyaXNvbiApIHx8IGlzX251bGwoICR0YXJnZXQgKSApeyByZXR1cm4gZmFsc2U7IH0KCgkJJHRhcmdldCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCR0YXJnZXQpOwoJCSRjb21wYXJpc29uID0gJHRoaXMtPmxvY2FsaXplX3BhdGgoJGNvbXBhcmlzb24pOwoKCQlpZiggIWZpbGVfZXhpc3RzKCAkY29tcGFyaXNvbiApICYmIGZpbGVfZXhpc3RzKCAkdGFyZ2V0ICkgKXsKCQkJJHRoaXMtPnJtKCAkdGFyZ2V0ICk7CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJaWYoICR0aGlzLT5pc19kaXIoICR0YXJnZXQgKSApewoJCQkkZmxpc3QgPSAkdGhpcy0+bHMoICR0YXJnZXQgKTsKCQl9ZWxzZXsKCQkJcmV0dXJuIHRydWU7CgkJfQoKCQlpZiggaXNfYXJyYXkoJGZsaXN0KSApewoJCQlmb3JlYWNoICggJGZsaXN0IGFzICRMaW5lICl7CgkJCQlpZiggJExpbmUgPT0gJy4nIHx8ICRMaW5lID09ICcuLicgKXsgY29udGludWU7IH0KCQkJCSR0aGlzLT5jb21wYXJlX2FuZF9jbGVhbnVwKCAkdGFyZ2V0LkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgLCAkY29tcGFyaXNvbi5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICk7CgkJCX0KCQl9CgoJCXJldHVybiB0cnVlOwoJfS8vY29tcGFyZV9hbmRfY2xlYW51cCgpCgoJLyoqCgkgKiDjg4fjgqPjg6zjgq/jg4jjg6rjgpLlkIzmnJ/jgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoX3N5bmNfZnJvbSDlkIzmnJ/lhYPjg4fjgqPjg6zjgq/jg4jjg6oKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGhfc3luY190byDlkIzmnJ/lhYjjg4fjgqPjg6zjgq/jg4jjg6oKCSAqIEByZXR1cm4gYm9vbCDluLjjgasgYHRydWVgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gc3luY19kaXIoICRwYXRoX3N5bmNfZnJvbSAsICRwYXRoX3N5bmNfdG8gKXsKCQkkdGhpcy0+Y29weV9yKCAkcGF0aF9zeW5jX2Zyb20gLCAkcGF0aF9zeW5jX3RvICk7CgkJJHRoaXMtPmNvbXBhcmVfYW5kX2NsZWFudXAoICRwYXRoX3N5bmNfdG8gLCAkcGF0aF9zeW5jX2Zyb20gKTsKCQlyZXR1cm4gdHJ1ZTsKCX0vL3N5bmNfZGlyKCkKCgkvKioKCSAqIOaMh+WumuOBleOCjOOBn+ODh+OCo+ODrOOCr+ODiOODquS7peS4i+OBruOAgeWFqOOBpuOBruepuuOBo+OBveOBruODh+OCo+ODrOOCr+ODiOODquOCkuWJiumZpOOBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg44OH44Kj44Os44Kv44OI44Oq44OR44K5CgkgKiBAcGFyYW0gYXJyYXkgJG9wdGlvbnMg44Kq44OX44K344On44OzCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmCIGB0cnVlYOOAgeWkseaVl+aZgiBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gcmVtb3ZlX2VtcHR5X2RpciggJHBhdGggLCAkb3B0aW9ucyA9IGFycmF5KCkgKXsKCQkkcGF0aCA9ICR0aGlzLT5sb2NhbGl6ZV9wYXRoKCRwYXRoKTsKCgkJaWYoICEkdGhpcy0+aXNfd3JpdGFibGUoICRwYXRoICkgKXsgcmV0dXJuIGZhbHNlOyB9CgkJaWYoICEkdGhpcy0+aXNfZGlyKCAkcGF0aCApICl7IHJldHVybiBmYWxzZTsgfQoJCWlmKCAkdGhpcy0+aXNfZmlsZSggJHBhdGggKSB8fCAkdGhpcy0+aXNfbGluayggJHBhdGggKSApeyByZXR1cm4gZmFsc2U7IH0KCQkkcGF0aCA9IEByZWFscGF0aCggJHBhdGggKTsKCQlpZiggJHBhdGggPT09IGZhbHNlICl7IHJldHVybiBmYWxzZTsgfQoKCQkvLyBOb3JtYWxpemUgJG9wdGlvbnMKCQlpZiggIWlzX2FycmF5KCRvcHRpb25zKSApewoJCQkkb3B0aW9ucyA9IGFycmF5KCk7CgkJfQoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cyggJ2RlcHRoJywgJG9wdGlvbnMgKSApewoJCQkkb3B0aW9uc1snZGVwdGgnXSA9IG51bGw7CgkJfQoKCQkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCS8vIOasoeOBrumajuWxpOOCkuWHpueQhuOBmeOCi+OBi+OBqeOBhuOBi+OBruOCueOCpOODg+ODgQoJCSRzd2l0Y2hfZG9uZXh0ID0gZmFsc2U7CgkJaWYoIGlzX251bGwoICRvcHRpb25zWydkZXB0aCddICkgKXsKCQkJLy8g5rex44GV44Gu5oyH5a6a44GM44Gq44GR44KM44Gw5o6Y44KLCgkJCSRzd2l0Y2hfZG9uZXh0ID0gdHJ1ZTsKCQl9ZWxzZWlmKCAhaXNfaW50KCAkb3B0aW9uc1snZGVwdGgnXSApICl7CgkJCS8vIOaMh+WumuOBjG51bGzjgafjgoLmlbDlgKTjgafjgoLjgarjgZHjgozjgbDmjpjjgonjgarjgYQKCQkJJHN3aXRjaF9kb25leHQgPSBmYWxzZTsKCQl9ZWxzZWlmKCAkb3B0aW9uc1snZGVwdGgnXSA8PSAwICl7CgkJCS8vIOaMh+WumuOBjOOCvOODreS7peS4i+OBquOCieOAgeS7iuWbnuOBruWHpueQhuOCkuOBl+OBpue1guS6hgoJCQkkc3dpdGNoX2RvbmV4dCA9IGZhbHNlOwoJCX1lbHNlaWYoICRvcHRpb25zWydkZXB0aCddID4gMCApewoJCQkvLyDmjIflrprjgYzmraPjga7mlbAo44K844Ot44Gv5ZCr44G+44Gq44GEKeOBquOCieOAgeaOmOOCiwoJCQkkb3B0aW9uc1snZGVwdGgnXSAtLTsKCQkJJHN3aXRjaF9kb25leHQgPSB0cnVlOwoJCX1lbHNlewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCS8vIC8g5qyh44Gu6ZqO5bGk44KS5Yem55CG44GZ44KL44GL44Gp44GG44GL44Gu44K544Kk44OD44OBCgkJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkJJGZsaXN0ID0gJHRoaXMtPmxzKCAkcGF0aCApOwoJCWlmKCAhY291bnQoICRmbGlzdCApICl7CgkJCS8vIOmWi+OBhOOBn+ODh+OCo+ODrOOCr+ODiOODquOBruS4rei6q+OBjAoJCQkvLyAiLiIg44GoICIuLiIg44Gu44G/44Gg44Gj44Gf5aC05ZCICgkJCS8vIOWJiumZpOOBl+OBpue1guS6hgoJCQkkcmVzdWx0ID0gQHJtZGlyKCAkcGF0aCApOwoJCQlyZXR1cm4JJHJlc3VsdDsKCQl9CgkJJGFsaXZlID0gZmFsc2U7CgkJZm9yZWFjaCAoICRmbGlzdCBhcyAkTGluZSApewoJCQlpZiggJExpbmUgPT0gJy4nIHx8ICRMaW5lID09ICcuLicgKXsgY29udGludWU7IH0KCQkJaWYoICR0aGlzLT5pc19saW5rKCAkcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICkgKXsKCQkJCS8vIOOCt+ODs+ODnOODquODg+OCr+ODquODs+OCr+OBr+eEoeimluOBmeOCi+OAggoJCQl9ZWxzZWlmKCAkdGhpcy0+aXNfZGlyKCAkcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICkgKXsKCQkJCWlmKCAkc3dpdGNoX2RvbmV4dCApewoJCQkJCS8vIOOBleOCieOBq+aOmOOCjOOBqOaMh+S7pOOBjOOBguOCjOOBsOOAgeaOmOOCi+OAggoJCQkJCSR0aGlzLT5yZW1vdmVfZW1wdHlfZGlyKCAkcGF0aC5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICwgJG9wdGlvbnMgKTsKCQkJCX0KCQkJfQoJCQlpZiggZmlsZV9leGlzdHMoICRwYXRoLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgKSApewoJCQkJJGFsaXZlID0gdHJ1ZTsKCQkJfQoJCX0KCQlpZiggISRhbGl2ZSApewoJCQkkcmVzdWx0ID0gQHJtZGlyKCAkcGF0aCApOwoJCQlyZXR1cm4JJHJlc3VsdDsKCQl9CgkJcmV0dXJuIHRydWU7Cgl9Ly9yZW1vdmVfZW1wdHlfZGlyKCkKCgoJLyoqCgkgKiDmjIflrprjgZXjgozjgZ8y44Gk44Gu44OH44Kj44Os44Kv44OI44Oq44Gu5YaF5a6544KS5q+U6LyD44GX44CB44G+44Gj44Gf44GP5ZCM44GY44GL44Gp44GG44GL6Kq/44G544KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAkZGlyX2Eg5q+U6LyD5a++6LGh44OH44Kj44Os44Kv44OI44OqQQoJICogQHBhcmFtIHN0cmluZyAkZGlyX2Ig5q+U6LyD5a++6LGh44OH44Kj44Os44Kv44OI44OqQgoJICogQHBhcmFtIGFycmF5ICRvcHRpb25zIOOCquODl+OCt+ODp+ODswoJICogPGRsPgoJICogICA8ZHQ+Ym9vbCAkb3B0aW9uc1snY29tcGFyZV9maWxlY29udGVudCddPC9kdD4KCSAqIAkgICA8ZGQ+44OV44Kh44Kk44Or44Gu5Lit6Lqr44KC5q+U6LyD44GZ44KL44GL77yfPC9kZD4KCSAqICAgPGR0PmJvb2wgJG9wdGlvbnNbJ2NvbXBhcmVfZW1wdHlkaXInXTwvZHQ+CgkgKiAJICAgPGRkPuepuuOBo+OBveOBruODh+OCo+ODrOOCr+ODiOODquOBruacieeEoeOCguipleS+oeOBq+WQq+OCgeOCi+OBi++8nzwvZGQ+CgkgKiA8L2RsPgoJICogQHJldHVybiBib29sIOWQjOOBmOWgtOWQiOOBqyBgdHJ1ZWDjgIHnlbDjgarjgovloLTlkIjjgasgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGNvbXBhcmVfZGlyKCAkZGlyX2EgLCAkZGlyX2IgLCAkb3B0aW9ucyA9IGFycmF5KCkgKXsKCgkJaWYoIHN0cmxlbiggJHRoaXMtPmZpbGVzeXN0ZW1fZW5jb2RpbmcgPz8gJycgKSApewoJCQkvL1B4RlcgMC42LjQg6L+95YqgCgkJCSRkaXJfYSA9IEAkdGhpcy0+Y29udmVydF9maWxlc3lzdGVtX2VuY29kaW5nKCAkZGlyX2EgKTsKCQkJJGRpcl9iID0gQCR0aGlzLT5jb252ZXJ0X2ZpbGVzeXN0ZW1fZW5jb2RpbmcoICRkaXJfYiApOwoJCX0KCgkJaWYoICggJHRoaXMtPmlzX2ZpbGUoICRkaXJfYSApICYmICEkdGhpcy0+aXNfZmlsZSggJGRpcl9iICkgKSB8fCAoICEkdGhpcy0+aXNfZmlsZSggJGRpcl9hICkgJiYgJHRoaXMtPmlzX2ZpbGUoICRkaXJfYiApICkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlpZiggKCAoICR0aGlzLT5pc19kaXIoICRkaXJfYSApICYmICEkdGhpcy0+aXNfZGlyKCAkZGlyX2IgKSApIHx8ICggISR0aGlzLT5pc19kaXIoICRkaXJfYSApICYmICR0aGlzLT5pc19kaXIoICRkaXJfYiApICkgKSAmJiAkb3B0aW9uc1snY29tcGFyZV9lbXB0eWRpciddICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCS8vIE5vcm1hbGl6ZSAkb3B0aW9ucwoJCWlmKCAhaXNfYXJyYXkoJG9wdGlvbnMpICl7CgkJCSRvcHRpb25zID0gYXJyYXkoKTsKCQl9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnY29tcGFyZV9maWxlY29udGVudCcsICRvcHRpb25zICkgKXsKCQkJJG9wdGlvbnNbJ2NvbXBhcmVfZmlsZWNvbnRlbnQnXSA9IG51bGw7CgkJfQoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cyggJ2NvbXBhcmVfZW1wdHlkaXInLCAkb3B0aW9ucyApICl7CgkJCSRvcHRpb25zWydjb21wYXJlX2VtcHR5ZGlyJ10gPSBudWxsOwoJCX0KCgkJaWYoICR0aGlzLT5pc19maWxlKCAkZGlyX2EgKSAmJiAkdGhpcy0+aXNfZmlsZSggJGRpcl9iICkgKXsKCQkJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkJLy8g5Lih5pa544OV44Kh44Kk44Or44Gg44Gj44Gf44KJCgkJCWlmKCAkb3B0aW9uc1snY29tcGFyZV9maWxlY29udGVudCddICl7CgkJCQkvLyDjg5XjgqHjgqTjg6vjga7lhoXlrrnjgoLmr5TovIPjgZnjgovoqK3lrprjga7loLTlkIjjgIEKCQkJCS8vIOOBneOCjOOBnuOCjOODleOCoeOCpOODq+OCkumWi+OBhOOBpuWQjOOBmOOBi+OBqeOBhuOBi+OCkuavlOi8gwoJCQkJJGZpbGVjb250ZW50X2EgPSAkdGhpcy0+cmVhZF9maWxlKCAkZGlyX2EgKTsKCQkJCSRmaWxlY29udGVudF9iID0gJHRoaXMtPnJlYWRfZmlsZSggJGRpcl9iICk7CgkJCQlpZiggJGZpbGVjb250ZW50X2EgIT09ICRmaWxlY29udGVudF9iICl7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJaWYoICR0aGlzLT5pc19kaXIoICRkaXJfYSApIHx8ICR0aGlzLT5pc19kaXIoICRkaXJfYiApICl7CgkJCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJCS8vIOS4oeaWueODh+OCo+ODrOOCr+ODiOODquOBoOOBo+OBn+OCiQoJCQkkY29udGxpc3RfYSA9ICR0aGlzLT5scyggJGRpcl9hICk7CgkJCSRjb250bGlzdF9iID0gJHRoaXMtPmxzKCAkZGlyX2IgKTsKCgkJCWlmKCAkb3B0aW9uc1snY29tcGFyZV9lbXB0eWRpciddICYmICRjb250bGlzdF9hICE9PSAkY29udGxpc3RfYiApewoJCQkJLy8g56m644Gj44G944Gu44OH44Kj44Os44Kv44OI44Oq44KC5Y6z5a+G44Gr6KmV5L6h44GZ44KL6Kit5a6a44Gn44CBCgkJCQkvLyDjg4fjgqPjg6zjgq/jg4jjg6rlhoXjga7opoHntKDphY3liJfjga7lhoXlrrnjgYznlbDjgarjgozjgbDjgIFmYWxzZeOAggoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgoJCQkkZG9uZSA9IGFycmF5KCk7CgkJCWZvcmVhY2goICRjb250bGlzdF9hIGFzICRMaW5lICl7CgkJCQkvLyBB44KS44OB44Kn44OD44KvCgkJCQlpZiggJExpbmUgPT0gJy4uJyB8fCAkTGluZSA9PSAnLicgKXsgY29udGludWU7IH0KCQkJCWlmKCAhJHRoaXMtPmNvbXBhcmVfZGlyKCAkZGlyX2EuRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSAsICRkaXJfYi5ESVJFQ1RPUllfU0VQQVJBVE9SLiRMaW5lICwgJG9wdGlvbnMgKSApewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJCSRkb25lWyRMaW5lXSA9IHRydWU7CgkJCX0KCgkJCWZvcmVhY2goICRjb250bGlzdF9iIGFzICRMaW5lICl7CgkJCQkvLyBB44Gr5ZCr44G+44KM44Gq44GL44Gj44GfQuOCkuODgeOCp+ODg+OCrwoJCQkJaWYoICRkb25lWyRMaW5lXSApeyBjb250aW51ZTsgfQoJCQkJaWYoICRMaW5lID09ICcuLicgfHwgJExpbmUgPT0gJy4nICl7IGNvbnRpbnVlOyB9CgkJCQlpZiggISR0aGlzLT5jb21wYXJlX2RpciggJGRpcl9hLkRJUkVDVE9SWV9TRVBBUkFUT1IuJExpbmUgLCAkZGlyX2IuRElSRUNUT1JZX1NFUEFSQVRPUi4kTGluZSAsICRvcHRpb25zICkgKXsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQkkZG9uZVskTGluZV0gPSB0cnVlOwoJCQl9CgoJCX0KCgkJcmV0dXJuIHRydWU7Cgl9Ly9jb21wYXJlX2RpcigpCgoKCS8qKgoJICog44K144O844OQ44GMVU5JWOODkeOCueOBi+iqv+OBueOCi+OAggoJICoKCSAqIEByZXR1cm4gYm9vbCBVTklY44OR44K544Gq44KJIGB0cnVlYOOAgeOBneOCjOS7peWkluOBquOCiSBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gaXNfdW5peCgpewoJCWlmKCBESVJFQ1RPUllfU0VQQVJBVE9SID09ICcvJyApewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfS8vaXNfdW5peCgpCgoJLyoqCgkgKiDjgrXjg7zjg5DjgYxXaW5kb3dz44OR44K544GL6Kq/44G544KL44CCCgkgKgoJICogQHJldHVybiBib29sIFdpbmRvd3Pjg5HjgrnjgarjgokgYHRydWVg44CB44Gd44KM5Lul5aSW44Gq44KJIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBpc193aW5kb3dzKCl7CgkJaWYoIERJUkVDVE9SWV9TRVBBUkFUT1IgPT0gJ1xcJyApewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfS8vaXNfd2luZG93cygpCgoKCS8qKgoJICog44OR44K544KS5q2j6KaP5YyW44GZ44KL44CCCgkgKgoJICog5Y+X44GR5Y+W44Gj44Gf44OR44K544KS44CB44K544Op44OD44K344Ol5Yy65YiH44KK44Gu6KGo54++44Gr5q2j6KaP5YyW44GX44G+44GZ44CCCgkgKiBXaW5kb3dz44Gu44Oc44Oq44Ol44O844Og44Op44OZ44Or44GM5LuY44GE44Gm44GE44KL5aC05ZCI44Gv5YmK6Zmk44GX44G+44GZ44CCCgkgKiBVUknjgrnjgq3jg7zjg6AoaHR0cCwgaHR0cHMsIGZ0cCDjgarjgakpIOOBp+Wni+OBvuOCi+WgtOWQiOOAgTLjgaTjga7jgrnjg6njg4Pjgrfjg6Xjgaflp4vjgb7jgovloLTlkIgoYC8vd3d3LmV4YW1wbGUuY29tL2FiYy9gIOOBquOBqSnjgIHjgZPjgozjgpLmrovjgZfjgabmraPopo/ljJbjgZfjgb7jgZnjgIIKCSAqCgkgKiAgLSDkvovvvJogYFxhXGJcYy5odG1sYCDihpIgYC9hL2IvYy5odG1sYCDjg5Djg4Pjgq/jgrnjg6njg4Pjgrfjg6Xjga/jgrnjg6njg4Pjgrfjg6Xjgavnva7jgY3mj5vjgYjjgonjgozjgb7jgZnjgIIKCSAqICAtIOS+i++8miBgL2EvYi8vLy9jLmh0bWxgIOKGkiBgL2EvYi9jLmh0bWxgIOS9meioiOOBquOCueODqeODg+OCt+ODpeOBr+OBvuOBqOOCgeOCieOCjOOBvuOBmeOAggoJICogIC0g5L6L77yaIGBDOlxhXGJcYy5odG1sYCDihpIgYC9hL2IvYy5odG1sYCDjg5zjg6rjg6Xjg7zjg6Djg6njg5njg6vjga/liYrpmaTjgZXjgozjgb7jgZnjgIIKCSAqICAtIOS+i++8miBgaHR0cDovL2EvYi9jLmh0bWxgIOKGkiBgaHR0cDovL2EvYi9jLmh0bWxgIFVSSeOCueOCreODvOODoOOBr+aui+OBleOCjOOBvuOBmeOAggoJICogIC0g5L6L77yaIGAvL2EvYi9jLmh0bWxgIOKGkiBgLy9hL2IvYy5odG1sYCDjg4njg6HjgqTjg7PlkI3jga/mrovjgZXjgozjgb7jgZnjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRwYXRoIOato+imj+WMluOBmeOCi+ODkeOCuQoJICogQHJldHVybiBzdHJpbmcg5q2j6KaP5YyW44GV44KM44Gf44OR44K5CgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBub3JtYWxpemVfcGF0aCgkcGF0aCl7CgkJJHBhdGggPSB0cmltKCRwYXRoKTsKCQkkcGF0aCA9ICR0aGlzLT5jb252ZXJ0X2VuY29kaW5nKCAkcGF0aCApOy8v5paH5a2X44Kz44O844OJ44KS5o+D44GI44KLCgkJJHBhdGggPSBwcmVnX3JlcGxhY2UoICcvXFwvfFxcXFwvcycsICcvJywgJHBhdGggKTsvL+ODkOODg+OCr+OCueODqeODg+OCt+ODpeOCkuOCueODqeODg+OCt+ODpeOBq+e9ruOBjeaPm+OBiOOCi+OAggoJCSRwYXRoID0gcHJlZ19yZXBsYWNlKCAnL15bQS1aXVxcOlxcLy9zJywgJy8nLCAkcGF0aCApOy8vV2luZG93c+OBruODnOODquODpeODvOODoOODqeODmeODq+OCkuWJiumZpAoJCSRwcmVmaXggPSAnJzsKCQlpZiggcHJlZ19tYXRjaCggJy9eKCg/OlthLXpBLVowLTldK1xcOik/XFwvKShcXC8uKikkLycsICRwYXRoLCAkbWF0Y2hlZCApICl7CgkJCSRwcmVmaXggPSAkbWF0Y2hlZFsxXTsKCQkJJHBhdGggPSAkbWF0Y2hlZFsyXTsKCQl9CgkJJHBhdGggPSBwcmVnX3JlcGxhY2UoICcvXFwvKy9zJywgJy8nLCAkcGF0aCApOy8v6YeN6KSH44GZ44KL44K544Op44OD44K344Ol44KSMeOBpOOBq+OBvuOBqOOCgeOCiwoJCXJldHVybiAkcHJlZml4LiRwYXRoOwoJfQoKCgkvKioKCSAqIOODkeOCueOCkk9T44Gu5qiZ5rqW55qE44Gq6KGo54++44Gr5aSJ5o+b44GZ44KL44CCCgkgKgoJICog5Y+X44GR5Y+W44Gj44Gf44OR44K544KS44CBT1Pjga7mqJnmupbnmoTjgarooajnj77jgavlpInmj5vjgZfjgb7jgZnjgIIKCSAqIC0g44K544Op44OD44K344Ol44Go44OQ44OD44Kv44K544Op44OD44K344Ol44Gu6YGV44GE44KS5ZC45Y+O44GX44CBYERJUkVDVE9SWV9TRVBBUkFUT1JgIOOBq+e9ruOBjeaPm+OBiOOBvuOBmeOAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg44Ot44O844Kr44Op44Kk44K644GZ44KL44OR44K5CgkgKiBAcmV0dXJuIHN0cmluZyDjg63jg7zjgqvjg6njgqTjgrrjgZXjgozjgZ/jg5HjgrkKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGxvY2FsaXplX3BhdGgoJHBhdGgpewoJCSRwYXRoID0gJHRoaXMtPmNvbnZlcnRfZmlsZXN5c3RlbV9lbmNvZGluZyggJHBhdGggKTsvL+aWh+Wtl+OCs+ODvOODieOCkuaPg+OBiOOCiwoJCSRwYXRoID0gcHJlZ19yZXBsYWNlKCAnL1xcL3xcXFxcL3MnLCAnLycsICRwYXRoICk7Ly/kuIDml6bjgrnjg6njg4Pjgrfjg6Xjgavnva7jgY3mj5vjgYjjgovjgIIKCQlpZiggJHRoaXMtPmlzX3VuaXgoKSApewoJCQkvLyBXaW5kb3dz5Lul5aSW44Gg44Gj44Gf5aC05ZCI44Gr44CB44Oc44Oq44Ol44O844Og44Op44OZ44Or44KS5Y+X44GR5Y+W44Gj44Gf44KJ5YmK6Zmk44GZ44KLCgkJCSRwYXRoID0gcHJlZ19yZXBsYWNlKCAnL15bQS1aXVxcOlxcLy9zJywgJy8nLCAkcGF0aCApOy8vV2luZG93c+OBruODnOODquODpeODvOODoOODqeODmeODq+OCkuWJiumZpAoJCX0KCQkkcGF0aCA9IHByZWdfcmVwbGFjZSggJy9cXC8rL3MnLCAnLycsICRwYXRoICk7Ly/ph43opIfjgZnjgovjgrnjg6njg4Pjgrfjg6XjgpIx44Gk44Gr44G+44Go44KB44KLCgkJJHBhdGggPSBwcmVnX3JlcGxhY2UoICcvXFwvfFxcXFwvcycsIERJUkVDVE9SWV9TRVBBUkFUT1IsICRwYXRoICk7CgkJcmV0dXJuICRwYXRoOwoJfQoKCgoJLyoqCgkgKiDlj5fjgZHlj5bjgaPjgZ/jg4bjgq3jgrnjg4jjgpLjgIHjg5XjgqHjgqTjg6vjgrfjgrnjg4bjg6Djgqjjg7PjgrPjg7zjg4njgavlpInmj5vjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gbWl4ZWQgJHRleHQg44OG44Kt44K544OICgkgKiBAcmV0dXJuIHN0cmluZyDmloflrZfjgrvjg4Pjg4jlpInmj5vlvozjga7jg4bjgq3jgrnjg4gKCSAqLwoJcHJpdmF0ZSBmdW5jdGlvbiBjb252ZXJ0X2ZpbGVzeXN0ZW1fZW5jb2RpbmcoICR0ZXh0ICl7CgkJJFJUTiA9ICR0ZXh0OwoJCWlmKCAhaXNfY2FsbGFibGUoICdtYl9pbnRlcm5hbF9lbmNvZGluZycgKSApewoJCQlyZXR1cm4gJHRleHQ7CgkJfQoJCWlmKCAhc3RybGVuKCAkdGhpcy0+ZmlsZXN5c3RlbV9lbmNvZGluZyA/PyAnJyApICl7CgkJCXJldHVybiAkdGV4dDsKCQl9CgoJCSR0b19lbmNvZGluZyA9ICR0aGlzLT5maWxlc3lzdGVtX2VuY29kaW5nOwoJCSRmcm9tX2VuY29kaW5nID0gbWJfaW50ZXJuYWxfZW5jb2RpbmcoKS4nLFVURi04LFNKSVMtd2luLGV1Y0pQLXdpbixTSklTLEVVQy1KUCxKSVMsQVNDSUknOwoKCQlyZXR1cm4gJHRoaXMtPmNvbnZlcnRfZW5jb2RpbmcoICR0ZXh0LCAkdG9fZW5jb2RpbmcsICRmcm9tX2VuY29kaW5nICk7CgoJfS8vY29udmVydF9maWxlc3lzdGVtX2VuY29kaW5nKCkKCgkvKioKCSAqIOWPl+OBkeWPluOBo+OBn+ODhuOCreOCueODiOOCkuOAgeODleOCoeOCpOODq+OCt+OCueODhuODoOOCqOODs+OCs+ODvOODieOBq+WkieaPm+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBtaXhlZCAkdGV4dCDjg4bjgq3jgrnjg4gKCSAqIEBwYXJhbSBzdHJpbmcgJHRvX2VuY29kaW5nIOaWh+Wtl+OCu+ODg+ODiCjnnIHnlaXmmYLjgIHlhoXpg6jmloflrZfjgrvjg4Pjg4gpCgkgKiBAcGFyYW0gc3RyaW5nICRmcm9tX2VuY29kaW5nIOWkieaPm+WJjeOBruaWh+Wtl+OCu+ODg+ODiAoJICogQHJldHVybiBzdHJpbmcg5paH5a2X44K744OD44OI5aSJ5o+b5b6M44Gu44OG44Kt44K544OICgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBjb252ZXJ0X2VuY29kaW5nKCAkdGV4dCwgJHRvX2VuY29kaW5nID0gbnVsbCwgJGZyb21fZW5jb2RpbmcgPSBudWxsICl7CgkJJFJUTiA9ICR0ZXh0OwoJCWlmKCAhaXNfY2FsbGFibGUoICdtYl9pbnRlcm5hbF9lbmNvZGluZycgKSApewoJCQlyZXR1cm4gJHRleHQ7CgkJfQoKCQkkdG9fZW5jb2RpbmdfZmluID0gJHRvX2VuY29kaW5nOwoJCWlmKCAhc3RybGVuKCR0b19lbmNvZGluZ19maW4gPz8gJycpICl7CgkJCSR0b19lbmNvZGluZ19maW4gPSBtYl9pbnRlcm5hbF9lbmNvZGluZygpOwoJCX0KCQlpZiggIXN0cmxlbigkdG9fZW5jb2RpbmdfZmluID8/ICcnKSApewoJCQkkdG9fZW5jb2RpbmdfZmluID0gJ1VURi04JzsKCQl9CgoJCSRmcm9tX2VuY29kaW5nX2ZpbiA9IChzdHJsZW4oJGZyb21fZW5jb2RpbmcgPz8gJycpID8gJGZyb21fZW5jb2RpbmcuJywnIDogJycpLm1iX2ludGVybmFsX2VuY29kaW5nKCkuJyxVVEYtOCxTSklTLXdpbixldWNKUC13aW4sU0pJUyxFVUMtSlAsSklTLEFTQ0lJJzsKCgkJLy8gLS0tCgkJaWYoIGlzX2FycmF5KCAkdGV4dCApICl7CgkJCSRSVE4gPSBhcnJheSgpOwoJCQlpZiggIWNvdW50KCAkdGV4dCApICl7CgkJCQlyZXR1cm4gJHRleHQ7CgkJCX0KCQkJZm9yZWFjaCggJHRleHQgYXMgJGtleT0+JHJvdyApewoJCQkJJFJUTlska2V5XSA9ICR0aGlzLT5jb252ZXJ0X2VuY29kaW5nKCAkcm93LCAkdG9fZW5jb2RpbmcsICRmcm9tX2VuY29kaW5nICk7CgkJCX0KCQl9ZWxzZXsKCQkJaWYoICFzdHJsZW4oICR0ZXh0ID8/ICcnICkgKXsKCQkJCXJldHVybiAkdGV4dDsKCQkJfQoJCQkkUlROID0gbWJfY29udmVydF9lbmNvZGluZyggJHRleHQsICR0b19lbmNvZGluZ19maW4sICRmcm9tX2VuY29kaW5nX2ZpbiApOwoJCX0KCQlyZXR1cm4gJFJUTjsKCX0vL2NvbnZlcnRfZW5jb2RpbmcoKQoKCS8qKgoJICog5Y+X44GR5Y+W44Gj44Gf44OG44Kt44K544OI44KS44CB5oyH5a6a44Gu5pS56KGM44Kz44O844OJ44Gr5aSJ5o+b44GZ44KL44CCCgkgKgoJICogQHBhcmFtIG1peGVkICR0ZXh0IOODhuOCreOCueODiAoJICogQHBhcmFtIHN0cmluZyAkY3JsZiDmlLnooYzjgrPjg7zjg4nlkI3jgIJDUnxMRihkZWZhdWx0KXxDUkxGCgkgKiBAcmV0dXJuIHN0cmluZyDmlLnooYzjgrPjg7zjg4nlpInmj5vlvozjga7jg4bjgq3jgrnjg4gKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGNvbnZlcnRfY3JsZiggJHRleHQsICRjcmxmID0gbnVsbCApewoJCWlmKCAhc3RybGVuKCRjcmxmID8/ICcnKSApewoJCQkkY3JsZiA9ICdMRic7CgkJfQoJCSRjcmxmX2NvZGUgPSAiXG4iOwoJCXN3aXRjaChzdHJ0b3VwcGVyKCRjcmxmKSl7CgkJCWNhc2UgJ0NSJzoKCQkJCSRjcmxmX2NvZGUgPSAiXHIiOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ0NSTEYnOgoJCQkJJGNybGZfY29kZSA9ICJcclxuIjsKCQkJCWJyZWFrOwoJCQljYXNlICdMRic6CgkJCWRlZmF1bHQ6CgkJCQkkY3JsZl9jb2RlID0gIlxuIjsKCQkJCWJyZWFrOwoJCX0KCQkkUlROID0gJHRleHQ7CgkJaWYoIGlzX2FycmF5KCAkdGV4dCApICl7CgkJCSRSVE4gPSBhcnJheSgpOwoJCQlpZiggIWNvdW50KCAkdGV4dCApICl7CgkJCQlyZXR1cm4gJHRleHQ7CgkJCX0KCQkJZm9yZWFjaCggJHRleHQgYXMgJGtleT0+JHZhbCApewoJCQkJJFJUTlska2V5XSA9ICR0aGlzLT5jb252ZXJ0X2NybGYoICR2YWwgLCAkY3JsZiApOwoJCQl9CgkJfWVsc2V7CgkJCWlmKCAhc3RybGVuKCAkdGV4dCA/PyAnJyApICl7CgkJCQlyZXR1cm4gJHRleHQ7CgkJCX0KCQkJJFJUTiA9IHByZWdfcmVwbGFjZSggJy9cclxufFxyfFxuLycsICRjcmxmX2NvZGUsICR0ZXh0ICk7CgkJfQoJCXJldHVybiAkUlROOwoJfQoKfQo/Pg==',
           "request" => 'PD9waHAKLyoqCiAqIHRvbWs3OS9yZXF1ZXN0CiAqCiAqIEBhdXRob3IgVG9tb3lhIEtveWFuYWdpIDx0b21rNzlAZ21haWwuY29tPgogKi8KCm5hbWVzcGFjZSByZW5jb25GcmFtZXdvcms7CgovKioKICogdG9tazc5L3JlcXVlc3QgY29yZSBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIHJlcXVlc3R7CgkvKioKCSAqIOioreWumuOCquODluOCuOOCp+OCr+ODiAoJICovCglwcml2YXRlICRjb25mOwoJLyoqCgkgKiDjg5XjgqHjgqTjg6vjgrfjgrnjg4bjg6Djgqrjg5bjgrjjgqfjgq/jg4gKCSAqLwoJcHJpdmF0ZSAkZnM7CgkvKioKCSAqIFVSTOODkeODqeODoeODvOOCvwoJICovCglwcml2YXRlICRwYXJhbSA9IGFycmF5KCk7CgkvKioKCSAqIOOCs+ODnuODs+ODieOBi+OCieOBruOCouOCr+OCu+OCuSDjg5Xjg6njgrAKCSAqLwoJcHJpdmF0ZSAkZmxnX2NtZCA9IGZhbHNlOwoJLyoqCgkgKiDjg6rjgq/jgqjjgrnjg4jjg5XjgqHjgqTjg6vjg5HjgrkKCSAqLwoJcHJpdmF0ZSAkcmVxdWVzdF9maWxlX3BhdGg7CgkvKioKCSAqIOWEquWFiOODh+OCo+ODrOOCr+ODiOODquOCpOODs+ODh+ODg+OCr+OCuQoJICovCglwcml2YXRlICRkaXJlY3RvcnlfaW5kZXhfcHJpbWFyeTsKCS8qKgoJICog44Kz44Oe44Oz44OJ44Op44Kk44Oz44Kq44OX44K344On44OzCgkgKi8KCXByaXZhdGUgJGNsaV9vcHRpb25zOwoJLyoqCgkgKiDjgrPjg57jg7Pjg4njg6njgqTjg7Pjg5Hjg6njg6Hjg7zjgr8KCSAqLwoJcHJpdmF0ZSAkY2xpX3BhcmFtczsKCgkvKioKCSAqIOOCs+ODs+OCueODiOODqeOCr+OCvwoJICoKCSAqIEBwYXJhbSBvYmplY3QgJGNvbmYg6Kit5a6a44Kq44OW44K444Kn44Kv44OICgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uZj1udWxsKXsKCQkkdGhpcy0+Y29uZiA9ICRjb25mOwoJCWlmKCAhaXNfb2JqZWN0KCR0aGlzLT5jb25mKSApewoJCQkkdGhpcy0+Y29uZiA9IGpzb25fZGVjb2RlKCd7fScpOwoJCX0KCQkkdGhpcy0+ZnMgPSBuZXcgZmlsZXN5c3RlbSgpOwoKCQlpZighcHJvcGVydHlfZXhpc3RzKCR0aGlzLT5jb25mLCAnZ2V0JykgfHwgIUBpc19hcnJheSgkdGhpcy0+Y29uZi0+Z2V0KSl7CgkJCSR0aGlzLT5jb25mLT5nZXQgPSAkX0dFVDsKCQl9CgkJaWYoIXByb3BlcnR5X2V4aXN0cygkdGhpcy0+Y29uZiwgJ3Bvc3QnKSB8fCAhQGlzX2FycmF5KCR0aGlzLT5jb25mLT5wb3N0KSl7CgkJCSR0aGlzLT5jb25mLT5wb3N0ID0gJF9QT1NUOwoJCX0KCQlpZighcHJvcGVydHlfZXhpc3RzKCR0aGlzLT5jb25mLCAnZmlsZXMnKSB8fCAhQGlzX2FycmF5KCR0aGlzLT5jb25mLT5maWxlcykpewoJCQkkdGhpcy0+Y29uZi0+ZmlsZXMgPSAkX0ZJTEVTOwoJCX0KCQlpZighcHJvcGVydHlfZXhpc3RzKCR0aGlzLT5jb25mLCAnc2VydmVyJykgfHwgIUBpc19hcnJheSgkdGhpcy0+Y29uZi0+c2VydmVyKSl7CgkJCSR0aGlzLT5jb25mLT5zZXJ2ZXIgPSAkX1NFUlZFUjsKCQl9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnUEFUSF9JTkZPJyAsICR0aGlzLT5jb25mLT5zZXJ2ZXIgKSApewoJCQkkdGhpcy0+Y29uZi0+c2VydmVyWydQQVRIX0lORk8nXSA9IG51bGw7CgkJfQoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cyggJ0hUVFBfVVNFUl9BR0VOVCcgLCAkdGhpcy0+Y29uZi0+c2VydmVyICkgKXsKCQkJJHRoaXMtPmNvbmYtPnNlcnZlclsnSFRUUF9VU0VSX0FHRU5UJ10gPSBudWxsOwoJCX0KCQlpZiggIWFycmF5X2tleV9leGlzdHMoICdhcmd2JyAsICR0aGlzLT5jb25mLT5zZXJ2ZXIgKSApewoJCQkkdGhpcy0+Y29uZi0+c2VydmVyWydhcmd2J10gPSBudWxsOwoJCX0KCQlpZighcHJvcGVydHlfZXhpc3RzKCR0aGlzLT5jb25mLCAnc2Vzc2lvbl9uYW1lJykgfHwgIXN0cmxlbigkdGhpcy0+Y29uZi0+c2Vzc2lvbl9uYW1lID8/ICcnKSl7CgkJCSR0aGlzLT5jb25mLT5zZXNzaW9uX25hbWUgPSAnU0VTU0lEJzsKCQl9CgkJaWYoIXByb3BlcnR5X2V4aXN0cygkdGhpcy0+Y29uZiwgJ3Nlc3Npb25fZXhwaXJlJykgfHwgIXN0cmxlbigkdGhpcy0+Y29uZi0+c2Vzc2lvbl9leHBpcmUgPz8gJycpKXsKCQkJJHRoaXMtPmNvbmYtPnNlc3Npb25fZXhwaXJlID0gMTgwMDsKCQl9CgkJaWYoIXByb3BlcnR5X2V4aXN0cygkdGhpcy0+Y29uZiwgJ2RpcmVjdG9yeV9pbmRleF9wcmltYXJ5JykgfHwgIXN0cmxlbigkdGhpcy0+Y29uZi0+ZGlyZWN0b3J5X2luZGV4X3ByaW1hcnkgPz8gJycpKXsKCQkJJHRoaXMtPmNvbmYtPmRpcmVjdG9yeV9pbmRleF9wcmltYXJ5ID0gJ2luZGV4Lmh0bWwnOwoJCX0KCQlpZighcHJvcGVydHlfZXhpc3RzKCR0aGlzLT5jb25mLCAnY29va2llX2RlZmF1bHRfcGF0aCcpIHx8ICFzdHJsZW4oJHRoaXMtPmNvbmYtPmNvb2tpZV9kZWZhdWx0X3BhdGggPz8gJycpKXsKCQkJLy8g44Kv44OD44Kt44O844Gu44OH44OV44Kp44Or44OI44Gu44OR44K5CgkJCS8vIHNlc3Npb24g44Gu56+E5Zuy44KC44GT44Gu6Kit5a6a44Gr5b6T44GG44CCCgkJCSR0aGlzLT5jb25mLT5jb29raWVfZGVmYXVsdF9wYXRoID0gJHRoaXMtPmdldF9wYXRoX2N1cnJlbnRfZGlyKCk7CgkJfQoKCQkkdGhpcy0+cGFyc2VfaW5wdXQoKTsKCQkkdGhpcy0+c2Vzc2lvbl9zdGFydCgpOwoJfQoKCS8qKgoJICoJ5YWl5Yqb5YCk44KS6Kej5p6Q44GZ44KL44CCCgkgKgoJICogYCRfR0VUYCwgYCRfUE9TVGAsIGAkX0ZJTEVTYCDjgavpgIHjgonjgozjgZ/jg5Hjg6njg6Hjg7zjgr/mg4XloLHjgpLlj5bjgorjgb7jgajjgoHjgIEx44Gk44Gu6YCj5oOz6YWN5YiX44Go44GX44Gm44G+44Go44KB44G+44CB44Kq44OW44K444Kn44Kv44OI5YaF44Gr5L+d5oyB44GX44G+44GZ44CCCgkgKgoJICog44Kz44Oe44Oz44OJ44Op44Kk44Oz44GL44KJ5a6f6KGM44GV44KM44Gf5aC05ZCI44Gv44CB44Kz44Oe44Oz44OJ44Op44Kk44Oz44Kq44OX44K344On44Oz44KS44Gd44KM44Ge44KMIGA9YCDoqJjlj7fjgafljLrliIfjgorjgIFVUkzjg5Hjg6njg6Hjg7zjgr/lkIzmp5jjgavjg5Hjg7zjgrnjgZfjgb7jgZnjgIIKCSAqCgkgKiDjgZPjga7jg6Hjgr3jg4Pjg4njga7lh6bnkIbjgavjga/jgIHlhaXlipvmloflrZfjgrPjg7zjg4njga7lpInmj5soVVRGLTjjgbjntbHkuIAp44Gq44Gp44Gu5pW05b2i5Yem55CG44GM5ZCr44G+44KM44G+44GZ44CCCgkgKgoJICogQHJldHVybiBib29sIOW4uOOBqyBgdHJ1ZWAKCSAqLwoJcHJpdmF0ZSBmdW5jdGlvbiBwYXJzZV9pbnB1dCgpewoJCSR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCA9ICR0aGlzLT5jb25mLT5zZXJ2ZXJbJ1BBVEhfSU5GTyddOwoJCWlmKCAhc3RybGVuKCR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCA/PyAnJykgKXsKCQkJJHRoaXMtPnJlcXVlc3RfZmlsZV9wYXRoID0gJy8nOwoJCX0KCQkkdGhpcy0+Y2xpX3BhcmFtcyA9IGFycmF5KCk7CgkJJHRoaXMtPmNsaV9vcHRpb25zID0gYXJyYXkoKTsKCgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCAnUkVNT1RFX0FERFInICwgJHRoaXMtPmNvbmYtPnNlcnZlciApICl7CgkJCS8vICDjgrPjg57jg7Pjg4njg6njgqTjg7PjgYvjgonjga7lrp/ooYzjgYvlkKbjgYvliKTmlq0KCQkJJHRoaXMtPmZsZ19jbWQgPSB0cnVlOy8v44Kz44Oe44Oz44OJ44Op44Kk44Oz44GL44KJ5a6f6KGM44GX44Gm44GE44KL44GL44OV44Op44KwCgkJCWlmKCBpc19hcnJheSggJHRoaXMtPmNvbmYtPnNlcnZlclsnYXJndiddICkgJiYgY291bnQoICR0aGlzLT5jb25mLT5zZXJ2ZXJbJ2FyZ3YnXSApICl7CgkJCQkkdG1wX3BhdGggPSBudWxsOwoJCQkJZm9yKCAkaSA9IDA7IGNvdW50KCAkdGhpcy0+Y29uZi0+c2VydmVyWydhcmd2J10gKSA+ICRpOyAkaSArKyApewoJCQkJCWlmKCBwcmVnX21hdGNoKCAnL15cLS8nLCAkdGhpcy0+Y29uZi0+c2VydmVyWydhcmd2J11bJGldICkgKXsKCQkJCQkJJHRoaXMtPmNsaV9wYXJhbXMgPSBhcnJheSgpOy8v44Kq44OX44K344On44Oz44Gu5YmN44Gr5byV5pWw44Gv5LuY44GR44KJ44KM44Gq44GECgkJCQkJCSR0aGlzLT5jbGlfb3B0aW9uc1skdGhpcy0+Y29uZi0+c2VydmVyWydhcmd2J11bJGldXSA9ICR0aGlzLT5jb25mLT5zZXJ2ZXJbJ2FyZ3YnXVskaSsxXTsKCQkJCQkJJGkgKys7CgkJCQkJfWVsc2V7CgkJCQkJCWFycmF5X3B1c2goICR0aGlzLT5jbGlfcGFyYW1zLCAkdGhpcy0+Y29uZi0+c2VydmVyWydhcmd2J11bJGldICk7CgkJCQkJfQoJCQkJfQoJCQkJJHRtcF9wYXRoID0gQCR0aGlzLT5jbGlfcGFyYW1zW2NvdW50KCR0aGlzLT5jbGlfcGFyYW1zKS0xXTsKCQkJCWlmKCBwcmVnX21hdGNoKCAnL15cLy8nLCAkdG1wX3BhdGggKSAmJiBAaXNfYXJyYXkoJHRoaXMtPmNvbmYtPnNlcnZlclsnYXJndiddKSApewoJCQkJCSR0bXBfcGF0aCA9IGFycmF5X3BvcCggJHRoaXMtPmNvbmYtPnNlcnZlclsnYXJndiddICk7CgkJCQkJJHRtcF9wYXRoID0gcGFyc2VfdXJsKCR0bXBfcGF0aCk7CgkJCQkJJHRoaXMtPnJlcXVlc3RfZmlsZV9wYXRoID0gJHRtcF9wYXRoWydwYXRoJ107CgkJCQkJQHBhcnNlX3N0ciggJHRtcF9wYXRoWydxdWVyeSddLCAkcXVlcnkgKTsKCQkJCQlpZiggaXNfYXJyYXkoJHF1ZXJ5KSApewoJCQkJCQkkdGhpcy0+Y29uZi0+Z2V0ID0gYXJyYXlfbWVyZ2UoICR0aGlzLT5jb25mLT5nZXQsICRxdWVyeSApOwoJCQkJCX0KCQkJCX0KCQkJCXVuc2V0KCAkdG1wX3BhdGggKTsKCQkJfQoJCX0KCgkJaWYoIGluaV9nZXQoJ21hZ2ljX3F1b3Rlc19ncGMnKSApewoJCQkvLyBQSFBJTknjga5tYWdpY19xdW90ZXNfZ3Bj6Kit5a6a44GMT27jgaDjgaPjgZ/jgonjgIEKCQkJLy8g44Ko44K544Kx44O844OX5paH5a2X44KS5YmK6Zmk44CCCgkJCWZvcmVhY2goIGFycmF5X2tleXMoICR0aGlzLT5jb25mLT5nZXQgKSBhcyAkTGluZSApewoJCQkJJHRoaXMtPmNvbmYtPmdldFskTGluZV0gPSBzZWxmOjpzdHJpcHNsYXNoZXMoICR0aGlzLT5jb25mLT5nZXRbJExpbmVdICk7CgkJCX0KCQkJZm9yZWFjaCggYXJyYXlfa2V5cyggJHRoaXMtPmNvbmYtPnBvc3QgKSBhcyAkTGluZSApewoJCQkJJHRoaXMtPmNvbmYtPnBvc3RbJExpbmVdID0gc2VsZjo6c3RyaXBzbGFzaGVzKCAkdGhpcy0+Y29uZi0+cG9zdFskTGluZV0gKTsKCQkJfQoJCX0KCgkJJHRoaXMtPmNvbmYtPmdldCA9IHNlbGY6OmNvbnZlcnRfZW5jb2RpbmcoICR0aGlzLT5jb25mLT5nZXQgKTsKCQkkdGhpcy0+Y29uZi0+cG9zdCA9IHNlbGY6OmNvbnZlcnRfZW5jb2RpbmcoICR0aGlzLT5jb25mLT5wb3N0ICk7CgkJJHBhcmFtID0gYXJyYXlfbWVyZ2UoICR0aGlzLT5jb25mLT5nZXQgLCAkdGhpcy0+Y29uZi0+cG9zdCApOwoJCSRwYXJhbSA9ICR0aGlzLT5ub3JtYWxpemVfaW5wdXQoICRwYXJhbSApOwoKCQlpZiggaXNfYXJyYXkoICR0aGlzLT5jb25mLT5maWxlcyApICl7CgkJCSRGSUxFU19LRVlTID0gYXJyYXlfa2V5cyggJHRoaXMtPmNvbmYtPmZpbGVzICk7CgkJCWZvcmVhY2goJEZJTEVTX0tFWVMgYXMgJExpbmUpewoJCQkJJHRoaXMtPmNvbmYtPmZpbGVzWyRMaW5lXVsnbmFtZSddID0gc2VsZjo6Y29udmVydF9lbmNvZGluZyggJHRoaXMtPmNvbmYtPmZpbGVzWyRMaW5lXVsnbmFtZSddICk7CgkJCQkkdGhpcy0+Y29uZi0+ZmlsZXNbJExpbmVdWyduYW1lJ10gPSBtYl9jb252ZXJ0X2thbmEoICR0aGlzLT5jb25mLT5maWxlc1skTGluZV1bJ25hbWUnXSAsICdLVicgLCBtYl9pbnRlcm5hbF9lbmNvZGluZygpICk7CgkJCQkkcGFyYW1bJExpbmVdID0gJHRoaXMtPmNvbmYtPmZpbGVzWyRMaW5lXTsKCQkJfQoJCX0KCgkJJHRoaXMtPnBhcmFtID0gJHBhcmFtOwoJCXVuc2V0KCRwYXJhbSk7CgoJCWlmIChwcmVnX21hdGNoKCcvXC8kLycsICR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCkpIHsKCQkJJHRoaXMtPnJlcXVlc3RfZmlsZV9wYXRoIC49ICR0aGlzLT5jb25mLT5kaXJlY3RvcnlfaW5kZXhfcHJpbWFyeTsKCQl9CgkJJHRoaXMtPnJlcXVlc3RfZmlsZV9wYXRoID0gJHRoaXMtPmZzLT5nZXRfcmVhbHBhdGgoICR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCApOwoJCSR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCA9ICR0aGlzLT5mcy0+bm9ybWFsaXplX3BhdGgoICR0aGlzLT5yZXF1ZXN0X2ZpbGVfcGF0aCApOwoKCQlyZXR1cm4JdHJ1ZTsKCX0vL3BhcnNlX2lucHV0KCkKCgkvKioKCSAqCeWFpeWKm+WApOOBq+WvvuOBmeOCi+aomea6lueahOOBquWkieaPm+WHpueQhgoJICoKCSAqIEBwYXJhbSBhcnJheSAkcGFyYW0g44OR44Op44Oh44O844K/CgkgKiBAcmV0dXJuIGFycmF5IOWkieaPm+W+jOOBruODkeODqeODoeODvOOCvwoJICovCglwcml2YXRlIGZ1bmN0aW9uIG5vcm1hbGl6ZV9pbnB1dCggJHBhcmFtICl7CgkJJGlzX2NhbGxhYmxlX21iX2NoZWNrX2VuY29kaW5nID0gaXNfY2FsbGFibGUoICdtYl9jaGVja19lbmNvZGluZycgKTsKCQlmb3JlYWNoKCAkcGFyYW0gYXMgJGtleT0+JHZhbCApewoJCQkvLyBVUkzjg5Hjg6njg6Hjg7zjgr/jgpLliqDlt6UKCQkJaWYoIGlzX2FycmF5KCAkdmFsICkgKXsKCQkJCS8vIOmFjeWIl+OBquOCiQoJCQkJJHBhcmFtWyRrZXldID0gJHRoaXMtPm5vcm1hbGl6ZV9pbnB1dCggJHBhcmFtWyRrZXldICk7CgkJCX1lbHNlaWYoIGlzX3N0cmluZyggJHBhcmFtWyRrZXldICkgKXsKCQkJCS8vIOaWh+Wtl+WIl+OBquOCiQoJCQkJJHBhcmFtWyRrZXldID0gbWJfY29udmVydF9rYW5hKCAkcGFyYW1bJGtleV0gLCAnS1YnICwgbWJfaW50ZXJuYWxfZW5jb2RpbmcoKSApOwoJCQkJCS8vIOWNiuinkuOCq+ODiuOBr+WFqOinkuOBq+e1seS4gAoJCQkJJHBhcmFtWyRrZXldID0gcHJlZ19yZXBsYWNlKCAnL1xyXG58XHJ8XG4vJyAsICJcbiIgLCAkcGFyYW1bJGtleV0gKTsKCQkJCQkvLyDmlLnooYzjgrPjg7zjg4njga9MRuOBq+e1seS4gAoJCQkJaWYoICRpc19jYWxsYWJsZV9tYl9jaGVja19lbmNvZGluZyApewoJCQkJCS8vIOS4jeato+OBquODkOOCpOODiOOCs+ODvOODieOBruODgeOCp+ODg+OCrwoJCQkJCWlmKCAhbWJfY2hlY2tfZW5jb2RpbmcoICRrZXkgLCBtYl9pbnRlcm5hbF9lbmNvZGluZygpICkgKXsKCQkJCQkJLy8g44Kt44O844Gu5Lit44Gr6KaL44Gk44GR44Gf44KJ44OR44Op44Oh44O844K/44GU44Go5YmK6ZmkCgkJCQkJCXVuc2V0KCAkcGFyYW1bJGtleV0gKTsKCQkJCQl9CgkJCQkJaWYoICFtYl9jaGVja19lbmNvZGluZyggJHBhcmFtWyRrZXldICwgbWJfaW50ZXJuYWxfZW5jb2RpbmcoKSApICl7CgkJCQkJCS8vIOWApOOBruS4reOBq+imi+OBpOOBkeOBn+OCiSBmYWxzZSDjgavnva7jgY3mj5vjgYjjgosKCQkJCQkJJHBhcmFtWyRrZXldID0gZmFsc2U7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiAkcGFyYW07Cgl9Ly9ub3JtYWxpemVfaW5wdXQoKQoKCS8qKgoJICog44OR44Op44Oh44O844K/44KS5Y+W5b6X44GZ44KL44CCCgkgKgoJICogYCRfR0VUYCwgYCRfUE9TVGDjgIFgJF9GSUxFU2Ag44KS5ZCI44KP44Gb44Gf6YCj5oOz6YWN5YiX44Gu5Lit44GL44KJIGAka2V5YCDjgavlvZPjgZ/jgovlgKTjgpLlvJXjgYTjgabov5TjgZfjgb7jgZnjgIIKCSAqIOOCreODvOOBjOWumue+qeOBleOCjOOBpuOBhOOBquOBhOWgtOWQiOOBr+OAgWBudWxsYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkgVVJM44OR44Op44Oh44O844K/5ZCNCgkgKiBAcmV0dXJuIG1peGVkIFVSTOODkeODqeODoeODvOOCv+WApAoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtKCAka2V5ICl7CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCRrZXksICR0aGlzLT5wYXJhbSkgKXsgcmV0dXJuIG51bGw7IH0KCQlyZXR1cm4gQCR0aGlzLT5wYXJhbVska2V5XTsKCX0vL2dldF9wYXJhbSgpCgoJLyoqCgkgKiDjg5Hjg6njg6Hjg7zjgr/jgpLjgrvjg4Pjg4jjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkg44OR44Op44Oh44O844K/5ZCNCgkgKiBAcGFyYW0gbWl4ZWQgJHZhbCDjg5Hjg6njg6Hjg7zjgr/lgKQKCSAqIEByZXR1cm4gYm9vbCDluLjjgasgYHRydWVgCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBzZXRfcGFyYW0oICRrZXkgLCAkdmFsICl7CgkJJHRoaXMtPnBhcmFtWyRrZXldID0gJHZhbDsKCQlyZXR1cm4gdHJ1ZTsKCX0vL3NldF9wYXJhbSgpCgoJLyoqCgkgKiDjg5Hjg6njg6Hjg7zjgr/jgpLjgZnjgbnjgablj5blvpfjgZnjgovjgIIKCSAqCgkgKiBAcmV0dXJuIGFycmF5IOOBmeOBueOBpuOBruODkeODqeODoeODvOOCv+OCkuagvOe0jeOBmeOCi+mAo+aDs+mFjeWIlwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0X2FsbF9wYXJhbXMoKXsKCQlyZXR1cm4gJHRoaXMtPnBhcmFtOwoJfQoKCS8qKgoJICog44Kz44Oe44Oz44OJ44Op44Kk44Oz44Kq44OX44K344On44Oz44KS5Y+W5b6X44GZ44KLCgkgKiBAcGFyYW0gc3RyaW5nICRuYW1lIOOCquODl+OCt+ODp+ODs+WQjQoJICogQHJldHVybiBzdHJpbmcg5oyH5a6a44GV44KM44Gf44Kq44OX44K344On44Oz5YCkCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfY2xpX29wdGlvbiggJG5hbWUgKXsKCQlpZiggIWFycmF5X2tleV9leGlzdHMoJG5hbWUsICR0aGlzLT5jbGlfb3B0aW9ucykgKXsKCQkJcmV0dXJuIG51bGw7CgkJfQoJCXJldHVybiBAJHRoaXMtPmNsaV9vcHRpb25zWyRuYW1lXTsKCX0KCgkvKioKCSAqIOOBmeOBueOBpuOBruOCs+ODnuODs+ODieODqeOCpOODs+OCquODl+OCt+ODp+ODs+OCkumAo+aDs+mFjeWIl+OBp+WPluW+l+OBmeOCiwoJICogQHJldHVybiBhcnJheSDjgZnjgbnjgabjga7jgrPjg57jg7Pjg4njg6njgqTjg7Pjgqrjg5fjgrfjg6fjg7MKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9jbGlfb3B0aW9ucygpewoJCXJldHVybiBAJHRoaXMtPmNsaV9vcHRpb25zOwoJfQoKCS8qKgoJICog44Kz44Oe44Oz44OJ44Op44Kk44Oz44OR44Op44Oh44O844K/44KS5Y+W5b6X44GZ44KLCgkgKiBAcGFyYW0gc3RyaW5nICRpZHgg44OR44Op44Oh44O844K/55Wq5Y+3CgkgKiBAcmV0dXJuIHN0cmluZyDmjIflrprjgZXjgozjgZ/jgqrjg5fjgrfjg6fjg7PlgKQKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9jbGlfcGFyYW0oICRpZHggPSAwICl7CgkJaWYoJGlkeCA8IDApewoJCQkvLyDjg57jgqTjg4rjgrnjga7jgqTjg7Pjg4fjg4Pjgq/jgrnjgYzkuI7jgYjjgonjgozjgZ/loLTlkIjjgIEKCQkJLy8g6YWN5YiX44Gu5pyA5b6M44GL44KJ5pWw44GI44KLCgkJCSRpZHggPSBjb3VudCgkdGhpcy0+Y2xpX3BhcmFtcykrJGlkeDsKCQl9CgkJcmV0dXJuIEAkdGhpcy0+Y2xpX3BhcmFtc1skaWR4XTsKCX0KCgkvKioKCSAqIOOBmeOBueOBpuOBruOCs+ODnuODs+ODieODqeOCpOODs+ODkeODqeODoeODvOOCv+OCkumFjeWIl+OBp+WPluW+l+OBmeOCiwoJICogQHJldHVybiBhcnJheSDjgZnjgbnjgabjga7jgrPjg57jg7Pjg4njg6njgqTjg7Pjg5Hjg6njg6Hjg7zjgr8KCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9jbGlfcGFyYW1zKCl7CgkJcmV0dXJuIEAkdGhpcy0+Y2xpX3BhcmFtczsKCX0KCgoKCS8vIC0tLS0tIGNvb2tpZXMgLS0tLS0KCgkvKioKCSAqIOOCr+ODg+OCreODvOaDheWgseOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGtleSDjgq/jg4Pjgq3jg7zlkI0KCSAqIEByZXR1cm4gbWl4ZWQg44Kv44OD44Kt44O844Gu5YCkCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfY29va2llKCAka2V5ICl7CgkJaWYoIEAhaXNfYXJyYXkoICRfQ09PS0lFICkgKXsgcmV0dXJuIG51bGw7IH0KCQlpZiggQCFhcnJheV9rZXlfZXhpc3RzKCRrZXksICRfQ09PS0lFKSApeyByZXR1cm4gbnVsbDsgfQoJCXJldHVybglAJF9DT09LSUVbJGtleV07Cgl9Ly9nZXRfY29va2llKCkKCgkvKioKCSAqIOOCr+ODg+OCreODvOaDheWgseOCkuOCu+ODg+ODiOOBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGtleSDjgq/jg4Pjgq3jg7zlkI0KCSAqIEBwYXJhbSBzdHJpbmcgJHZhbCDjgq/jg4Pjgq3jg7zlgKQKCSAqIEBwYXJhbSBzdHJpbmcgJGV4cGlyZSDjgq/jg4Pjgq3jg7zjga7mnInlirnmnJ/pmZAKCSAqIEBwYXJhbSBzdHJpbmcgJHBhdGgg44K144O844OQ44O85LiK44Gn44Gu44CB44Kv44OD44Kt44O844KS5pyJ5Yq544Go44GX44Gf44GE44OR44K5CgkgKiBAcGFyYW0gc3RyaW5nICRkb21haW4g44Kv44OD44Kt44O844GM5pyJ5Yq544Gq44OJ44Oh44Kk44OzCgkgKiBAcGFyYW0gYm9vbCAkc2VjdXJlIOOCr+ODqeOCpOOCouODs+ODiOOBi+OCieOBruOCu+OCreODpeOCouOBqiBIVFRQUyDmjqXntprjga7loLTlkIjjgavjga7jgb/jgq/jg4Pjgq3jg7zjgYzpgIHkv6HjgZXjgozjgovjgojjgYbjgavjgZfjgb7jgZnjgILjg4fjg5Xjgqnjg6vjg4jjga8gYHRydWVgCgkgKiBAcmV0dXJuIOaIkOWKn+aZgiBgdHJ1ZWDjgIHlpLHmlZfmmYIgYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIHNldF9jb29raWUoICRrZXkgLCAkdmFsICwgJGV4cGlyZSA9IG51bGwgLCAkcGF0aCA9IG51bGwgLCAkZG9tYWluID0gbnVsbCAsICRzZWN1cmUgPSB0cnVlICl7CgkJaWYoIGlzX251bGwoICRwYXRoICkgKXsKCQkJJHBhdGggPSAkdGhpcy0+Y29uZi0+Y29va2llX2RlZmF1bHRfcGF0aDsKCQkJaWYoICFzdHJsZW4oICRwYXRoID8/ICcnICkgKXsKCQkJCSRwYXRoID0gJHRoaXMtPmdldF9wYXRoX2N1cnJlbnRfZGlyKCk7CgkJCX0KCQkJaWYoICFzdHJsZW4oICRwYXRoID8/ICcnICkgKXsKCQkJCSRwYXRoID0gJy8nOwoJCQl9CgkJfQoJCWlmKCAhQHNldGNvb2tpZSggJGtleSAsICR2YWwgLCAkZXhwaXJlICwgJHBhdGggLCAkZG9tYWluICwgJHNlY3VyZSApICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCSRfQ09PS0lFWyRrZXldID0gJHZhbDsvL+ePvuWcqOOBruWHpueQhuOBi+OCieOCguWRvOOBs+WHuuOBm+OCi+OCiOOBhuOBqwoJCXJldHVybiB0cnVlOwoJfS8vc2V0X2Nvb2tpZSgpCgoJLyoqCgkgKiDjgq/jg4Pjgq3jg7zmg4XloLHjgpLliYrpmaTjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkg44Kv44OD44Kt44O85ZCNCgkgKiBAcmV0dXJuIGJvb2wg5oiQ5Yqf5pmCIGB0cnVlYOOAgeWkseaVl+aZgiBgZmFsc2VgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gZGVsZXRlX2Nvb2tpZSggJGtleSApewoJCWlmKCAhQHNldGNvb2tpZSggJGtleSAsIG51bGwgKSApewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXVuc2V0KCAkX0NPT0tJRVska2V5XSApOwoJCXJldHVybiB0cnVlOwoJfS8vZGVsZXRlX2Nvb2tpZSgpCgoKCgkvLyAtLS0tLSBzZXNzaW9uIC0tLS0tCgoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7PjgpLplovlp4vjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRzaWQg44K744OD44K344On44OzSUTjgILnnIHnlaXmmYLjgIHoh6rli5XnmbrooYzjgIIKCSAqIEByZXR1cm4gYm9vbCDjgrvjg4Pjgrfjg6fjg7PjgYzmraPluLjjgavplovlp4vjgZfjgZ/loLTlkIjjgasgYHRydWVg44CB44Gd44KM5Lul5aSW44Gu5aC05ZCI44GrIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXByaXZhdGUgZnVuY3Rpb24gc2Vzc2lvbl9zdGFydCggJHNpZCA9IG51bGwgKXsKCQkkZXhwaXJlID0gaW50dmFsKCR0aGlzLT5jb25mLT5zZXNzaW9uX2V4cGlyZSk7CgkJJGNhY2hlX2xpbWl0ZXIgPSAnbm9jYWNoZSc7CgkJJHNlc3Npb25fbmFtZSA9ICdTRVNTSUQnOwoJCWlmKCBzdHJsZW4oICR0aGlzLT5jb25mLT5zZXNzaW9uX25hbWUgPz8gJycgKSApewoJCQkkc2Vzc2lvbl9uYW1lID0gJHRoaXMtPmNvbmYtPnNlc3Npb25fbmFtZTsKCQl9CgkJJHBhdGggPSAkdGhpcy0+Y29uZi0+Y29va2llX2RlZmF1bHRfcGF0aDsKCQlpZiggIXN0cmxlbiggJHBhdGggPz8gJycgKSApewoJCQkkcGF0aCA9ICR0aGlzLT5nZXRfcGF0aF9jdXJyZW50X2RpcigpOwoJCX0KCQlpZiggIXN0cmxlbiggJHBhdGggPz8gJycgKSApewoJCQkkcGF0aCA9ICcvJzsKCQl9CgoJCUBzZXNzaW9uX25hbWUoICRzZXNzaW9uX25hbWUgKTsKCQlAc2Vzc2lvbl9jYWNoZV9saW1pdGVyKCAkY2FjaGVfbGltaXRlciApOwoJCUBzZXNzaW9uX2NhY2hlX2V4cGlyZSggaW50dmFsKCRleHBpcmUvNjApICk7CgoJCWlmKCBpbnR2YWwoIGluaV9nZXQoICdzZXNzaW9uLmdjX21heGxpZmV0aW1lJyApICkgPCAkZXhwaXJlICsgMTAgKXsKCQkJLy8g44Ks44OZ44O844K444Kz44Os44Kv44K344On44Oz44Gu55Sf5a2Y5pyf6ZaT44GMCgkJCS8vICRleHBpcmXjgojjgorjgoLnn63jgYTloLTlkIjjga/jgIHkuIrmm7jjgY3jgZnjgovjgIIKCQkJLy8g44OQ44OD44OV44Kh44Gv5Zu65a6a5YCk44GnMTDnp5LjgIIKCQkJQGluaV9zZXQoICdzZXNzaW9uLmdjX21heGxpZmV0aW1lJyAsICRleHBpcmUgKyAxMCApOwoJCX0KCgkJQHNlc3Npb25fc2V0X2Nvb2tpZV9wYXJhbXMoIDAgLCAkcGF0aCApOwoJCQkvLyAg44K744OD44K344On44Oz44Kv44OD44Kt44O86Ieq5L2T44Gu5a+/5ZG944Gv5a6a44KB44Gq44GEKD0wKQoJCQkvLyAg44Gd44Gu44GL44KP44KK44CBU0VTU0lPTl9MQVNUX01PRElGSUVEIOOCkuaWsOioreOBl+OAgeiHquWIhuOBp+Wvv+WRveOCkueuoeeQhuOBmeOCi+OAggoKCQlpZiggc3RybGVuKCAkc2lkID8/ICcnICkgKXsKCQkJLy8g44K744OD44K344On44OzSUTjgavmjIflrprjgYzjgYLjgozjgbDjgIHmnInlirnjgavjgZnjgovjgIIKCQkJc2Vzc2lvbl9pZCggJHNpZCApOwoJCX0KCgkJLy8g44K744OD44K344On44Oz44KS6ZaL5aeLCgkJJHJ0biA9IEBzZXNzaW9uX3N0YXJ0KCk7CgoJCS8vIOOCu+ODg+OCt+ODp+ODs+OBruacieWKueacn+mZkOOCkuipleS+oQoJCWlmKCBzdHJsZW4oICR0aGlzLT5nZXRfc2Vzc2lvbiggJ1NFU1NJT05fTEFTVF9NT0RJRklFRCcgKSA/PyAnJyApICYmIGludHZhbCggJHRoaXMtPmdldF9zZXNzaW9uKCAnU0VTU0lPTl9MQVNUX01PRElGSUVEJyApICkgPCBpbnR2YWwoIHRpbWUoKSAtICRleHBpcmUgKSApewoJCQkjCeOCu+ODg+OCt+ODp+ODs+OBruacieWKueacn+mZkOOBjOWIh+OCjOOBpuOBhOOBn+OCieOAgeOCu+ODg+OCt+ODp+ODs+OCreODvOOCkuWGjeeZuuihjOOAggoJCQlpZiggaXNfY2FsbGFibGUoJ3Nlc3Npb25fcmVnZW5lcmF0ZV9pZCcpICl7CgkJCQlAc2Vzc2lvbl9yZWdlbmVyYXRlX2lkKCB0cnVlICk7CgkJCX0KCQl9CgkJJHRoaXMtPnNldF9zZXNzaW9uKCAnU0VTU0lPTl9MQVNUX01PRElGSUVEJyAsIHRpbWUoKSApOwoJCXJldHVybiAkcnRuOwoJfS8vc2Vzc2lvbl9zdGFydCgpCgoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7NJROOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEByZXR1cm4gc3RyaW5nIOOCu+ODg+OCt+ODp+ODs0lECgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfc2Vzc2lvbl9pZCgpewoJCXJldHVybiBzZXNzaW9uX2lkKCk7Cgl9Ly9nZXRfc2Vzc2lvbl9pZCgpCgoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7Pmg4XloLHjgpLlj5blvpfjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkg44K744OD44K344On44Oz44Kt44O8CgkgKiBAcmV0dXJuIG1peGVkIGAka2V5YCDjgavlr77lv5zjgZnjgovjgrvjg4Pjgrfjg6fjg7PlgKQKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9zZXNzaW9uKCAka2V5ICl7CgkJaWYoIEAhaXNfYXJyYXkoICRfU0VTU0lPTiApICl7IHJldHVybiBudWxsOyB9CgkJaWYoIEAhYXJyYXlfa2V5X2V4aXN0cygka2V5LCAkX1NFU1NJT04pICl7IHJldHVybiBudWxsOyB9CgkJcmV0dXJuIEAkX1NFU1NJT05bJGtleV07Cgl9Ly9nZXRfc2Vzc2lvbigpCgoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7Pmg4XloLHjgpLjgrvjg4Pjg4jjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkg44K744OD44K344On44Oz44Kt44O8CgkgKiBAcGFyYW0gbWl4ZWQgJHZhbCBgJGtleWAg44Gr5a++5b+c44GZ44KL44K744OD44K344On44Oz5YCkCgkgKiBAcmV0dXJuIGJvb2wg5bi444GrIGB0cnVlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIHNldF9zZXNzaW9uKCAka2V5ICwgJHZhbCApewoJCSRfU0VTU0lPTlska2V5XSA9ICR2YWw7CgkJcmV0dXJuIHRydWU7Cgl9Ly9zZXRfc2Vzc2lvbigpCgoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7Pmg4XloLHjgpLliYrpmaTjgZnjgovjgIIKCSAqCgkgKiBAcGFyYW0gc3RyaW5nICRrZXkg44K744OD44K344On44Oz44Kt44O8CgkgKiBAcmV0dXJuIGJvb2wg5bi444GrIGB0cnVlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGRlbGV0ZV9zZXNzaW9uKCAka2V5ICl7CgkJdW5zZXQoICRfU0VTU0lPTlska2V5XSApOwoJCXJldHVybiB0cnVlOwoJfS8vZGVsZXRlX3Nlc3Npb24oKQoKCgkvLyAtLS0tLSB1cGxvYWQgZmlsZSBhY2Nlc3MgLS0tLS0KCgkvKioKCSAqIOOCouODg+ODl+ODreODvOODieOBleOCjOOBn+ODleOCoeOCpOODq+OCkuOCu+ODg+OCt+ODp+ODs+OBq+S/neWtmOOBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGtleSDjgrvjg4Pjgrfjg6fjg7Pjgq3jg7wKCSAqIEBwYXJhbSBhcnJheSAkdWxmaWxlaW5mbyDjgqLjg4Pjg5fjg63jg7zjg4njg5XjgqHjgqTjg6vmg4XloLEKCSAqIEByZXR1cm4gYm9vbCDmiJDlip/mmYIgYHRydWVg44CB5aSx5pWX5pmCIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBzYXZlX3VwbG9hZGZpbGUoICRrZXkgLCAkdWxmaWxlaW5mbyApewoJCS8vIGJhc2U2NOOBp+OCqOODs+OCs+ODvOODieOBl+OBpuOAgeODkOOCpOODiuODquODh+ODvOOCv+OCkuaMgeOBoeOBvuOBmeOAggoJCS8vICR1bGZpbGVpbmZvWydjb250ZW50J10g44Gr44OQ44Kk44OK44Oq44KS5qC857SN44GX44Gm5rih44GZ44GL44CBCgkJLy8gJHVsZmlsZWluZm9bJ3RtcF9uYW1lJ10g44G+44Gf44GvICR1bGZpbGVpbmZvWydwYXRoJ10g44Gu44GE44Ga44KM44GL44Gr44CBCgkJLy8g44Ki44OD44OX44Ot44O844OJ44OV44Kh44Kk44Or44Gu44OR44K544KS5oyH5a6a44GX44Gm44GP44Gg44GV44GE44CCCgkJJGZpbGVpbmZvID0gYXJyYXkoKTsKCQkkZmlsZWluZm9bJ25hbWUnXSA9ICR1bGZpbGVpbmZvWyduYW1lJ107CgkJJGZpbGVpbmZvWyd0eXBlJ10gPSAkdWxmaWxlaW5mb1sndHlwZSddOwoKCQlpZiggJHVsZmlsZWluZm9bJ2NvbnRlbnQnXSApewoJCQkkZmlsZWluZm9bJ2NvbnRlbnQnXSA9IGJhc2U2NF9lbmNvZGUoICR1bGZpbGVpbmZvWydjb250ZW50J10gKTsKCQl9ZWxzZXsKCQkJJGZpbGVwYXRoID0gJyc7CgkJCWlmKCBAaXNfZmlsZSggJHVsZmlsZWluZm9bJ3RtcF9uYW1lJ10gKSApewoJCQkJJGZpbGVwYXRoID0gJHVsZmlsZWluZm9bJ3RtcF9uYW1lJ107CgkJCX1lbHNlaWYoIEBpc19maWxlKCAkdWxmaWxlaW5mb1sncGF0aCddICkgKXsKCQkJCSRmaWxlcGF0aCA9ICR1bGZpbGVpbmZvWydwYXRoJ107CgkJCX1lbHNlewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCSRmaWxlaW5mb1snY29udGVudCddID0gYmFzZTY0X2VuY29kZSggZmlsZV9nZXRfY29udGVudHMoICRmaWxlcGF0aCApICk7CgkJfQoKCQlpZiggQCFpc19hcnJheSggJF9TRVNTSU9OICkgKXsKCQkJJF9TRVNTSU9OID0gYXJyYXkoKTsKCQl9CgkJaWYoIEAhYXJyYXlfa2V5X2V4aXN0cygnRklMRScsICRfU0VTU0lPTikgKXsKCQkJJF9TRVNTSU9OWydGSUxFJ10gPSBhcnJheSgpOwoJCX0KCgkJJF9TRVNTSU9OWydGSUxFJ11bJGtleV0gPSAkZmlsZWluZm87CgkJcmV0dXJuCXRydWU7Cgl9CgkvKioKCSAqIOOCu+ODg+OCt+ODp+ODs+OBq+S/neWtmOOBleOCjOOBn+ODleOCoeOCpOODq+aDheWgseOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJGtleSDjgrvjg4Pjgrfjg6fjg7Pjgq3jg7wKCSAqIEByZXR1cm4gYXJyYXl8Ym9vbCDmiJDlip/mmYLjgIHjg5XjgqHjgqTjg6vmg4XloLEg44KS5qC857SN44GX44Gf6YCj5oOz6YWN5YiX44CB5aSx5pWX5pmCIGBmYWxzZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRfdXBsb2FkZmlsZSggJGtleSApewoJCWlmKCFzdHJsZW4oJGtleSA/PyAnJykpewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCWlmKCAhaXNfYXJyYXkoICRfU0VTU0lPTiA/PyBudWxsICkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlpZiggIWFycmF5X2tleV9leGlzdHMoJ0ZJTEUnLCAkX1NFU1NJT04pICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJaWYoICFhcnJheV9rZXlfZXhpc3RzKCRrZXksICRfU0VTU0lPTlsnRklMRSddID8/IGFycmF5KCkpICl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCSRydG4gPSAkX1NFU1NJT05bJ0ZJTEUnXVska2V5XSA/PyBudWxsOwoJCWlmKCBpc19udWxsKCAkcnRuICkgKXsgcmV0dXJuIGZhbHNlOyB9CgoJCSRydG5bJ2NvbnRlbnQnXSA9IGJhc2U2NF9kZWNvZGUoICRydG5bJ2NvbnRlbnQnXSA/PyAnJyApOwoJCXJldHVybgkkcnRuOwoJfQoJLyoqCgkgKiDjgrvjg4Pjgrfjg6fjg7Pjgavkv53lrZjjgZXjgozjgZ/jg5XjgqHjgqTjg6vmg4XloLHjga7kuIDopqfjgpLlj5blvpfjgZnjgovjgIIKCSAqCgkgKiBAcmV0dXJuIGFycmF5IOODleOCoeOCpOODq+aDheWgsSDjgpLmoLzntI3jgZfjgZ/pgKPmg7PphY3liJcKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF91cGxvYWRmaWxlX2xpc3QoKXsKCQlpZiggIWFycmF5X2tleV9leGlzdHMoJ0ZJTEUnLCAkX1NFU1NJT04gPz8gYXJyYXkoKSkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4JYXJyYXlfa2V5cyggJF9TRVNTSU9OWydGSUxFJ10gKTsKCX0KCS8qKgoJICog44K744OD44K344On44Oz44Gr5L+d5a2Y44GV44KM44Gf44OV44Kh44Kk44Or44KS5YmK6Zmk44GZ44KL44CCCgkgKgoJICogQHBhcmFtIHN0cmluZyAka2V5IOOCu+ODg+OCt+ODp+ODs+OCreODvAoJICogQHJldHVybiBib29sIOW4uOOBqyBgdHJ1ZWAg44KS6L+U44GX44G+44GZ44CCCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfdXBsb2FkZmlsZSggJGtleSApewoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cygnRklMRScsICRfU0VTU0lPTiA/PyBhcnJheSgpKSApewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJdW5zZXQoICRfU0VTU0lPTlsnRklMRSddWyRrZXldICk7CgkJcmV0dXJuCXRydWU7Cgl9CgkvKioKCSAqIOOCu+ODg+OCt+ODp+ODs+OBq+S/neWtmOOBleOCjOOBn+ODleOCoeOCpOODq+OCkuWFqOOBpuWJiumZpOOBmeOCi+OAggoJICoKCSAqIEByZXR1cm4gYm9vbCDluLjjgasgYHRydWVgIOOCkui/lOOBl+OBvuOBmeOAggoJICovCglwdWJsaWMgZnVuY3Rpb24gZGVsZXRlX3VwbG9hZGZpbGVfYWxsKCl7CgkJcmV0dXJuCSR0aGlzLT5kZWxldGVfc2Vzc2lvbiggJ0ZJTEUnICk7Cgl9CgoKCS8vIC0tLS0tIHV0aWxzIC0tLS0tCgoJLyoqCgkgKiBVU0VSX0FHRU5UIOOCkuWPluW+l+OBmeOCi+OAggoJICoKCSAqIEByZXR1cm4gc3RyaW5nIFVTRVJfQUdFTlQKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF91c2VyX2FnZW50KCl7CgkJcmV0dXJuICR0aGlzLT5jb25mLT5zZXJ2ZXJbJ0hUVFBfVVNFUl9BR0VOVCddID8/IG51bGw7Cgl9CgoJLyoqCgkgKiDjg6rjgq/jgqjjgrnjg4jjg5HjgrnjgpLlj5blvpfjgZnjgovjgIIKCSAqCgkgKiBAcmV0dXJuIHN0cmluZyDjg6rjgq/jgqjjgrnjg4jjg5HjgrkKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9yZXF1ZXN0X2ZpbGVfcGF0aCgpewoJCXJldHVybiAkdGhpcy0+cmVxdWVzdF9maWxlX3BhdGg7Cgl9CgoJLyoqCgkgKiAgU1NM6YCa5L+h44GL6Kq/44G544KLCgkgKgoJICogQHJldHVybiBib29sIFNTTOmAmuS/oeOBruWgtOWQiCBgdHJ1ZWDjgIHjgZ3jgozku6XlpJbjga7loLTlkIggYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGlzX3NzbCgpewoJCWlmKCAkdGhpcy0+Y29uZi0+c2VydmVyWydIVFRQX1NTTCddID8/IG51bGwgfHwgJHRoaXMtPmNvbmYtPnNlcnZlclsnSFRUUFMnXSA/PyBudWxsICl7CgkJCS8vIFNTTOmAmuS/oeOBjOacieWKueOBi+WQpuOBi+WIpOaWrQoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfQoKCS8qKgoJICog44Kz44Oe44Oz44OJ44Op44Kk44Oz44Gr44KI44KL5a6f6KGM44GL56K66KqN44GZ44KL44CCCgkgKgoJICogQHJldHVybiBib29sIOOCs+ODnuODs+ODieOBi+OCieOBruWun+ihjOOBruWgtOWQiCBgdHJ1ZWDjgIHjgqbjgqfjg5bjgYvjgonjga7lrp/ooYzjga7loLTlkIggYGZhbHNlYCDjgpLov5TjgZfjgb7jgZnjgIIKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGlzX2NtZCgpewoJCWlmKCBhcnJheV9rZXlfZXhpc3RzKCAnUkVNT1RFX0FERFInICwgJHRoaXMtPmNvbmYtPnNlcnZlciA/PyBhcnJheSgpICkgKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4JdHJ1ZTsKCX0KCgoJLy8gLS0tLS0gcHJpdmF0ZSAtLS0tLQoKCS8qKgoJICog5Y+X44GR5Y+W44Gj44Gf44OG44Kt44K544OI44KS44CB5oyH5a6a44Gu5paH5a2X44K744OD44OI44Gr5aSJ5o+b44GZ44KL44CCCgkgKgoJICogQHBhcmFtIG1peGVkICR0ZXh0IOODhuOCreOCueODiAoJICogQHBhcmFtIHN0cmluZyAkZW5jb2RlIOWkieaPm+W+jOOBruaWh+Wtl+OCu+ODg+ODiOOAguecgeeVpeaZguOAgWBtYl9pbnRlcm5hbF9lbmNvZGluZygpYCDjgYvjgonlj5blvpcKCSAqIEBwYXJhbSBzdHJpbmcgJGVuY29kZWZyb20g5aSJ5o+b5YmN44Gu5paH5a2X44K744OD44OI44CC55yB55Wl5pmC44CB6Ieq5YuV5qSc5Ye6CgkgKiBAcmV0dXJuIHN0cmluZyDmloflrZfjgrvjg4Pjg4jlpInmj5vlvozjga7jg4bjgq3jgrnjg4gKCSAqLwoJcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gY29udmVydF9lbmNvZGluZyggJHRleHQsICRlbmNvZGUgPSBudWxsLCAkZW5jb2RlZnJvbSA9IG51bGwgKXsKCQlpZiggIWlzX2NhbGxhYmxlKCAnbWJfaW50ZXJuYWxfZW5jb2RpbmcnICkgKXsgcmV0dXJuICR0ZXh0OyB9CgkJaWYoICFzdHJsZW4oICRlbmNvZGVmcm9tID8/ICcnICkgKXsgJGVuY29kZWZyb20gPSBtYl9pbnRlcm5hbF9lbmNvZGluZygpLicsVVRGLTgsU0pJUy13aW4sZXVjSlAtd2luLFNKSVMsRVVDLUpQLEpJUyxBU0NJSSc7IH0KCQlpZiggIXN0cmxlbiggJGVuY29kZSA/PyAnJyApICl7ICRlbmNvZGUgPSBtYl9pbnRlcm5hbF9lbmNvZGluZygpOyB9CgoJCWlmKCBpc19hcnJheSggJHRleHQgKSApewoJCQkkcnRuID0gYXJyYXkoKTsKCQkJaWYoICFjb3VudCggJHRleHQgKSApeyByZXR1cm4gJHRleHQ7IH0KCQkJJFRFWFRfS0VZUyA9IGFycmF5X2tleXMoICR0ZXh0ICk7CgkJCWZvcmVhY2goICRURVhUX0tFWVMgYXMgJExpbmUgKXsKCQkJCSRLRVkgPSBtYl9jb252ZXJ0X2VuY29kaW5nKCAkTGluZSAsICRlbmNvZGUgLCAkZW5jb2RlZnJvbSApOwoJCQkJaWYoIGlzX2FycmF5KCAkdGV4dFskTGluZV0gKSApewoJCQkJCSRydG5bJEtFWV0gPSBzZWxmOjpjb252ZXJ0X2VuY29kaW5nKCAkdGV4dFskTGluZV0sICRlbmNvZGUsICRlbmNvZGVmcm9tICk7CgkJCQl9ZWxzZXsKCQkJCQkkcnRuWyRLRVldID0gQG1iX2NvbnZlcnRfZW5jb2RpbmcoICR0ZXh0WyRMaW5lXSwgJGVuY29kZSwgJGVuY29kZWZyb20gKTsKCQkJCX0KCQkJfQoJCX1lbHNlewoJCQlpZiggIXN0cmxlbiggJHRleHQgPz8gJycgKSApewoJCQkJcmV0dXJuICR0ZXh0OwoJCQl9CgkJCSRydG4gPSBAbWJfY29udmVydF9lbmNvZGluZyggJHRleHQsICRlbmNvZGUsICRlbmNvZGVmcm9tICk7CgkJfQoJCXJldHVybiAkcnRuOwoJfQoKCS8qKgoJICog44Kv44Kp44O844OI44GV44KM44Gf5paH5a2X5YiX44Gu44Kv44Kp44O844OI6YOo5YiG44KS5Y+W44KK6Zmk44GP44CCCgkgKgoJICog44GT44Gu6Zai5pWw44Gv44CBUEhQ44GuIGBzdHJpcHNsYXNoZXMoKWAg44Gu44Op44OD44OR44O844Gn44GZ44CCCgkgKiDphY3liJfjgpLlj5fjgZHlj5bjgovjgajlho3luLDnmoTjgavmloflrZfliJfjgpLlpInmj5vjgZfjgabov5TjgZfjgb7jgZnjgIIKCSAqCgkgKiBAcGFyYW0gbWl4ZWQgJHRleHQg44OG44Kt44K544OICgkgKiBAcmV0dXJuIHN0cmluZyDjgq/jgqnjg7zjg4jjgYzlhYPjgavmiLvjgZXjgozjgZ/jg4bjgq3jgrnjg4gKCSAqLwoJcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gc3RyaXBzbGFzaGVzKCAkdGV4dCApewoJCWlmKCBpc19hcnJheSggJHRleHQgKSApewoJCQkvLyDphY3liJfjgarjgokKCQkJZm9yZWFjaCggJHRleHQgYXMgJGtleT0+JHZhbCApewoJCQkJJHRleHRbJGtleV0gPSBzZWxmOjpzdHJpcHNsYXNoZXMoICR2YWwgKTsKCQkJfQoJCX1lbHNlaWYoIGlzX3N0cmluZyggJHRleHQgKSApewoJCQkvLyDmloflrZfliJfjgarjgokKCQkJJHRleHQgPSBzdHJpcHNsYXNoZXMoICR0ZXh0ICk7CgkJfQoJCXJldHVybgkkdGV4dDsKCX0KCgkvKioKCSAqIOOCq+ODrOODs+ODiOODh+OCo+ODrOOCr+ODiOODquOBruODkeOCueOCkuWPluW+lwoJICogQHJldHVybiBzdHJpbmcg44OJ44Kt44Ol44Oh44Oz44OI44Or44O844OI44GL44KJ44Gu44OR44K5KOOCueODqeODg+OCt+ODpemWieOBmCkKCSAqLwoJcHJpdmF0ZSBmdW5jdGlvbiBnZXRfcGF0aF9jdXJyZW50X2RpcigpewoJCS8vICDnkrDlooPlpInmlbDjgYvjgonoh6rli5XnmoTjgavliKTmlq3jgIIKCQkkcnRuID0gZGlybmFtZSggJHRoaXMtPmNvbmYtPnNlcnZlclsnU0NSSVBUX05BTUUnXSApOwoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cyggJ1JFTU9URV9BRERSJywgJHRoaXMtPmNvbmYtPnNlcnZlciApICl7CgkJCS8vICBDVUnjgYvjgonotbfli5XjgZXjgozjgZ/loLTlkIgKCQkJLy8gIOODieOCreODpeODoeODs+ODiOODq+ODvOODiOOBjOWIpOWumuOBp+OBjeOBquOBhOOBruOBp+OAgQoJCQkvLyAg44OJ44Kt44Ol44Oh44Oz44OI44Or44O844OI55u05LiL44Gr44GC44KL44KC44Gu44Go44GZ44KL44CCCgkJCSRydG4gPSAnLyc7CgkJfQoJCSRydG4gPSBzdHJfcmVwbGFjZSgnXFwnLCcvJywkcnRuKTsKCQkkcnRuIC49ICgkcnRuIT0nLyc/Jy8nOicnKTsKCQlyZXR1cm4gJHJ0bjsKCX0KCn0KPz4=',
           "user" => 'PD9waHAKbmFtZXNwYWNlIHJlbmNvbkZyYW1ld29yazsKCi8qKgogKiB1c2VyIGNsYXNzCiAqCiAqIEBhdXRob3IgVG9tb3lhIEtveWFuYWdpIDx0b21rNzlAZ21haWwuY29tPgogKi8KY2xhc3MgdXNlcnsKCXByaXZhdGUgJHJlbmNvbjsKCgkvKioKCSAqIENvbnN0cnVjdG9yCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCggJHJlbmNvbiApewoJCSR0aGlzLT5yZW5jb24gPSAkcmVuY29uOwoJfQoKCS8qKgoJICog44Ot44Kw44Kk44Oz44GX44Gm44GE44KL44GLCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBpc19sb2dpbigpewoJCSRsb2dpbl9pZCA9ICR0aGlzLT5nZXRfdXNlcl9pZCgpOwoJCXJldHVybiAhIXN0cmxlbigkbG9naW5faWQgPz8gJycpOwoJfQoKCS8qKgoJICog44Om44O844K244O8SUTjgpLlj5blvpcKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF91c2VyX2lkKCl7CgkJJGxvZ2luX2lkID0gJHRoaXMtPnJlbmNvbi0+cmVxKCktPmdldF9zZXNzaW9uKCR0aGlzLT5yZW5jb24tPmFwcF9pZCgpLidfc2VzX2xvZ2luX2lkJyk7CgkJcmV0dXJuICRsb2dpbl9pZDsKCX0KCn0KPz4=',
           "login" => 'PD9waHAKbmFtZXNwYWNlIHJlbmNvbkZyYW1ld29yazsKCi8qKgogKiBsb2dpbiBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIGxvZ2luewoJcHJpdmF0ZSAkcmVuY29uOwoJcHJpdmF0ZSAkYXBwX2luZm87CgoJLyoqCgkgKiBDb25zdHJ1Y3RvcgoJICovCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoICRyZW5jb24sICRhcHBfaW5mbyApewoJCSR0aGlzLT5yZW5jb24gPSAkcmVuY29uOwoJCSR0aGlzLT5hcHBfaW5mbyA9IChvYmplY3QpICRhcHBfaW5mbzsKCX0KCgkvKioKCSAqIOODreOCsOOCpOODs+OBl+OBpuOBhOOCi+OBi+iqv+OBueOCiwoJICovCglwdWJsaWMgZnVuY3Rpb24gY2hlY2soKXsKCgkJaWYoICEkdGhpcy0+cmVuY29uLT5jb25mKCktPmlzX2xvZ2luX3JlcXVpcmVkKCkgKXsKCQkJLy8g44Om44O844K244O844GM6Kit5a6a44GV44KM44Gm44GE44Gq44GR44KM44Gw44CB44Ot44Kw44Kk44Oz44Gu6KmV5L6h44KS6KGM44KP44Gq44GE44CCCgkJCXJldHVybiB0cnVlOwoJCX0KCgkJJHVzZXJzID0gKGFycmF5KSAkdGhpcy0+cmVuY29uLT5jb25mKCktPnVzZXJzOwoJCSRzZXNfaWQgPSAkdGhpcy0+cmVuY29uLT5hcHBfaWQoKS4nX3Nlc19sb2dpbl9pZCc7CgkJJHNlc19wdyA9ICR0aGlzLT5yZW5jb24tPmFwcF9pZCgpLidfc2VzX2xvZ2luX3B3JzsKCgkJJGxvZ2luX2lkID0gJHRoaXMtPnJlbmNvbi0+cmVxKCktPmdldF9wYXJhbSgnbG9naW5faWQnKTsKCQkkbG9naW5fcHcgPSAkdGhpcy0+cmVuY29uLT5yZXEoKS0+Z2V0X3BhcmFtKCdsb2dpbl9wdycpOwoJCSRsb2dpbl90cnkgPSAkdGhpcy0+cmVuY29uLT5yZXEoKS0+Z2V0X3BhcmFtKCdsb2dpbl90cnknKTsKCQlpZiggc3RybGVuKCAkbG9naW5fdHJ5ID8/ICcnICkgJiYgc3RybGVuKCRsb2dpbl9pZCA/PyAnJykgJiYgc3RybGVuKCRsb2dpbl9wdyA/PyAnJykgKXsKCQkJLy8g44Ot44Kw44Kk44Oz6KmV5L6hCgkJCWlmKCBhcnJheV9rZXlfZXhpc3RzKCRsb2dpbl9pZCwgJHVzZXJzKSAmJiAkdXNlcnNbJGxvZ2luX2lkXSA9PSBzaGExKCRsb2dpbl9wdykgKXsKCQkJCSR0aGlzLT5yZW5jb24tPnJlcSgpLT5zZXRfc2Vzc2lvbigkc2VzX2lkLCAkbG9naW5faWQpOwoJCQkJJHRoaXMtPnJlbmNvbi0+cmVxKCktPnNldF9zZXNzaW9uKCRzZXNfcHcsIHNoYTEoJGxvZ2luX3B3KSk7CgkJCQloZWFkZXIoJ0xvY2F0aW9uOiA/YT0nLnVybGVuY29kZSgkdGhpcy0+cmVuY29uLT5yZXEoKS0+Z2V0X3BhcmFtKCdhJykpKTsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJfQoKCgkJJGxvZ2luX2lkID0gJHRoaXMtPnJlbmNvbi0+cmVxKCktPmdldF9zZXNzaW9uKCRzZXNfaWQpOwoJCSRsb2dpbl9wd19oYXNoID0gJHRoaXMtPnJlbmNvbi0+cmVxKCktPmdldF9zZXNzaW9uKCRzZXNfcHcpOwoJCWlmKCBzdHJsZW4oJGxvZ2luX2lkID8/ICcnKSAmJiBzdHJsZW4oJGxvZ2luX3B3X2hhc2ggPz8gJycpICl7CgkJCS8vIOODreOCsOOCpOODs+a4iOOBv+OBi+ipleS+oQoJCQlpZiggYXJyYXlfa2V5X2V4aXN0cygkbG9naW5faWQsICR1c2VycykgJiYgJHVzZXJzWyRsb2dpbl9pZF0gPT0gJGxvZ2luX3B3X2hhc2ggKXsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJCSR0aGlzLT5yZW5jb24tPnJlcSgpLT5kZWxldGVfc2Vzc2lvbigkc2VzX2lkKTsKCQkJJHRoaXMtPnJlbmNvbi0+cmVxKCktPmRlbGV0ZV9zZXNzaW9uKCRzZXNfcHcpOwoJCQkkdGhpcy0+cmVuY29uLT5mb3JiaWRkZW4oKTsKCQkJZXhpdDsKCQl9CgoJCXJldHVybiBmYWxzZTsKCX0KCgkvKioKCSAqIOODreOCsOOCpOODs+eUu+mdouOCkuihqOekuuOBl+OBpue1guS6huOBmeOCiwoJICovCglwdWJsaWMgZnVuY3Rpb24gcGxlYXNlX2xvZ2luKCl7CgkJaGVhZGVyKCdDb250ZW50LXR5cGU6IHRleHQvaHRtbCcpOwoKLyogcm91dGU6bG9naW4gKi8KCgkJb2Jfc3RhcnQoKTsKCQk/Pgo8IWRvY3R5cGUgaHRtbD4KPGh0bWw+Cgk8aGVhZD4KCQk8bWV0YSBjaGFyc2V0PSJVVEYtOCIgLz4KCQk8dGl0bGU+PD89IGh0bWxzcGVjaWFsY2hhcnMoICR0aGlzLT5hcHBfaW5mby0+bmFtZSA/PyAnJyApID8+PC90aXRsZT4KCQk8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vZm9sbG93LCBub2luZGV4LCBub2FyY2hpdmUiIC8+CgkJPD89ICR0aGlzLT5ta19jc3MoKSA/PgoJPC9oZWFkPgoJPGJvZHk+CgkJPGRpdiBjbGFzcz0idGhlbWUtY29udGFpbmVyIj4KCQkJPGgxPjw/PSBodG1sc3BlY2lhbGNoYXJzKCAkdGhpcy0+YXBwX2luZm8tPm5hbWUgPz8gJycgKSA/PjwvaDE+CgkJCTw/cGhwIGlmKCBzdHJsZW4oJHRoaXMtPnJlbmNvbi0+cmVxKCktPmdldF9wYXJhbSgnbG9naW5fdHJ5JykgPz8gJycpICl7ID8+CgkJCQk8ZGl2IGNsYXNzPSJhbGVydCBhbGVydC1kYW5nZXIiIHJvbGU9ImFsZXJ0Ij4KCQkJCQk8ZGl2PklE44G+44Gf44Gv44OR44K544Ov44O844OJ44GM6YGV44GE44G+44GZ44CCPC9kaXY+CgkJCQk8L2Rpdj4KCQkJPD9waHAgfSA/PgoKCQkJPGZvcm0gYWN0aW9uPSI/IiBtZXRob2Q9InBvc3QiPgo8dGFibGU+Cgk8dHI+PHRoPklEOjwvdGg+PHRkPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJsb2dpbl9pZCIgdmFsdWU9IiIgLz48L3RkPgoJPHRyPjx0aD5QYXNzd29yZDo8L3RoPjx0ZD48aW5wdXQgdHlwZT0icGFzc3dvcmQiIG5hbWU9ImxvZ2luX3B3IiB2YWx1ZT0iIiAvPjwvdGQ+CjwvdGFibGU+CjxwPjxidXR0b24gdHlwZT0ic3VibWl0Ij5Mb2dpbjwvYnV0dG9uPjwvcD4KPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ibG9naW5fdHJ5IiB2YWx1ZT0iMSIgLz4KPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYSIgdmFsdWU9Ijw/PSBodG1sc3BlY2lhbGNoYXJzKCR0aGlzLT5yZW5jb24tPnJlcSgpLT5nZXRfcGFyYW0oJ2EnKSA/PyAnJykgPz4iIC8+CgkJCTwvZm9ybT4KCQk8L2Rpdj4KCTwvYm9keT4KPC9odG1sPgo8P3BocAoJCSRydG4gPSBvYl9nZXRfY2xlYW4oKTsKCQlwcmludCAkcnRuOwoJCWV4aXQ7Cgl9CgoJLyoqCgkgKiDjg63jgrDjgqLjgqbjg4jjgZfjgabntYLkuobjgZnjgosKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGxvZ291dCgpewoJCSR0aGlzLT5yZW5jb24tPnJlcSgpLT5kZWxldGVfc2Vzc2lvbigkdGhpcy0+cmVuY29uLT5hcHBfaWQoKS4nX3Nlc19sb2dpbl9pZCcpOwoJCSR0aGlzLT5yZW5jb24tPnJlcSgpLT5kZWxldGVfc2Vzc2lvbigkdGhpcy0+cmVuY29uLT5hcHBfaWQoKS4nX3Nlc19sb2dpbl9wdycpOwoKLyogcm91dGU6bG9nb3V0ICovCgoJCWhlYWRlcignQ29udGVudC10eXBlOiB0ZXh0L2h0bWwnKTsKCQlvYl9zdGFydCgpOwoJCT8+CjwhZG9jdHlwZSBodG1sPgo8aHRtbD4KCTxoZWFkPgoJCTxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPgoJCTx0aXRsZT48Pz0gaHRtbHNwZWNpYWxjaGFycyggJHRoaXMtPmFwcF9pbmZvLT5uYW1lID8/ICcnICkgPz48L3RpdGxlPgoJCTxtZXRhIG5hbWU9InJvYm90cyIgY29udGVudD0ibm9mb2xsb3csIG5vaW5kZXgsIG5vYXJjaGl2ZSIgLz4KCQk8Pz0gJHRoaXMtPm1rX2NzcygpID8+Cgk8L2hlYWQ+Cgk8Ym9keT4KCQk8ZGl2IGNsYXNzPSJ0aGVtZS1jb250YWluZXIiPgoJCQk8aDE+PD89IGh0bWxzcGVjaWFsY2hhcnMoICR0aGlzLT5hcHBfaW5mby0+bmFtZSA/PyAnJyApID8+PC9oMT4KCQkJPHA+TG9nZ2VkIG91dC48L3A+CgkJCTxwPjxhIGhyZWY9Ij8iPkJhY2sgdG8gSG9tZTwvYT48L3A+CgkJPC9kaXY+Cgk8L2JvZHk+CjwvaHRtbD4KPD9waHAKCQkkcnRuID0gb2JfZ2V0X2NsZWFuKCk7CgkJcHJpbnQgJHJ0bjsKCQlleGl0OwoJfQoKCgkvKioKCSAqIENTU+OCkueUn+aIkAoJICovCglwcml2YXRlIGZ1bmN0aW9uIG1rX2NzcygpewoJCW9iX3N0YXJ0KCk7Pz4KCQk8c3R5bGU+CgkJCWh0bWwsIGJvZHkgewoJCQkJYmFja2dyb3VuZC1jb2xvcjogI2U3ZTdlNzsKCQkJCWNvbG9yOiAjMzMzOwoJCQkJZm9udC1zaXplOiAxNnB4OwoJCQkJbWFyZ2luOiAwOwoJCQkJcGFkZGluZzogMDsKCQkJfQoJCQkudGhlbWUtY29udGFpbmVyIHsKCQkJCWJveC1zaXppbmc6IGJvcmRlci1ib3g7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQlwYWRkaW5nOiA0ZW0gMjBweDsKCQkJCW1hcmdpbjogMzBweCBhdXRvOwoJCQkJd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpOwoJCQkJbWF4LXdpZHRoOiA2MDBweDsKCQkJCWJhY2tncm91bmQtY29sb3I6ICNmNmY2ZjY7CgkJCQlib3JkZXI6IDFweCBzb2xpZCAjYmJiOwoJCQkJYm9yZGVyLXJhZGl1czogNXB4OwoJCQkJYm94LXNoYWRvdzogMCAycHggMTJweCByZ2JhKDAsMCwwLDAuMSk7CgkJCX0KCQkJaDEgewoJCQkJZm9udC1zaXplOiAyMnB4OwoJCQl9CgkJCXRhYmxlewoJCQkJbWFyZ2luOiAwIGF1dG87CgkJCQltYXgtd2lkdGg6IDEwMCU7CgkJCX0KCQkJdGggewoJCQkJdGV4dC1hbGlnbjogcmlnaHQ7CgkJCQlwYWRkaW5nOiAzcHg7CgkJCX0KCQkJdGQgewoJCQkJdGV4dC1hbGlnbjogbGVmdDsKCQkJCXBhZGRpbmc6IDNweDsKCQkJfQoJCQlpbnB1dFt0eXBlPXRleHRdLAoJCQlpbnB1dFt0eXBlPXBhc3N3b3JkXXsKCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCQkJCWJveC1zaXppbmc6IGJvcmRlci1ib3g7CgkJCQl3aWR0aDogMTYwcHg7CgkJCQltaW4td2lkdGg6IDUwcHg7CgkJCQltYXgtd2lkdGg6IDEwMCU7CgkJCQlwYWRkaW5nOiAuMzc1cmVtIC43NXJlbTsKCQkJCWZvbnQtc2l6ZTogMWVtOwoJCQkJZm9udC13ZWlnaHQ6IG5vcm1hbDsKCQkJCWxpbmUtaGVpZ2h0OiAxLjU7CgkJCQljb2xvcjogIzMzMzsKCQkJCWJhY2tncm91bmQtY29sb3I6ICNmNmY2ZjY7CgkJCQliYWNrZ3JvdW5kLWNsaXA6IHBhZGRpbmctYm94OwoJCQkJYm9yZGVyOiAxcHggc29saWQgI2NlZDRkYTsKCQkJCWJvcmRlci1yYWRpdXM6IC4yNXJlbTsKCQkJCXRyYW5zaXRpb246IGJvcmRlci1jb2xvciAuMTVzIGVhc2UtaW4tb3V0LGJveC1zaGFkb3cgLjE1cyBlYXNlLWluLW91dDsKCQkJfQoJCQlpbnB1dFt0eXBlPXRleHRdOmZvY3VzLAoJCQlpbnB1dFt0eXBlPXBhc3N3b3JkXTpmb2N1c3sKCQkJCWNvbG9yOiAjMzMzOwoJCQkJYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKCQkJCWJvcmRlci1jb2xvcjogIzgwYmRmZjsKCQkJCW91dGxpbmU6IDA7CgkJCQlib3gtc2hhZG93OiAwIDAgMCAuMnJlbSByZ2JhKDAsMTIzLDI1NSwuMjUpOwoJCQl9CgoJCQlidXR0b24gewoJCQkJZGlzcGxheTogaW5saW5lLWJsb2NrOwoJCQkJYm9yZGVyLXJhZGl1czogM3B4OwoJCQkJYmFja2dyb3VuZC1jb2xvcjogI2Y1ZmJmZTsKCQkJCWNvbG9yOiAjMDBhMGU2OwoJCQkJYm9yZGVyOiAxcHggc29saWQgIzAwYTBlNjsKCQkJCWJveC1zaGFkb3c6IDAgMnB4IDBweCByZ2JhKDAsMCwwLDAuMSk7CgkJCQlwYWRkaW5nOiAwLjVlbSAyZW07CgkJCQlmb250LXNpemU6MWVtOwoJCQkJZm9udC13ZWlnaHQ6IG5vcm1hbDsKCQkJCWxpbmUtaGVpZ2h0OiAxOwoJCQkJdGV4dC1kZWNvcmF0aW9uOiBub25lOwoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQkJYm94LXNpemluZzogYm9yZGVyLWJveDsKCQkJCWFsaWduLWl0ZW1zOiBzdHJldGNoOwoJCQkJdHJhbnNpdGlvbjoKCQkJCQljb2xvciAwLjFzLAoJCQkJCWJhY2tncm91bmQtY29sb3IgMC4xcywKCQkJCQl0cmFuc2Zvcm0gMC4xcwoJCQkJOwoJCQl9CgkJCWJ1dHRvbjpmb2N1cywKCQkJYnV0dG9uOmhvdmVyewoJCQkJYmFja2dyb3VuZC1jb2xvcjogI2Q5ZjFmYjsKCQkJfQoJCQlidXR0b246aG92ZXJ7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiAjY2NlY2ZhOwoJCQl9CgkJCWJ1dHRvbjphY3RpdmV7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiAjMDBhMGU2OwoJCQkJY29sb3I6ICNmZmY7CgkJCX0KCgkJPC9zdHlsZT4KCgkJPD9waHAKCQkkc3JjID0gb2JfZ2V0X2NsZWFuKCk7CgkJcmV0dXJuICRzcmM7Cgl9Cgp9Cj8+',
           "resources" => 'PD9waHAKbmFtZXNwYWNlIHJlbmNvbkZyYW1ld29yazsKCi8qKgogKiByZXNvdXJjZU1nciBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIHJlc291cmNlc3sKCXByaXZhdGUgJG1haW47CgoJLyoqCgkgKiBDb25zdHJ1Y3RvcgoJICovCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoICRtYWluICl7CgkJJHRoaXMtPm1haW4gPSAkbWFpbjsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZWNob19yZXNvdXJjZSggJHBhdGggKXsKCQkkZXh0ID0gbnVsbDsKCQlpZiggcHJlZ19tYXRjaCgnL1wuKFthLXpBLVowLTlcX1wtXSopJC8nLCAkcGF0aCwgJG1hdGNoZWQpICl7CgkJCSRleHQgPSAkbWF0Y2hlZFsxXTsKCQkJJGV4dCA9IHN0cnRvbG93ZXIoJGV4dCk7CgkJCSRtaW1lID0gJHRoaXMtPmdldF9taW1lX3R5cGUoJGV4dCk7CgkJCWlmKCAhJG1pbWUgKXsgJG1pbWUgPSAndGV4dC9odG1sJzsgfQoJCQloZWFkZXIoJ0NvbnRlbnQtdHlwZTogJy4kbWltZSk7CgkJfQoJCWVjaG8gJHRoaXMtPmdldCgkcGF0aCk7CgkJZXhpdDsKCX0KCgkvKioKCSAqIOODquOCveODvOOCueOCkuWPluW+lwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0KCAkcGF0aCApewoJCSRwYXRoID0gcHJlZ19yZXBsYWNlKCAnLyQoPzpcLyp8XC5cLj9cLykqLycsICcnLCAkcGF0aCApOwoKCQkkcmVzb3VyY2VzID0gYXJyYXkoCgovKiBmdW5jdGlvbiByZXNvdXJjZSgpICovCgoJCSk7CgoJCWlmKCAhYXJyYXlfa2V5X2V4aXN0cygkcGF0aCwgJHJlc291cmNlcykgKXsgcmV0dXJuIGZhbHNlOyB9CgkJcmV0dXJuIGJhc2U2NF9kZWNvZGUoJHJlc291cmNlc1skcGF0aF0pOwoJfQoKCS8qKgoJICog5ouh5by15a2Q44GL44KJIG1pbWUtdHlwZSDjgpLlvpfjgosKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldF9taW1lX3R5cGUoJGV4dCl7CgkJc3dpdGNoKCAkZXh0ICl7CgkJCWNhc2UgJ2h0bWwnOgoJCQljYXNlICdodG0nOgoJCQkJcmV0dXJuICd0ZXh0L2h0bWwnOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ2pzJzoKCQkJCXJldHVybiAndGV4dC9qYXZhc2NyaXB0JzsKCQkJCWJyZWFrOwoJCQljYXNlICdjc3MnOgoJCQljYXNlICdzY3NzJzoKCQkJCXJldHVybiAndGV4dC9jc3MnOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ2dpZic6CgkJCQlyZXR1cm4gJ2ltYWdlL2dpZic7CgkJCQlicmVhazsKCQkJY2FzZSAncG5nJzoKCQkJCXJldHVybiAnaW1hZ2UvcG5nJzsKCQkJCWJyZWFrOwoJCQljYXNlICdqcGcnOgoJCQljYXNlICdqcGVnJzoKCQkJY2FzZSAnanBlJzoKCQkJCXJldHVybiAnaW1hZ2UvanBlZyc7CgkJCQlicmVhazsKCQkJY2FzZSAnc3ZnJzoKCQkJCXJldHVybiAnaW1hZ2Uvc3ZnK3htbCAnOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ3RleHQnOgoJCQljYXNlICd0eHQnOgoJCQljYXNlICdsb2cnOgoJCQljYXNlICdzaCc6CgkJCWNhc2UgJ2JhdCc6CgkJCWNhc2UgJ3BocCc6CgkJCWNhc2UgJ2pzb24nOgoJCQljYXNlICd5bWwnOgoJCQljYXNlICd5bWwnOgoJCQljYXNlICdodGFjY2Vzcyc6CgkJCQlyZXR1cm4gJ3RleHQvcGxhaW4nOwoJCQkJYnJlYWs7CgkJfQoJCXJldHVybiBmYWxzZTsKCX0KCn0KPz4=',
           "theme" => 'PD9waHAKbmFtZXNwYWNlIHJlbmNvbkZyYW1ld29yazsKCi8qKgogKiB0aGVtZSBjbGFzcwogKgogKiBAYXV0aG9yIFRvbW95YSBLb3lhbmFnaSA8dG9tazc5QGdtYWlsLmNvbT4KICovCmNsYXNzIHRoZW1lewoJcHJpdmF0ZSAkcmVuY29uOwoJcHJpdmF0ZSAkYXBwX2luZm87Cglwcml2YXRlICRjdXJyZW50X3BhZ2VfaW5mbzsKCgkvKioKCSAqIENvbnN0cnVjdG9yCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCggJHJlbmNvbiwgJGFwcF9pbmZvLCAkY3VycmVudF9wYWdlX2luZm8gPSBhcnJheSgpICl7CgkJJHRoaXMtPnJlbmNvbiA9ICRyZW5jb247CgkJJHRoaXMtPmFwcF9pbmZvID0gKG9iamVjdCkgJGFwcF9pbmZvOwoJCSR0aGlzLT5jdXJyZW50X3BhZ2VfaW5mbyA9IChvYmplY3QpICRjdXJyZW50X3BhZ2VfaW5mbzsKCX0KCgkvKioKCSAqIOODmuODvOOCuOaDheWgsQoJICovCglwdWJsaWMgZnVuY3Rpb24gc2V0X2N1cnJlbnRfcGFnZV9pbmZvKCAkcGFnZV9pbmZvICl7CgkJJHRoaXMtPmN1cnJlbnRfcGFnZV9pbmZvID0gKG9iamVjdCkgYXJyYXlfbWVyZ2UoKGFycmF5KSAkdGhpcy0+Y3VycmVudF9wYWdlX2luZm8sIChhcnJheSkgJHBhZ2VfaW5mbyk7CgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoqCgkgKiDjgqLjg5fjg6rjgrHjg7zjgrfjg6fjg7Pmg4XloLHjgpLlj5blvpcKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGFwcF9pbmZvKCl7CgkJcmV0dXJuICR0aGlzLT5hcHBfaW5mbzsKCX0KCgkvKioKCSAqIOODmuODvOOCuOaDheWgseOCkuWPluW+lwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0X2N1cnJlbnRfcGFnZV9pbmZvKCl7CgkJcmV0dXJuICR0aGlzLT5jdXJyZW50X3BhZ2VfaW5mbzsKCX0KCgkvKioKCSAqIOODhuODvOODnuOBq+OCs+ODs+ODhuODs+ODhOOCkuWMheOCk+OBp+i/lOOBmQoJICovCglwdWJsaWMgZnVuY3Rpb24gYmluZCggJGNvbnRlbnQgKXsKCQkkYWN0aW9uX2FyeSA9IGV4cGxvZGUoJy4nLCAkdGhpcy0+cmVuY29uLT5yZXEoKS0+Z2V0X3BhcmFtKCdhJykpOwoJCWlmKCAhaXNfYXJyYXkoJGFjdGlvbl9hcnkpIHx8ICFjb3VudCgkYWN0aW9uX2FyeSkgKXsKCQkJJGFjdGlvbl9hcnlbMF0gPSAnJzsKCQl9CgkJJGNsYXNzX2FjdGl2ZVsnYWN0aXZlJ10gPSAkYWN0aW9uX2FyeVswXTsKCQkkcmVuY29uID0gJHRoaXMtPnJlbmNvbjsKCgkJb2Jfc3RhcnQoKTsKCQk/Pi8qIHRoZW1lIHRlbXBsYXRlICovPD9waHAKCQkkcnRuID0gb2JfZ2V0X2NsZWFuKCk7CgoJCXJldHVybiAkcnRuOwoJfQp9Cj8+',
       );
       return base64_decode($files[$className]);
   }
}
